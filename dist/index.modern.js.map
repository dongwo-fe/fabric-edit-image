{"version":3,"file":"index.modern.js","sources":["../src/utils/utils.ts","../src/core/initAligningGuidelines.ts","../src/core/initControlsRotate.ts","../src/core/initCenterAlign.ts","../src/utils/hotEventKeys.ts","../src/core/initHotKeys.ts","../src/utils/events/types.ts","../src/utils/events/index.ts","../src/utils/index.ts","../src/core/initControls.ts","../src/core/ruler/utils.ts","../src/core/ruler/guideline.ts","../src/core/ruler/ruler.ts","../src/core/ruler/index.ts","../src/core/EditorGroupText.ts","../src/core/index.ts","../src/components/Draw/CanvasContext.tsx","../src/components/Editor/Input/index.tsx","../src/components/Draw/hooks/useAttr.ts","../src/components/Draw/hooks/useLock.ts","../src/utils/calculate.ts","../src/components/Editor/Components/Attr/Components/Size/index.tsx","../src/components/Editor/Components/Attr/Components/Pos/index.tsx","../src/components/Editor/Components/Attr/Components/Trans/index.tsx","../src/components/Draw/hooks/usePageAlign.ts","../src/components/Editor/Components/Attr/Components/PageAlign/config.ts","../src/components/Editor/Components/Attr/Components/PageAlign/index.tsx","../src/components/Editor/Components/Attr/Components/CoverOrder/config.ts","../src/components/Draw/hooks/userOrder.ts","../src/components/Editor/Components/Attr/Components/CoverOrder/index.tsx","../src/components/Editor/Components/Attr/ImageSpaceAttr/index.tsx","../src/components/Editor/Select/index.tsx","../src/components/Editor/InputNumber/index.tsx","../src/components/Editor/Components/Attr/Components/Text/config.ts","../src/api/text.ts","../src/components/Draw/hooks/useChangeFontFamily.ts","../src/components/Editor/Components/Attr/Components/Text/index.tsx","../src/components/Editor/Components/Attr/TextSpaceAttr/index.tsx","../src/components/Editor/AttrArea/config.tsx","../src/components/Editor/Context/index.tsx","../src/utils/tool.ts","../src/api/fetch.ts","../src/api/image.ts","../src/components/Draw/hooks/useToast.ts","../src/components/Draw/hooks/useClipImage.ts","../src/components/Draw/hooks/useEvents.ts","../src/core/EditorWorkspace.ts","../src/components/Draw/hooks/useSave.ts","../src/components/Draw/Draw.tsx","../src/components/Editor/ImportFile/index.tsx","../src/hooks/useMemoizedFn.ts","../src/hooks/useHistoryTravel.ts","../src/components/Draw/hooks/useHistory.ts","../src/components/Editor/HeaderControl/index.tsx","../src/components/Editor/SaveButton/index.tsx","../src/components/Editor/Components/Resource/ImageResource/dropDown.tsx","../src/components/Draw/hooks/useAddObject.ts","../src/components/Editor/Components/Resource/ImageResource/index.tsx","../src/components/Editor/Components/Resource/TextResource/config.ts","../src/components/Editor/Components/Resource/TextResource/index.tsx","../src/components/Editor/ResourceArea/config.ts","../src/components/Editor/ResourceArea/index.tsx","../src/components/Editor/OrderList/index.tsx","../src/components/Editor/Components/Attr/WorkSpaceAttr/index.tsx","../src/components/Editor/AttrArea/index.tsx","../src/components/Editor/index.tsx","../src/index.tsx"],"sourcesContent":["type ReFn = (...args: any) => void\ntype ThFn = (fn: ReFn, timer: number) => ReFn\nexport const throttle: ThFn = (fn, timer) => {\n  let time: any = null\n  return (...args: any) => {\n    if (time) clearTimeout(time)\n    time = setTimeout(() => {\n      // @ts-ignore\n      fn.apply(this, args)\n    }, timer)\n  }\n}\n\nexport function uuid(): string {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    const r = (Math.random() * 16) | 0\n    const v = c === 'x' ? r : (r & 0x3) | 0x8\n    return v.toString(16)\n  })\n}\n\nexport function retainNumber(value: string | number): string {\n  if (!value) return '0'\n  const result = ('' + value).replace(/[^0-9]/g, '')\n  return Number(result) + ''\n}\n\n\nexport function arrayMoveMutable(array: Array<any>, fromIndex: number, toIndex: number) {\n  const startIndex = fromIndex < 0 ? array.length + fromIndex : fromIndex;\n\n  if (startIndex >= 0 && startIndex < array.length) {\n    const endIndex = toIndex < 0 ? array.length + toIndex : toIndex;\n    const [item] = array.splice(fromIndex, 1);\n    array.splice(endIndex, 0, item);\n  }\n}\n\nexport function arrayMoveImmutable(array: Array<any>, fromIndex: number, toIndex: number) {\n  array = [...array];\n  arrayMoveMutable(array, fromIndex, toIndex);\n  return array;\n}\n","// @ts-nocheck\nimport { fabric } from 'fabric';\n\ndeclare interface VerticalLine {\n  x: number;\n  y1: number;\n  y2: number;\n}\n\ndeclare interface HorizontalLine {\n  x1: number;\n  x2: number;\n  y: number;\n}\n\nfunction initAligningGuidelines(canvas: fabric.Canvas) {\n  let disabled = false\n  const ctx = canvas.getSelectionContext();\n  const aligningLineOffset = 5;\n  const aligningLineMargin = 4;\n  const aligningLineWidth = 1;\n  const aligningLineColor = 'rgb(0,255,0)';\n  let viewportTransform: number[] | undefined;\n  let zoom = 1;\n\n  function drawVerticalLine(coords: VerticalLine) {\n    drawLine(\n      coords.x + 0.5,\n      coords.y1 > coords.y2 ? coords.y2 : coords.y1,\n      coords.x + 0.5,\n      coords.y2 > coords.y1 ? coords.y2 : coords.y1\n    );\n  }\n\n  function drawHorizontalLine(coords: HorizontalLine) {\n    drawLine(\n      coords.x1 > coords.x2 ? coords.x2 : coords.x1,\n      coords.y + 0.5,\n      coords.x2 > coords.x1 ? coords.x2 : coords.x1,\n      coords.y + 0.5\n    );\n  }\n\n  function drawLine(x1: number, y1: number, x2: number, y2: number) {\n    if (viewportTransform == null || disabled) return;\n\n    ctx.save();\n    ctx.lineWidth = aligningLineWidth;\n    ctx.strokeStyle = aligningLineColor;\n    ctx.beginPath();\n    ctx.moveTo(x1 * zoom + viewportTransform[4], y1 * zoom + viewportTransform[5]);\n    ctx.lineTo(x2 * zoom + viewportTransform[4], y2 * zoom + viewportTransform[5]);\n    ctx.stroke();\n    ctx.restore();\n  }\n\n  function isInRange(value1: number, value2: number) {\n    value1 = Math.round(value1);\n    value2 = Math.round(value2);\n    for (let i = value1 - aligningLineMargin, len = value1 + aligningLineMargin; i <= len; i++) {\n      if (i === value2) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  const verticalLines: VerticalLine[] = [];\n  const horizontalLines: HorizontalLine[] = [];\n\n  canvas.on('mouse:down', () => {\n    viewportTransform = canvas.viewportTransform;\n    zoom = canvas.getZoom();\n  });\n\n  canvas.on('object:moving', (e) => {\n    if (viewportTransform === undefined || e.target === undefined) return;\n\n    const activeObject = e.target;\n    const canvasObjects = canvas.getObjects();\n    const activeObjectCenter = activeObject.getCenterPoint();\n    const activeObjectLeft = activeObjectCenter.x;\n    const activeObjectTop = activeObjectCenter.y;\n    const activeObjectBoundingRect = activeObject.getBoundingRect();\n    const activeObjectHeight = activeObjectBoundingRect.height / viewportTransform[3];\n    const activeObjectWidth = activeObjectBoundingRect.width / viewportTransform[0];\n    let horizontalInTheRange = false;\n    let verticalInTheRange = false;\n    const transform = canvas._currentTransform;\n\n    if (!transform) return;\n\n    // It should be trivial to DRY this up by encapsulating (repeating) creation of x1, x2, y1, and y2 into functions,\n    // but we're not doing it here for perf. reasons -- as this a function that's invoked on every mouse move\n\n    for (let i = canvasObjects.length; i--;) {\n      // eslint-disable-next-line no-continue\n      if (canvasObjects[i] === activeObject) continue;\n\n      // 排除辅助线\n      if (\n        activeObject instanceof fabric.GuideLine &&\n        canvasObjects[i] instanceof fabric.GuideLine\n      ) {\n        continue;\n      }\n\n      const objectCenter = canvasObjects[i].getCenterPoint();\n      const objectLeft = objectCenter.x;\n      const objectTop = objectCenter.y;\n      const objectBoundingRect = canvasObjects[i].getBoundingRect();\n      const objectHeight = objectBoundingRect.height / viewportTransform[3];\n      const objectWidth = objectBoundingRect.width / viewportTransform[0];\n\n      // snap by the horizontal center line\n      if (isInRange(objectLeft, activeObjectLeft)) {\n        verticalInTheRange = true;\n        verticalLines.push({\n          x: objectLeft,\n          y1:\n            objectTop < activeObjectTop\n              ? objectTop - objectHeight / 2 - aligningLineOffset\n              : objectTop + objectHeight / 2 + aligningLineOffset,\n          y2:\n            activeObjectTop > objectTop\n              ? activeObjectTop + activeObjectHeight / 2 + aligningLineOffset\n              : activeObjectTop - activeObjectHeight / 2 - aligningLineOffset,\n        });\n        activeObject.setPositionByOrigin(\n          new fabric.Point(objectLeft, activeObjectTop),\n          'center',\n          'center'\n        );\n      }\n\n      // snap by the left edge\n      if (isInRange(objectLeft - objectWidth / 2, activeObjectLeft - activeObjectWidth / 2)) {\n        verticalInTheRange = true;\n        verticalLines.push({\n          x: objectLeft - objectWidth / 2,\n          y1:\n            objectTop < activeObjectTop\n              ? objectTop - objectHeight / 2 - aligningLineOffset\n              : objectTop + objectHeight / 2 + aligningLineOffset,\n          y2:\n            activeObjectTop > objectTop\n              ? activeObjectTop + activeObjectHeight / 2 + aligningLineOffset\n              : activeObjectTop - activeObjectHeight / 2 - aligningLineOffset,\n        });\n        activeObject.setPositionByOrigin(\n          new fabric.Point(objectLeft - objectWidth / 2 + activeObjectWidth / 2, activeObjectTop),\n          'center',\n          'center'\n        );\n      }\n\n      // snap by the right edge\n      if (isInRange(objectLeft + objectWidth / 2, activeObjectLeft + activeObjectWidth / 2)) {\n        verticalInTheRange = true;\n        verticalLines.push({\n          x: objectLeft + objectWidth / 2,\n          y1:\n            objectTop < activeObjectTop\n              ? objectTop - objectHeight / 2 - aligningLineOffset\n              : objectTop + objectHeight / 2 + aligningLineOffset,\n          y2:\n            activeObjectTop > objectTop\n              ? activeObjectTop + activeObjectHeight / 2 + aligningLineOffset\n              : activeObjectTop - activeObjectHeight / 2 - aligningLineOffset,\n        });\n        activeObject.setPositionByOrigin(\n          new fabric.Point(objectLeft + objectWidth / 2 - activeObjectWidth / 2, activeObjectTop),\n          'center',\n          'center'\n        );\n      }\n\n      // snap by the vertical center line\n      if (isInRange(objectTop, activeObjectTop)) {\n        horizontalInTheRange = true;\n        horizontalLines.push({\n          y: objectTop,\n          x1:\n            objectLeft < activeObjectLeft\n              ? objectLeft - objectWidth / 2 - aligningLineOffset\n              : objectLeft + objectWidth / 2 + aligningLineOffset,\n          x2:\n            activeObjectLeft > objectLeft\n              ? activeObjectLeft + activeObjectWidth / 2 + aligningLineOffset\n              : activeObjectLeft - activeObjectWidth / 2 - aligningLineOffset,\n        });\n        activeObject.setPositionByOrigin(\n          new fabric.Point(activeObjectLeft, objectTop),\n          'center',\n          'center'\n        );\n      }\n\n      // snap by the top edge\n      if (isInRange(objectTop - objectHeight / 2, activeObjectTop - activeObjectHeight / 2)) {\n        horizontalInTheRange = true;\n        horizontalLines.push({\n          y: objectTop - objectHeight / 2,\n          x1:\n            objectLeft < activeObjectLeft\n              ? objectLeft - objectWidth / 2 - aligningLineOffset\n              : objectLeft + objectWidth / 2 + aligningLineOffset,\n          x2:\n            activeObjectLeft > objectLeft\n              ? activeObjectLeft + activeObjectWidth / 2 + aligningLineOffset\n              : activeObjectLeft - activeObjectWidth / 2 - aligningLineOffset,\n        });\n        activeObject.setPositionByOrigin(\n          new fabric.Point(activeObjectLeft, objectTop - objectHeight / 2 + activeObjectHeight / 2),\n          'center',\n          'center'\n        );\n      }\n\n      // snap by the bottom edge\n      if (isInRange(objectTop + objectHeight / 2, activeObjectTop + activeObjectHeight / 2)) {\n        horizontalInTheRange = true;\n        horizontalLines.push({\n          y: objectTop + objectHeight / 2,\n          x1:\n            objectLeft < activeObjectLeft\n              ? objectLeft - objectWidth / 2 - aligningLineOffset\n              : objectLeft + objectWidth / 2 + aligningLineOffset,\n          x2:\n            activeObjectLeft > objectLeft\n              ? activeObjectLeft + activeObjectWidth / 2 + aligningLineOffset\n              : activeObjectLeft - activeObjectWidth / 2 - aligningLineOffset,\n        });\n        activeObject.setPositionByOrigin(\n          new fabric.Point(activeObjectLeft, objectTop + objectHeight / 2 - activeObjectHeight / 2),\n          'center',\n          'center'\n        );\n      }\n    }\n\n    if (!horizontalInTheRange) {\n      horizontalLines.length = 0;\n    }\n\n    if (!verticalInTheRange) {\n      verticalLines.length = 0;\n    }\n  });\n\n  canvas.on('before:render', () => {\n    // fix 保存图片时报错\n    try {\n      canvas.clearContext(canvas.contextTop);\n    } catch (error) {\n      console.log(error);\n    }\n  });\n\n  canvas.on('after:render', () => {\n    for (let i = verticalLines.length; i--;) {\n      drawVerticalLine(verticalLines[i]);\n    }\n    for (let j = horizontalLines.length; j--;) {\n      drawHorizontalLine(horizontalLines[j]);\n    }\n\n    // noinspection NestedAssignmentJS\n    verticalLines.length = 0;\n    horizontalLines.length = 0;\n  });\n\n  canvas.on('mouse:up', () => {\n    verticalLines.length = 0;\n    horizontalLines.length = 0;\n    canvas.renderAll();\n  });\n\n  return {\n    disable: () => disabled = true,\n    enable: () => disabled = false\n  }\n}\n\nexport default initAligningGuidelines;\n","// @ts-nocheck\nimport { fabric } from 'fabric';\n\n// 定义旋转光标样式，根据转动角度设定光标旋转\nfunction rotateIcon(angle: number) {\n  return `url(\"data:image/svg+xml,%3Csvg height='18' width='18' viewBox='0 0 32 32' xmlns='http://www.w3.org/2000/svg' style='color: black;'%3E%3Cg fill='none' transform='rotate(${angle} 16 16)'%3E%3Cpath d='M22.4484 0L32 9.57891L22.4484 19.1478V13.1032C17.6121 13.8563 13.7935 17.6618 13.0479 22.4914H19.2141L9.60201 32.01L0 22.4813H6.54912C7.36524 14.1073 14.0453 7.44023 22.4484 6.61688V0Z' fill='white'/%3E%3Cpath d='M24.0605 3.89587L29.7229 9.57896L24.0605 15.252V11.3562C17.0479 11.4365 11.3753 17.0895 11.3048 24.0879H15.3048L9.60201 29.7308L3.90932 24.0879H8.0806C8.14106 15.3223 15.2645 8.22345 24.0605 8.14313V3.89587Z' fill='black'/%3E%3C/g%3E%3C/svg%3E \") 12 12,crosshair`;\n}\n\nfunction initControlsRotate(canvas: fabric.Canvas) {\n  // 添加旋转控制响应区域\n  fabric.Object.prototype.controls.mtr = new fabric.Control({\n    x: -0.5,\n    y: -0.5,\n    offsetY: -10,\n    offsetX: -10,\n    rotate: 20,\n    actionName: 'rotate',\n    actionHandler: fabric.controlsUtils.rotationWithSnapping,\n    render: () => '',\n  });\n  // ↖左上\n  fabric.Object.prototype.controls.mtr2 = new fabric.Control({\n    x: 0.5,\n    y: -0.5,\n    offsetY: -10,\n    offsetX: 10,\n    rotate: 20,\n    actionName: 'rotate',\n    actionHandler: fabric.controlsUtils.rotationWithSnapping,\n    render: () => '',\n  }); // ↗右上\n  fabric.Object.prototype.controls.mtr3 = new fabric.Control({\n    x: 0.5,\n    y: 0.5,\n    offsetY: 10,\n    offsetX: 10,\n    rotate: 20,\n    actionName: 'rotate',\n    actionHandler: fabric.controlsUtils.rotationWithSnapping,\n    render: () => '',\n  }); // ↘右下\n  fabric.Object.prototype.controls.mtr4 = new fabric.Control({\n    x: -0.5,\n    y: 0.5,\n    offsetY: 10,\n    offsetX: -10,\n    rotate: 20,\n    actionName: 'rotate',\n    actionHandler: fabric.controlsUtils.rotationWithSnapping,\n    render: () => '',\n  }); // ↙左下\n\n  // 渲染时，执行\n  canvas.on('after:render', () => {\n    const activeObj = canvas.getActiveObject();\n    const angle = activeObj?.angle?.toFixed(2);\n    if (angle !== undefined) {\n      fabric.Object.prototype.controls.mtr.cursorStyle = rotateIcon(Number(angle));\n      fabric.Object.prototype.controls.mtr2.cursorStyle = rotateIcon(Number(angle) + 90);\n      fabric.Object.prototype.controls.mtr3.cursorStyle = rotateIcon(Number(angle) + 180);\n      fabric.Object.prototype.controls.mtr4.cursorStyle = rotateIcon(Number(angle) + 270);\n    }\n  });\n\n  // 旋转时，实时更新旋转控制图标\n  canvas.on('object:rotating', (event) => {\n    const body = canvas.lowerCanvasEl.nextSibling as HTMLElement;\n    const angle = canvas.getActiveObject()?.angle?.toFixed(2);\n    if (angle === undefined) return;\n    switch (event.transform?.corner) {\n      case 'mtr':\n        body.style.cursor = rotateIcon(Number(angle));\n        break;\n      case 'mtr2':\n        body.style.cursor = rotateIcon(Number(angle) + 90);\n        break;\n      case 'mtr3':\n        body.style.cursor = rotateIcon(Number(angle) + 180);\n        break;\n      case 'mtr4':\n        body.style.cursor = rotateIcon(Number(angle) + 270);\n        break;\n      default:\n        break;\n    } // 设置四角旋转光标\n  });\n}\n\nexport default initControlsRotate;\n","// @ts-nocheck\nimport { fabric } from 'fabric';\n\nclass CenterAlign {\n  canvas: fabric.Canvas;\n  constructor(canvas: fabric.Canvas) {\n    this.canvas = canvas;\n  }\n\n  centerH(workspace: fabric.Rect, object: fabric.Object) {\n    return this.canvas._centerObject(\n      object,\n      new fabric.Point(workspace.getCenterPoint().x, object.getCenterPoint().y)\n    );\n  }\n\n  center(workspace: fabric.Rect, object: fabric.Object) {\n    const center = workspace.getCenterPoint();\n    return this.canvas._centerObject(object, center);\n  }\n\n  centerV(workspace: fabric.Rect, object: fabric.Object) {\n    return this.canvas._centerObject(\n      object,\n      new fabric.Point(object.getCenterPoint().x, workspace.getCenterPoint().y)\n    );\n  }\n\n  position(name: 'centerH' | 'center' | 'centerV') {\n    const anignType = ['centerH', 'center', 'centerV'];\n    const activeObject = this.canvas.getActiveObject();\n    if (anignType.includes(name) && activeObject) {\n      const defaultWorkspace = this.canvas.getObjects().find((item) => item.id === 'workspace');\n      if (defaultWorkspace) {\n        this[name](defaultWorkspace, activeObject);\n      }\n      this.canvas.renderAll();\n    }\n  }\n}\n\nexport default CenterAlign;\n","export const KeyNames = {\n  lrdu: 'left,right,down,up', // 上下左右移动\n  shiftMove: 'shift+left,shift+right,shift+down,shift+up',\n  delete: 'delete,backspace',// 删除\n  ctrlz: 'ctrl+z,command+z', // 撤销\n  ctrlshiftz: 'ctrl+shift+z,command+shift+z', // 重做\n  enter: 'enter',\n  esc: 'esc',\n  zoom:'command+*,command+*,ctrl+*,ctrl+*'\n};\n","import hotkeys from 'hotkeys-js';\nimport type { fabric } from 'fabric';\nimport { KeyNames } from '../utils/hotEventKeys';\n\n\nfunction initHotkeys(canvas: fabric.Canvas) {\n\n  // 移动快捷键\n  hotkeys(KeyNames.lrdu, (_event, handler) => {\n    const activeObject = canvas.getActiveObject();\n    if (!activeObject) return;\n    switch (handler.key) {\n      case 'left':\n        if (activeObject.left === undefined) return;\n        activeObject.set('left', activeObject.left - 1);\n        break;\n      case 'right':\n        if (activeObject.left === undefined) return;\n        activeObject.set('left', activeObject.left + 1);\n        break;\n      case 'down':\n        if (activeObject.top === undefined) return;\n        activeObject.set('top', activeObject.top + 1);\n        break;\n      case 'up':\n        if (activeObject.top === undefined) return;\n        activeObject.set('top', activeObject.top - 1);\n        break;\n      default:\n    }\n    canvas.renderAll();\n  });\n\n  // 移动快捷键\n  hotkeys(KeyNames.shiftMove, (_event, handler) => {\n    const activeObject = canvas.getActiveObject();\n    if (!activeObject) return;\n    switch (handler.key) {\n      case 'shift+left':\n        if (activeObject.left === undefined) return;\n        activeObject.set('left', activeObject.left - 10);\n        break;\n      case 'shift+right':\n        if (activeObject.left === undefined) return;\n        activeObject.set('left', activeObject.left + 10);\n        break;\n      case 'shift+down':\n        if (activeObject.top === undefined) return;\n        activeObject.set('top', activeObject.top + 10);\n        break;\n      case 'shift+up':\n        if (activeObject.top === undefined) return;\n        activeObject.set('top', activeObject.top - 10);\n        break;\n      default:\n    }\n    canvas.renderAll();\n  });\n\n}\n\nexport default initHotkeys;\nexport { hotkeys };\n","export const Types = {\n  /**\n   * 比例修改\n   */\n  CHANGE_SCALE: 'changeScale',\n  /**\n   * 监听画布修改啊，这个事件用来做数据存储的，主要是增删改会调用\n   * TODO 如果新增了增删改的操作记得调用这个方法\n   */\n  CANVAS_CHANGE: 'canvasChange',\n  /**\n   * 剪裁图片\n   */\n  CLIP_IMAGE: 'clipImage',\n\n  SHOW_LOADING: 'show_loading'\n}\n","import EventEmitter from 'events'\nimport { Types } from './types';\n\n\nexport const events = new EventEmitter()\nexport { Types }\n","export const isObject = (value: unknown): value is Record<any, any> =>\n  value !== null && typeof value === 'object';\nexport const isFunction = (value: unknown): value is (...args: any) => any =>\n  typeof value === 'function';\nexport const isString = (value: unknown): value is string => typeof value === 'string';\nexport const isBoolean = (value: unknown): value is boolean => typeof value === 'boolean';\nexport const isNumber = (value: unknown): value is number => typeof value === 'number';\nexport const isUndef = (value: unknown): value is undefined => typeof value === 'undefined';\nexport const isUrl = (value: unknown): value is string => value && isString(value) && value.startsWith('http')\n","// @ts-nocheck\nimport { fabric } from 'fabric';\nimport { events, Types } from '../utils/events';\nimport { uuid } from '../utils/utils';\nimport { isNumber, isUndef } from '../utils';\nimport { scaleX, scaleY } from 'fontfaceobserver';\n// 竖线\nconst verticalImg = 'https://ossprod.jrdaimao.com/file/1691055918106919.svg'\n// 圆点\nconst edgeImg = 'https://ossprod.jrdaimao.com/file/1691055938230666.svg'\n// 旋转\nconst rotateImg = 'https://ossprod.jrdaimao.com/file/1691574701262500.svg'\n// 横线\nconst horizontalImg = 'https://ossprod.jrdaimao.com/file/1691055964267980.svg'\n// 复制\nconst copyImg = 'https://ossprod.jrdaimao.com/file/1691660518949720.svg'\n// 删除\nconst deleteImg = 'https://ossprod.jrdaimao.com/file/1691662370382182.svg'\n// 剪裁\nconst clipImg = 'https://ossprod.jrdaimao.com/file/1691718842537240.svg'\n// bg\nconst topBgImg = 'https://ossprod.jrdaimao.com/file/1691978616647204.svg'\n/**\n * 实际场景: 在进行某个对象缩放的时候，由于fabric.js默认精度使用的是toFixed(2)。\n * 此处为了缩放的精度更准确一些，因此将NUM_FRACTION_DIGITS默认值改为4，即toFixed(4).\n */\nfabric.Object.NUM_FRACTION_DIGITS = 4;\n\n// 隐藏八个角缩放按钮\nexport const setBaseControlVisible = (object, visible) => {\n  if (!object) return\n  object.setControlsVisibility({\n    mt: visible,\n    mb: visible,\n    ml: visible,\n    mr: visible,\n    tl: visible,\n    tr: visible,\n    bl: visible,\n    br: visible\n  })\n}\n// 隐藏自定义高级操作按钮\nexport const setHighControlVisible = (object, visible) => {\n  if (!object) return\n  object.setControlsVisibility({\n    copy: visible,\n    delete: visible,\n    clip: visible,\n    rotate: visible,\n    topBg: visible\n  })\n}\n\nfunction drawImg(\n  ctx: CanvasRenderingContext2D,\n  left: number,\n  top: number,\n  img: HTMLImageElement,\n  wSize: number,\n  hSize: number,\n  angle: number | undefined\n) {\n  if (angle === undefined) return;\n  ctx.save();\n  ctx.translate(left, top);\n  ctx.rotate(fabric.util.degreesToRadians(angle));\n  ctx.drawImage(img, -wSize / 2, -hSize / 2, wSize, hSize);\n  ctx.restore();\n}\n\n// 中间横杠\nfunction intervalControl() {\n  const verticalImgIcon = document.createElement('img');\n  verticalImgIcon.src = verticalImg;\n\n  const horizontalImgIcon = document.createElement('img');\n  horizontalImgIcon.src = horizontalImg;\n\n  function renderIcon(\n    ctx: CanvasRenderingContext2D,\n    left: number,\n    top: number,\n    styleOverride: any,\n    fabricObject: fabric.Object\n  ) {\n    drawImg(ctx, left, top, verticalImgIcon, 20, 25, fabricObject.angle);\n  }\n\n  function renderIconHoz(\n    ctx: CanvasRenderingContext2D,\n    left: number,\n    top: number,\n    styleOverride: any,\n    fabricObject: fabric.Object\n  ) {\n    drawImg(ctx, left, top, horizontalImgIcon, 25, 20, fabricObject.angle);\n  }\n\n  // 中间横杠\n  fabric.Object.prototype.controls.ml = new fabric.Control({\n    x: -0.5,\n    y: 0,\n    offsetX: -1,\n    cursorStyleHandler: fabric.controlsUtils.scaleSkewCursorStyleHandler,\n    actionHandler: fabric.controlsUtils.scalingXOrSkewingY,\n    getActionName: fabric.controlsUtils.scaleOrSkewActionName,\n    render: renderIcon,\n  });\n\n  fabric.Object.prototype.controls.mr = new fabric.Control({\n    x: 0.5,\n    y: 0,\n    offsetX: 1,\n    cursorStyleHandler: fabric.controlsUtils.scaleSkewCursorStyleHandler,\n    actionHandler: fabric.controlsUtils.scalingXOrSkewingY,\n    getActionName: fabric.controlsUtils.scaleOrSkewActionName,\n    render: renderIcon,\n  });\n\n  fabric.Object.prototype.controls.mb = new fabric.Control({\n    x: 0,\n    y: 0.5,\n    offsetY: 1,\n    cursorStyleHandler: fabric.controlsUtils.scaleSkewCursorStyleHandler,\n    actionHandler: fabric.controlsUtils.scalingYOrSkewingX,\n    getActionName: fabric.controlsUtils.scaleOrSkewActionName,\n    render: renderIconHoz,\n  });\n\n  fabric.Object.prototype.controls.mt = new fabric.Control({\n    x: 0,\n    y: -0.5,\n    offsetY: -1,\n    cursorStyleHandler: fabric.controlsUtils.scaleSkewCursorStyleHandler,\n    actionHandler: fabric.controlsUtils.scalingYOrSkewingX,\n    getActionName: fabric.controlsUtils.scaleOrSkewActionName,\n    render: renderIconHoz,\n  });\n}\n\n// 顶点\nfunction peakControl() {\n  const img = document.createElement('img');\n  img.src = edgeImg;\n\n  function renderIconEdge(\n    ctx: CanvasRenderingContext2D,\n    left: number,\n    top: number,\n    styleOverride: any,\n    fabricObject: fabric.Object\n  ) {\n    drawImg(ctx, left, top, img, 25, 25, fabricObject.angle);\n  }\n\n  // 四角图标\n  fabric.Object.prototype.controls.tl = new fabric.Control({\n    x: -0.5,\n    y: -0.5,\n    cursorStyleHandler: fabric.controlsUtils.scaleCursorStyleHandler,\n    actionHandler: fabric.controlsUtils.scalingEqually,\n    render: renderIconEdge,\n  });\n  fabric.Object.prototype.controls.bl = new fabric.Control({\n    x: -0.5,\n    y: 0.5,\n    cursorStyleHandler: fabric.controlsUtils.scaleCursorStyleHandler,\n    actionHandler: fabric.controlsUtils.scalingEqually,\n    render: renderIconEdge,\n  });\n  fabric.Object.prototype.controls.tr = new fabric.Control({\n    x: 0.5,\n    y: -0.5,\n    cursorStyleHandler: fabric.controlsUtils.scaleCursorStyleHandler,\n    actionHandler: fabric.controlsUtils.scalingEqually,\n    render: renderIconEdge,\n  });\n  fabric.Object.prototype.controls.br = new fabric.Control({\n    x: 0.5,\n    y: 0.5,\n    cursorStyleHandler: fabric.controlsUtils.scaleCursorStyleHandler,\n    actionHandler: fabric.controlsUtils.scalingEqually,\n    render: renderIconEdge,\n  });\n}\n\n// 旋转\nfunction rotationControl() {\n  const img = document.createElement('img');\n  img.src = rotateImg;\n\n  function renderIconRotate(\n    ctx: CanvasRenderingContext2D,\n    left: number,\n    top: number,\n    styleOverride: any,\n    fabricObject: fabric.Object\n  ) {\n    drawImg(ctx, left, top, img, 60, 60, fabricObject.angle);\n  }\n\n  // 旋转图标\n  fabric.Object.prototype.controls.rotate = new fabric.Control({\n    y: 0.5,\n    cursorStyleHandler: fabric.controlsUtils.rotationStyleHandler,\n    actionHandler: fabric.controlsUtils.rotationWithSnapping,\n    offsetY: 25,\n    actionName: 'rotate',\n    cursorStyle: 'pointer',\n    render: renderIconRotate,\n  });\n\n}\n\n// 自定义操作\nfunction initMainControl() {\n  const topBgEl = document.createElement('img')\n  topBgEl.src = topBgImg\n  const copyImageEl = document.createElement('img')\n  copyImageEl.src = copyImg\n  const deleteImageEl = document.createElement('img')\n  deleteImageEl.src = deleteImg\n  const clipImageEl = document.createElement('img')\n  clipImageEl.src = clipImg\n\n  function cloneObject(eventData, transform) {\n    const target = transform.target;\n    if (!target) return\n    const canvas = target.canvas;\n    events.emit(Types.SHOW_LOADING, true)\n    target.clone(function (cloned) {\n      cloned.set({\n        id: uuid(),\n        left: target.left + 20,\n        top: target.top + 20,\n        sourceSrc: target.sourceSrc,\n        rawScaleX: target.rawScaleX,\n        rawScaleY: target.rawScaleY,\n        rectDiffLeft: target.rectDiffLeft,\n        rectDiffTop: target.rectDiffTop,\n        prevWidth: target.prevWidth,\n        prevHeight: target.prevHeight\n      })\n      cloned.setCoords()\n      canvas.add(cloned)\n      canvas.setActiveObject(cloned)\n      canvas.renderAll()\n      events.emit(Types.SHOW_LOADING, false)\n    });\n  }\n\n  function deleteObject(eventData, transform) {\n    const target = transform.target;\n    if (!target) return\n    const canvas = target.canvas;\n    const clipRect = canvas.getObjects().find(item => item.id === 'currentClipRect')\n    if (clipRect) {\n      canvas.remove(clipRect)\n    }\n    canvas.remove(target);\n    canvas.requestRenderAll();\n  }\n\n  function clipObject(eventData, transform) {\n    const image = transform.target;\n    if (image.type !== 'image') return\n    const canvas = image.canvas;\n    const rectLeft = image.left // 矩形的位置X\n    const rectTop = image.top // 矩形的位置Y\n    const sourceSrc = image.sourceSrc // 原图的src，做回显的时候需要用\n    const rawScaleX = image.rawScaleX || image.scaleX // 原图的缩放比例X\n    const rawScaleY = image.rawScaleY || image.scaleY // 原图的缩放比例Y\n    const rectDiffLeft = image.rectDiffLeft // 图片距离rect裁剪框的偏差X\n    const rectDiffTop = image.rectDiffTop // 图片距离rect裁剪框的偏差Y\n    const index = canvas.getObjects().findIndex(item => item.id === image.id); // 获取到裁剪之前的层级\n    const sourceWidth = image.getScaledWidth() // 获取图片的宽，这就是裁剪框的宽\n    const sourceHeight = image.getScaledHeight() // 获取图片的高，这就是裁剪框的高\n    image.clone((o) => image.set({cloneObject: o})) // 克隆一个object，取消裁剪的时候会用到\n    if (sourceSrc) {\n      // 如果有sourceSrc代表之前裁剪过，这里那原图的src进行返显\n      image.setSrc(sourceSrc, () => {\n        canvas.renderAll()\n      }, {crossOrigin: 'anonymous'})\n      /**\n       * 设置原图的位置和原图的缩放比\n       * 缩放比：这个是在外面操作的时候计算好的，直接赋值就行\n       * 位置：\n       */\n      image.set({\n        id: 'clipRawImage',\n        scaleX: rawScaleX,\n        scaleY: rawScaleY,\n        left: !isUndef(rectDiffLeft) ? image.left - (rectDiffLeft * image.scaleX) : image.left,\n        top: !isUndef(rectDiffTop) ? image.top - (rectDiffTop * image.scaleY) : image.top,\n      })\n    }\n    image.bringToFront() // 将这个图片的层级移动到顶层\n    setHighControlVisible(image, false) // 正在裁剪中的图片，把他的一些功能干掉\n    // 创建一个矩形，让他在图片的上面\n    const selectionRect = new fabric.Rect({\n      left: rectLeft,\n      top: rectTop,\n      fill: \"rgba(0,0,0,0.3)\",\n      originX: \"left\",\n      originY: \"top\",\n      stroke: \"black\",\n      opacity: 1,\n      width: sourceWidth,\n      height: sourceHeight,\n      hasRotatingPoint: false,\n      transparentCorners: false,\n      cornerColor: \"white\",\n      cornerStrokeColor: \"black\",\n      borderColor: \"black\",\n      cornerSize: 12,\n      padding: 0,\n      cornerStyle: \"circle\",\n      borderDashArray: [5, 5],\n      borderScaleFactor: 1.3,\n      id: 'currentClipRect',\n      lockMovementX: true,\n      lockMovementY: true,\n      hoverCursor: 'default'\n    });\n    // 存一下原图的src，因为后面裁剪后生成的图片就是base64了\n    image.set({sourceSrc: image.sourceSrc || image._element.src})\n\n    let selectionRectDown = false\n    let imageDown = false\n    // 监听鼠标按下事件\n    selectionRect.on('mousedown', ({}) => selectionRectDown = true)\n    // 监听鼠标缩放事件\n    selectionRect.on('scaling', () => selectionRectDown = false)\n    // 控制rect的拖动区域\n    selectionRect.on('mousemove', ({e}) => {\n      if (!selectionRectDown) return\n      setBaseControlVisible(selectionRect, false)\n      image.set({\n        left: image.left + e.movementX,\n        top: image.top + e.movementY\n      });\n      if (image.left > selectionRect.left) {\n        image.set({left: selectionRect.left})\n      }\n      const rectWidth = selectionRect.getScaledWidth()\n      if (image.left + image.getScaledWidth() <= selectionRect.left + rectWidth) {\n        image.set({left: selectionRect.left + rectWidth - image.getScaledWidth()})\n      }\n      if (image.top > selectionRect.top) {\n        image.set({top: selectionRect.top})\n      }\n      const rectHeight = selectionRect.getScaledHeight()\n      if (image.top + image.getScaledHeight() <= selectionRect.top + rectHeight) {\n        image.set({top: selectionRect.top + rectHeight - image.getScaledHeight()})\n      }\n      canvas.renderAll()\n    })\n    // 监听鼠标抬起事件\n    selectionRect.on('mouseup', () => {\n      selectionRectDown = false\n      setBaseControlVisible(selectionRect, true)\n      canvas.renderAll()\n    })\n    // 监听rect八个角缩放的事件\n    selectionRect.on('scaling', (e) => {\n      const rect = e.transform.target\n      if (rect.left < image.left) {\n        rect.set({left: image.left})\n      }\n      if (rect.top < image.top) {\n        rect.set({top: image.top})\n      }\n      if (rect.left + rect.getScaledWidth() > image.left + image.getScaledWidth()) {\n        rect.set({left: image.left + image.getScaledWidth() - rect.getScaledWidth()})\n      }\n      if (rect.top + rect.getScaledHeight() > image.top + image.getScaledHeight()) {\n        rect.set({top: image.top + image.getScaledHeight() - rect.getScaledHeight()})\n      }\n      if (image.getScaledWidth() / rect.getScaledWidth() < 1) {\n        rect.set({\n          scaleX: image.getScaledWidth() / selectionRect.getScaledWidth() * rect.get('scaleX'),\n          left: image.left,\n        })\n      }\n      if (image.getScaledHeight() / rect.getScaledHeight() < 1) {\n        rect.set({\n          scaleY: image.getScaledHeight() / selectionRect.getScaledHeight() * rect.get('scaleY'),\n          top: image.top\n        })\n      }\n      canvas.renderAll()\n    });\n    // 控制图片的拖动区域\n    image.on('moving', (e) => {\n      const image = e.transform.target\n      if (image.left > selectionRect.left) {\n        image.set({left: selectionRect.left})\n      }\n      if (image.top > selectionRect.top) {\n        image.set({top: selectionRect.top})\n      }\n      const rectWidth = selectionRect.getScaledWidth()\n      if (image.left < selectionRect.left + rectWidth - image.getScaledWidth()) {\n        image.set({left: selectionRect.left + rectWidth - image.getScaledWidth()})\n      }\n      const rectHeight = selectionRect.getScaledHeight()\n      if (image.top < selectionRect.top + rectHeight - image.getScaledHeight()) {\n        image.set({top: selectionRect.top + rectHeight - image.getScaledHeight()})\n      }\n      canvas.renderAll()\n    })\n    // 监听图片八个角缩放事件\n    image.on('scaling', (e) => {\n      const image = e.transform.target\n      if (image.left > selectionRect.left) {\n        image.set({left: selectionRect.left})\n      }\n      if (image.top > selectionRect.top) {\n        image.set({top: selectionRect.top})\n      }\n      if (selectionRect.getScaledWidth() / image.getScaledWidth() > 1) {\n        image.set({scaleX: selectionRect.getScaledWidth() * image.get('scaleX') / image.getScaledWidth()})\n      }\n      if (selectionRect.getScaledHeight() / image.getScaledHeight() > 1) {\n        image.set({scaleY: selectionRect.getScaledHeight() * image.get('scaleY') / image.getScaledHeight()})\n      }\n      canvas.renderAll()\n    });\n    image.on('mousedown', () => imageDown = true)\n    image.on('mousemove', () => {\n      if (imageDown) {\n        setBaseControlVisible(image, false)\n        canvas.renderAll()\n      }\n    })\n    image.on('mouseup', () => {\n      imageDown = false\n      setBaseControlVisible(image, true)\n      canvas.renderAll()\n    })\n    // 矩形不要操作按钮，将它们隐藏\n    setHighControlVisible(selectionRect, false)\n    canvas.add(selectionRect);\n    canvas.setActiveObject(selectionRect)\n    canvas.renderAll();\n    // 告诉HeaderControl我要开始裁剪了\n    events.emit(Types.CLIP_IMAGE, {\n      visible: true, // 展示裁剪确定、取消按钮\n      rawIndex: index, // 裁剪之前的层级index\n      clipImageId: image.id, // 正在被裁剪的图片的id\n    })\n  }\n\n  fabric.Object.prototype.controls.topBg = new fabric.Control({\n    y: -0.5,\n    cursorStyleHandler: fabric.controlsUtils.rotationStyleHandler,\n    mouseUpHandler: () => {\n    },\n    offsetY: -25,\n    cursorStyle: 'pointer',\n    render: (ctx, left, top, styleOverride, fabricObject) => {\n      if (fabricObject.type === 'image') {\n        drawImg(ctx, left, top, topBgEl, 136, 68, fabricObject.angle);\n      }\n      if (fabricObject.type === 'i-text') {\n        drawImg(ctx, left, top, topBgEl, 90, 68, fabricObject.angle);\n      }\n    },\n  });\n  // 复制\n  fabric.Object.prototype.controls.copy = new fabric.Control({\n    y: -0.5,\n    cursorStyleHandler: fabric.controlsUtils.rotationStyleHandler,\n    mouseUpHandler: cloneObject,\n    offsetY: -25,\n    offsetX: -30,\n    cursorStyle: 'pointer',\n    render: (ctx, left, top, styleOverride, fabricObject) => {\n      if (fabricObject.type === 'image') {\n        drawImg(ctx, left, top, copyImageEl, 30, 30, fabricObject.angle);\n      }\n    },\n  });\n  // 删除\n  fabric.Object.prototype.controls.delete = new fabric.Control({\n    y: -0.5,\n    cursorStyleHandler: fabric.controlsUtils.rotationStyleHandler,\n    mouseUpHandler: deleteObject,\n    offsetY: -25,\n    offsetX: 30,\n    cursorStyle: 'pointer',\n    render: (ctx, left, top, styleOverride, fabricObject) => {\n      if (fabricObject.type === 'image') {\n        drawImg(ctx, left, top, deleteImageEl, 30, 30, fabricObject.angle);\n      }\n    },\n  });\n  // 剪裁\n  fabric.Object.prototype.controls.clip = new fabric.Control({\n    y: -0.5,\n    cursorStyleHandler: fabric.controlsUtils.rotationStyleHandler,\n    mouseUpHandler: clipObject,\n    offsetY: -25,\n    offsetX: 0,\n    cursorStyle: 'pointer',\n    render: (ctx, left, top, styleOverride, fabricObject) => {\n      if (fabricObject.type === 'image') {\n        drawImg(ctx, left, top, clipImageEl, 30, 30, fabricObject.angle);\n      }\n    },\n  });\n  // 复制\n  fabric.Object.prototype.controls.textC = new fabric.Control({\n    y: -0.5,\n    cursorStyleHandler: fabric.controlsUtils.rotationStyleHandler,\n    mouseUpHandler: cloneObject,\n    offsetY: -25,\n    offsetX: -15,\n    cursorStyle: 'pointer',\n    render: (ctx, left, top, styleOverride, fabricObject) => {\n      if (fabricObject.type === 'i-text') {\n        drawImg(ctx, left, top, copyImageEl, 30, 30, fabricObject.angle);\n      }\n    },\n  });\n  // 删除\n  fabric.Object.prototype.controls.textdelete = new fabric.Control({\n    y: -0.5,\n    cursorStyleHandler: fabric.controlsUtils.rotationStyleHandler,\n    mouseUpHandler: deleteObject,\n    offsetY: -25,\n    offsetX: 15,\n    cursorStyle: 'pointer',\n    render: (ctx, left, top, styleOverride, fabricObject) => {\n      if (fabricObject.type === 'i-text') {\n        drawImg(ctx, left, top, deleteImageEl, 30, 30, fabricObject.angle);\n      }\n    },\n  });\n}\n\nfunction initControls(canvas: fabric.Canvas) {\n  // 顶点图标\n  peakControl();\n  // 中间横杠图标\n  intervalControl();\n  // 旋转图标\n  rotationControl();\n  // 初始化自定义操作\n  initMainControl();\n\n  // 选中样式\n  fabric.Object.prototype.set({\n    transparentCorners: false,\n    borderColor: '#51B9F9',\n    cornerColor: '#FFF',\n    borderScaleFactor: 2.5,\n    cornerStyle: 'circle',\n    cornerStrokeColor: '#0E98FC',\n    borderOpacityWhenMoving: 1,\n  });\n  // textbox保持一致\n  // fabric.Textbox.prototype.controls = fabric.Object.prototype.controls;\n}\n\nexport default initControls;\n","import type { Rect } from './ruler';\nimport { fabric } from 'fabric';\n\n/**\n * 计算尺子间距\n * @param zoom 缩放比例\n * @returns 返回计算出的尺子间距\n */\nconst getGap = (zoom: number) => {\n  const zooms = [0.02, 0.03, 0.05, 0.1, 0.2, 0.5, 1, 2, 5, 10, 18];\n  const gaps = [5000, 2500, 1000, 500, 250, 100, 50, 25, 10, 5, 2];\n\n  let i = 0;\n  while (i < zooms.length && zooms[i] < zoom) {\n    i++;\n  }\n\n  return gaps[i - 1] || 5000;\n};\n\n/**\n * 线段合并\n * @param rect Rect数组\n * @param isHorizontal\n * @returns 合并后的Rect数组\n */\nconst mergeLines = (rect: Rect[], isHorizontal: boolean) => {\n  const axis = isHorizontal ? 'left' : 'top';\n  const length = isHorizontal ? 'width' : 'height';\n  // 先按照 axis 的大小排序\n  rect.sort((a, b) => a[axis] - b[axis]);\n  const mergedLines = [];\n  let currentLine = Object.assign({}, rect[0]);\n  for (const item of rect) {\n    const line = Object.assign({}, item);\n    if (currentLine[axis] + currentLine[length] >= line[axis]) {\n      // 当前线段和下一个线段相交，合并宽度\n      currentLine[length] =\n        Math.max(currentLine[axis] + currentLine[length], line[axis] + line[length]) -\n        currentLine[axis];\n    } else {\n      // 当前线段和下一个线段不相交，将当前线段加入结果数组中，并更新当前线段为下一个线段\n      mergedLines.push(currentLine);\n      currentLine = Object.assign({}, line);\n    }\n  }\n  // 加入数组\n  mergedLines.push(currentLine);\n  return mergedLines;\n};\n\nconst darwLine = (\n  ctx: CanvasRenderingContext2D,\n  options: {\n    left: number;\n    top: number;\n    width: number;\n    height: number;\n    stroke?: string | CanvasGradient | CanvasPattern;\n    lineWidth?: number;\n  }\n) => {\n  ctx.save();\n  const { left, top, width, height, stroke, lineWidth } = options;\n  ctx.beginPath();\n  stroke && (ctx.strokeStyle = stroke);\n  ctx.lineWidth = lineWidth || 1;\n  ctx.moveTo(left, top);\n  ctx.lineTo(left + width, top + height);\n  ctx.stroke();\n  ctx.restore();\n};\n\nconst darwText = (\n  ctx: CanvasRenderingContext2D,\n  options: {\n    left: number;\n    top: number;\n    text: string;\n    fill?: string | CanvasGradient | CanvasPattern;\n    align?: CanvasTextAlign;\n    angle?: number;\n    fontSize?: number;\n  }\n) => {\n  ctx.save();\n  const { left, top, text, fill, align, angle, fontSize } = options;\n  fill && (ctx.fillStyle = fill);\n  ctx.textAlign = align || 'left';\n  ctx.textBaseline = 'top';\n  ctx.font = `${fontSize || 10}px sans-serif`;\n  if (angle) {\n    ctx.translate(left, top);\n    ctx.rotate((Math.PI / 180) * angle);\n    ctx.translate(-left, -top);\n  }\n  ctx.fillText(text, left, top);\n  ctx.restore();\n};\n\nconst darwRect = (\n  ctx: CanvasRenderingContext2D,\n  options: {\n    left: number;\n    top: number;\n    width: number;\n    height: number;\n    fill?: string | CanvasGradient | CanvasPattern;\n    stroke?: string;\n    strokeWidth?: number;\n  }\n) => {\n  ctx.save();\n  const { left, top, width, height, fill, stroke, strokeWidth } = options;\n  ctx.beginPath();\n  fill && (ctx.fillStyle = fill);\n  ctx.rect(left, top, width, height);\n  ctx.fill();\n  if (stroke) {\n    ctx.strokeStyle = stroke;\n    ctx.lineWidth = strokeWidth || 1;\n    ctx.stroke();\n  }\n  ctx.restore();\n};\n\nconst drawMask = (\n  ctx: CanvasRenderingContext2D,\n  options: {\n    isHorizontal: boolean;\n    left: number;\n    top: number;\n    width: number;\n    height: number;\n    backgroundColor: string;\n  }\n) => {\n  ctx.save();\n  const { isHorizontal, left, top, width, height, backgroundColor } = options;\n  // 创建一个线性渐变对象\n  const gradient = isHorizontal\n    ? ctx.createLinearGradient(left, height / 2, left + width, height / 2)\n    : ctx.createLinearGradient(width / 2, top, width / 2, height + top);\n  const transparentColor = new fabric.Color(backgroundColor);\n  transparentColor.setAlpha(0);\n  gradient.addColorStop(0, transparentColor.toRgba());\n  gradient.addColorStop(0.33, backgroundColor);\n  gradient.addColorStop(0.67, backgroundColor);\n  gradient.addColorStop(1, transparentColor.toRgba());\n  darwRect(ctx, {\n    left,\n    top,\n    width,\n    height,\n    fill: gradient,\n  });\n  ctx.restore();\n};\n\nexport { getGap, mergeLines, darwRect, darwText, darwLine, drawMask };\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable @typescript-eslint/no-unused-vars */\n// @ts-nocheck\nimport { fabric } from 'fabric';\n\nexport function setupGuideLine() {\n  if (fabric.GuideLine) {\n    return;\n  }\n\n  fabric.GuideLine = fabric.util.createClass(fabric.Line, {\n    type: 'GuideLine',\n    selectable: false,\n    hasControls: false,\n    hasBorders: false,\n    stroke: '#4bec13',\n    originX: 'center',\n    originY: 'center',\n    padding: 4, // 填充，让辅助线选择范围更大，方便选中\n    globalCompositeOperation: 'difference',\n    axis: 'horizontal',\n    // excludeFromExport: true,\n\n    initialize(points, options) {\n      const isHorizontal = options.axis === 'horizontal';\n      // 指针\n      this.hoverCursor = isHorizontal ? 'ns-resize' : 'ew-resize';\n      // 设置新的点\n      const newPoints = isHorizontal\n        ? [-999999, points, 999999, points]\n        : [points, -999999, points, 999999];\n      // 锁定移动\n      options[isHorizontal ? 'lockMovementX' : 'lockMovementY'] = true;\n      // 调用父类初始化\n      this.callSuper('initialize', newPoints, options);\n\n      // 绑定事件\n      this.on('mousedown:before', (e) => {\n        if (this.activeOn === 'down') {\n          // 设置selectable:false后激活对象才能进行移动\n          this.canvas.setActiveObject(this, e.e);\n        }\n      });\n\n      this.on('moving', (e) => {\n        if (this.canvas.ruler.options.enabled && this.isPointOnRuler(e.e)) {\n          this.moveCursor = 'not-allowed';\n        } else {\n          this.moveCursor = this.isHorizontal() ? 'ns-resize' : 'ew-resize';\n        }\n        this.canvas.fire('guideline:moving', {\n          target: this,\n          e: e.e,\n        });\n      });\n\n      this.on('mouseup', (e) => {\n        // 移动到标尺上，移除辅助线\n        if (this.canvas.ruler.options.enabled && this.isPointOnRuler(e.e)) {\n          // console.log('移除辅助线', this);\n          this.canvas.remove(this);\n          return;\n        }\n        this.moveCursor = this.isHorizontal() ? 'ns-resize' : 'ew-resize';\n        this.canvas.fire('guideline:mouseup', {\n          target: this,\n          e: e.e,\n        });\n      });\n\n      this.on('removed', () => {\n        this.off('removed');\n        this.off('mousedown:before');\n        this.off('moving');\n        this.off('mouseup');\n      });\n    },\n\n    getBoundingRect(absolute, calculate) {\n      this.bringToFront();\n\n      const isHorizontal = this.isHorizontal();\n      const rect = this.callSuper('getBoundingRect', absolute, calculate);\n      rect[isHorizontal ? 'top' : 'left'] += rect[isHorizontal ? 'height' : 'width'] / 2;\n      rect[isHorizontal ? 'height' : 'width'] = 0;\n      return rect;\n    },\n\n    isPointOnRuler(e) {\n      const isHorizontal = this.isHorizontal();\n      const hoveredRuler = this.canvas.ruler.isPointOnRuler(new fabric.Point(e.offsetX, e.offsetY));\n      if (\n        (isHorizontal && hoveredRuler === 'horizontal') ||\n        (!isHorizontal && hoveredRuler === 'vertical')\n      ) {\n        return hoveredRuler;\n      }\n      return false;\n    },\n\n    isHorizontal() {\n      return this.height === 0;\n    },\n  } as fabric.IGuideLineClassOptions);\n\n  fabric.GuideLine.fromObject = function (object, callback) {\n    const clone = fabric.util.object.clone as (object: any, deep: boolean) => any;\n\n    function _callback(instance: any) {\n      delete instance.xy;\n      callback && callback(instance);\n    }\n\n    const options = clone(object, true);\n    const isHorizontal = options.height === 0;\n\n    options.xy = isHorizontal ? options.y1 : options.x1;\n    options.axis = isHorizontal ? 'horizontal' : 'vertical';\n\n    fabric.Object._fromObject(options.type, options, _callback, 'xy');\n  };\n}\n\nexport default fabric.GuideLine;\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n// @ts-nocheck\nimport { Canvas, Point, IEvent } from 'fabric/fabric-impl';\nimport { fabric } from 'fabric';\nimport { getGap, mergeLines, darwRect, darwText, darwLine, drawMask } from './utils';\nimport { throttle } from '../../utils/utils';\nimport { setupGuideLine } from './guideline';\n\n/**\n * 配置\n */\nexport interface RulerOptions {\n  /**\n   * Canvas\n   */\n  canvas: Canvas;\n\n  /**\n   * 标尺宽高\n   * @default 20\n   */\n  ruleSize?: number;\n\n  /**\n   * 字体大小\n   * @default 10\n   */\n  fontSize?: number;\n\n  /**\n   * 是否开启标尺\n   * @default false\n   */\n  enabled?: boolean;\n\n  /**\n   * 背景颜色\n   */\n  backgroundColor?: string;\n\n  /**\n   * 文字颜色\n   */\n  textColor?: string;\n\n  /**\n   * 边框颜色\n   */\n  borderColor?: string;\n\n  /**\n   * 高亮颜色\n   */\n  highlightColor?: string;\n}\n\nexport type Rect = { left: number; top: number; width: number; height: number };\n\nexport type HighlightRect = {\n  skip?: 'x' | 'y';\n} & Rect;\n\nclass CanvasRuler {\n  protected ctx: CanvasRenderingContext2D;\n\n  /**\n   * 配置\n   */\n  public options: Required<RulerOptions>;\n\n  /**\n   * 标尺起始点\n   */\n  public startCalibration: undefined | Point;\n\n  private activeOn: 'down' | 'up' = 'up';\n\n  /**\n   * 选取对象矩形坐标\n   */\n  private objectRect:\n    | undefined\n    | {\n        x: HighlightRect[];\n        y: HighlightRect[];\n      };\n\n  /**\n   * 事件句柄缓存\n   */\n  private eventHandler: Record<string, (...args: any) => void> = {\n    // calcCalibration: this.calcCalibration.bind(this),\n    calcObjectRect: throttle(this.calcObjectRect.bind(this), 15),\n    clearStatus: this.clearStatus.bind(this),\n    canvasMouseDown: this.canvasMouseDown.bind(this),\n    canvasMouseMove: throttle(this.canvasMouseMove.bind(this), 15),\n    canvasMouseUp: this.canvasMouseUp.bind(this),\n    render: (e: any) => {\n      // 避免多次渲染\n      if (!e.ctx) return;\n      this.render();\n    },\n  };\n\n  private lastAttr: {\n    status: 'out' | 'horizontal' | 'vertical';\n    cursor: string | undefined;\n    selection: boolean | undefined;\n  } = {\n    status: 'out',\n    cursor: undefined,\n    selection: undefined,\n  };\n\n  private tempGuidelLine: fabric.GuideLine | undefined;\n\n  constructor(_options: RulerOptions) {\n    // 合并默认配置\n    this.options = Object.assign(\n      {\n        ruleSize: 20,\n        fontSize: 10,\n        enabled: false,\n        backgroundColor: '#fff',\n        borderColor: '#ddd',\n        highlightColor: '#007fff',\n        textColor: '#888',\n      },\n      _options\n    );\n\n    this.ctx = this.options.canvas.getContext();\n\n    fabric.util.object.extend(this.options.canvas, {\n      ruler: this,\n    });\n\n    setupGuideLine();\n\n    if (this.options.enabled) {\n      this.enable();\n    }\n  }\n\n  // 销毁\n  public destroy() {\n    this.disable();\n  }\n\n  /**\n   * 移除全部辅助线\n   */\n  public clearGuideline() {\n    this.options.canvas.remove(...this.options.canvas.getObjects(fabric.GuideLine.prototype.type));\n  }\n\n  /**\n   * 显示全部辅助线\n   */\n  public showGuideline() {\n    this.options.canvas.getObjects(fabric.GuideLine.prototype.type).forEach((guideLine) => {\n      guideLine.set('visible', true);\n    });\n    this.options.canvas.renderAll();\n  }\n\n  /**\n   * 隐藏全部辅助线\n   */\n  public hideGuideline() {\n    this.options.canvas.getObjects(fabric.GuideLine.prototype.type).forEach((guideLine) => {\n      guideLine.set('visible', false);\n    });\n    this.options.canvas.renderAll();\n  }\n\n  /**\n   * 启用\n   */\n  public enable() {\n    this.options.enabled = true;\n\n    // 绑定事件\n    this.options.canvas.on('after:render', this.eventHandler.calcObjectRect);\n    this.options.canvas.on('after:render', this.eventHandler.render);\n    this.options.canvas.on('mouse:down', this.eventHandler.canvasMouseDown);\n    this.options.canvas.on('mouse:move', this.eventHandler.canvasMouseMove);\n    this.options.canvas.on('mouse:up', this.eventHandler.canvasMouseUp);\n    this.options.canvas.on('selection:cleared', this.eventHandler.clearStatus);\n\n    // 显示辅助线\n    this.showGuideline();\n\n    // 绘制一次\n    this.render();\n  }\n\n  /**\n   * 禁用\n   */\n  public disable() {\n    // 解除事件\n    this.options.canvas.off('after:render', this.eventHandler.calcObjectRect);\n    this.options.canvas.off('after:render', this.eventHandler.render);\n    this.options.canvas.off('mouse:down', this.eventHandler.canvasMouseDown);\n    this.options.canvas.off('mouse:move', this.eventHandler.canvasMouseMove);\n    this.options.canvas.off('mouse:up', this.eventHandler.canvasMouseUp);\n    this.options.canvas.off('selection:cleared', this.eventHandler.clearStatus);\n\n    // 隐藏辅助线\n    this.hideGuideline();\n\n    this.options.enabled = false;\n  }\n\n  /**\n   * 绘制\n   */\n  public render() {\n    // if (!this.options.enabled) return;\n    const vpt = this.options.canvas.viewportTransform;\n    if (!vpt) return;\n    // 绘制尺子\n    this.draw({\n      isHorizontal: true,\n      rulerLength: this.getSize().width,\n      // startCalibration: -(vpt[4] / vpt[0]),\n      startCalibration: this.startCalibration?.x ? this.startCalibration.x : -(vpt[4] / vpt[0]),\n    });\n    this.draw({\n      isHorizontal: false,\n      rulerLength: this.getSize().height,\n      // startCalibration: -(vpt[5] / vpt[3]),\n      startCalibration: this.startCalibration?.y ? this.startCalibration.y : -(vpt[5] / vpt[3]),\n    });\n    // 绘制左上角的遮罩\n    drawMask(this.ctx, {\n      isHorizontal: true,\n      left: -10,\n      top: -10,\n      width: this.options.ruleSize * 2 + 10,\n      height: this.options.ruleSize + 10,\n      backgroundColor: this.options.backgroundColor,\n    });\n    drawMask(this.ctx, {\n      isHorizontal: false,\n      left: -10,\n      top: -10,\n      width: this.options.ruleSize + 10,\n      height: this.options.ruleSize * 2 + 10,\n      backgroundColor: this.options.backgroundColor,\n    });\n  }\n\n  /**\n   * 获取画板尺寸\n   */\n  private getSize() {\n    return {\n      width: this.options.canvas.width || 0,\n      height: this.options.canvas.height || 0,\n    };\n  }\n\n  private getZoom() {\n    return this.options.canvas.getZoom();\n  }\n\n  private draw(opt: { isHorizontal: boolean; rulerLength: number; startCalibration: number }) {\n    const { isHorizontal, rulerLength, startCalibration } = opt;\n    const zoom = this.getZoom();\n\n    const gap = getGap(zoom);\n    const unitLength = rulerLength / zoom;\n    const startValue = Math[startCalibration > 0 ? 'floor' : 'ceil'](startCalibration / gap) * gap;\n    const startOffset = startValue - startCalibration;\n\n    // 标尺背景\n    const canvasSize = this.getSize();\n    darwRect(this.ctx, {\n      left: 0,\n      top: 0,\n      width: isHorizontal ? canvasSize.width : this.options.ruleSize,\n      height: isHorizontal ? this.options.ruleSize : canvasSize.height,\n      fill: this.options.backgroundColor,\n      stroke: this.options.borderColor,\n    });\n\n    // 颜色\n    const textColor = new fabric.Color(this.options.textColor);\n    // 标尺文字显示\n    for (let i = 0; i + startOffset <= Math.ceil(unitLength); i += gap) {\n      const position = (startOffset + i) * zoom;\n      const textValue = startValue + i + '';\n      const textLength = (10 * textValue.length) / 4;\n      const textX = isHorizontal\n        ? position - textLength - 1\n        : this.options.ruleSize / 2 - this.options.fontSize / 2 - 4;\n      const textY = isHorizontal\n        ? this.options.ruleSize / 2 - this.options.fontSize / 2 - 4\n        : position + textLength;\n      darwText(this.ctx, {\n        text: textValue,\n        left: textX,\n        top: textY,\n        fill: textColor.toRgb(),\n        angle: isHorizontal ? 0 : -90,\n      });\n    }\n\n    // 标尺刻度线显示\n    for (let j = 0; j + startOffset <= Math.ceil(unitLength); j += gap) {\n      const position = Math.round((startOffset + j) * zoom);\n      const left = isHorizontal ? position : this.options.ruleSize - 8;\n      const top = isHorizontal ? this.options.ruleSize - 8 : position;\n      const width = isHorizontal ? 0 : 8;\n      const height = isHorizontal ? 8 : 0;\n      darwLine(this.ctx, {\n        left,\n        top,\n        width,\n        height,\n        stroke: textColor.toRgb(),\n      });\n    }\n\n    // 标尺蓝色遮罩\n    if (this.objectRect) {\n      const axis = isHorizontal ? 'x' : 'y';\n      this.objectRect[axis].forEach((rect) => {\n        // 跳过指定矩形\n        if (rect.skip === axis) {\n          return;\n        }\n\n        // 获取数字的值\n        const roundFactor = (x: number) => Math.round(x / zoom + startCalibration) + '';\n        const leftTextVal = roundFactor(isHorizontal ? rect.left : rect.top);\n        const rightTextVal = roundFactor(\n          isHorizontal ? rect.left + rect.width : rect.top + rect.height\n        );\n\n        const isSameText = leftTextVal === rightTextVal;\n\n        // 背景遮罩\n        const maskOpt = {\n          isHorizontal,\n          width: isHorizontal ? 160 : this.options.ruleSize - 8,\n          height: isHorizontal ? this.options.ruleSize - 8 : 160,\n          backgroundColor: this.options.backgroundColor,\n        };\n        drawMask(this.ctx, {\n          ...maskOpt,\n          left: isHorizontal ? rect.left - 80 : 0,\n          top: isHorizontal ? 0 : rect.top - 80,\n        });\n        if (!isSameText) {\n          drawMask(this.ctx, {\n            ...maskOpt,\n            left: isHorizontal ? rect.width + rect.left - 80 : 0,\n            top: isHorizontal ? 0 : rect.height + rect.top - 80,\n          });\n        }\n\n        // 颜色\n        const highlightColor = new fabric.Color(this.options.highlightColor);\n\n        // 高亮遮罩\n        highlightColor.setAlpha(0.5);\n        darwRect(this.ctx, {\n          left: isHorizontal ? rect.left : this.options.ruleSize - 8,\n          top: isHorizontal ? this.options.ruleSize - 8 : rect.top,\n          width: isHorizontal ? rect.width : 8,\n          height: isHorizontal ? 8 : rect.height,\n          fill: highlightColor.toRgba(),\n        });\n\n        // 两边的数字\n        const pad = this.options.ruleSize / 2 - this.options.fontSize / 2 - 4;\n\n        const textOpt = {\n          fill: highlightColor.toRgba(),\n          angle: isHorizontal ? 0 : -90,\n        };\n\n        darwText(this.ctx, {\n          ...textOpt,\n          text: leftTextVal,\n          left: isHorizontal ? rect.left - 2 : pad,\n          top: isHorizontal ? pad : rect.top - 2,\n          align: isSameText ? 'center' : isHorizontal ? 'right' : 'left',\n        });\n\n        if (!isSameText) {\n          darwText(this.ctx, {\n            ...textOpt,\n            text: rightTextVal,\n            left: isHorizontal ? rect.left + rect.width + 2 : pad,\n            top: isHorizontal ? pad : rect.top + rect.height + 2,\n            align: isHorizontal ? 'left' : 'right',\n          });\n        }\n\n        // 两边的线\n        const lineSize = isSameText ? 8 : 14;\n\n        highlightColor.setAlpha(1);\n\n        const lineOpt = {\n          width: isHorizontal ? 0 : lineSize,\n          height: isHorizontal ? lineSize : 0,\n          stroke: highlightColor.toRgba(),\n        };\n\n        darwLine(this.ctx, {\n          ...lineOpt,\n          left: isHorizontal ? rect.left : this.options.ruleSize - lineSize,\n          top: isHorizontal ? this.options.ruleSize - lineSize : rect.top,\n        });\n\n        if (!isSameText) {\n          darwLine(this.ctx, {\n            ...lineOpt,\n            left: isHorizontal ? rect.left + rect.width : this.options.ruleSize - lineSize,\n            top: isHorizontal ? this.options.ruleSize - lineSize : rect.top + rect.height,\n          });\n        }\n      });\n    }\n    // draw end\n  }\n\n  /**\n   * 计算起始点\n   */\n  // private calcCalibration() {\n  //   if (this.startCalibration) return;\n  //   // console.log('calcCalibration');\n  //   const workspace = this.options.canvas.getObjects().find((item: any) => {\n  //     return item.id === 'workspace';\n  //   });\n  //   if (!workspace) return;\n  //   const rect = workspace.getBoundingRect(false);\n  //   this.startCalibration = new fabric.Point(-rect.left, -rect.top).divide(this.getZoom());\n  // }\n\n  private calcObjectRect() {\n    const activeObjects = this.options.canvas.getActiveObjects();\n    if (activeObjects.length === 0) return;\n    const allRect = activeObjects.reduce((rects, obj) => {\n      const rect: HighlightRect = obj.getBoundingRect(false, true);\n      // 如果是分组单独计算坐标\n      if (obj.group) {\n        const group = {\n          top: 0,\n          left: 0,\n          width: 0,\n          height: 0,\n          scaleX: 1,\n          scaleY: 1,\n          ...obj.group,\n        };\n        // 计算矩形坐标\n        rect.width *= group.scaleX;\n        rect.height *= group.scaleY;\n        const groupCenterX = group.width / 2 + group.left;\n        const objectOffsetFromCenterX = (group.width / 2 + (obj.left || 0)) * (1 - group.scaleX);\n        rect.left += (groupCenterX - objectOffsetFromCenterX) * this.getZoom();\n        const groupCenterY = group.height / 2 + group.top;\n        const objectOffsetFromCenterY = (group.height / 2 + (obj.top || 0)) * (1 - group.scaleY);\n        rect.top += (groupCenterY - objectOffsetFromCenterY) * this.getZoom();\n      }\n      if (obj instanceof fabric.GuideLine) {\n        rect.skip = obj.isHorizontal() ? 'x' : 'y';\n      }\n      rects.push(rect);\n      return rects;\n    }, [] as HighlightRect[]);\n    if (allRect.length === 0) return;\n    this.objectRect = {\n      x: mergeLines(allRect, true),\n      y: mergeLines(allRect, false),\n    };\n  }\n\n  /**\n   * 清除起始点和矩形坐标\n   */\n  private clearStatus() {\n    // this.startCalibration = undefined;\n    this.objectRect = undefined;\n  }\n\n  /**\n    判断鼠标是否在标尺上\n   * @param point\n   * @returns \"vertical\" | \"horizontal\" | false\n   */\n  public isPointOnRuler(point: Point) {\n    if (\n      new fabric.Rect({\n        left: 0,\n        top: 0,\n        width: this.options.ruleSize,\n        height: this.options.canvas.height,\n      }).containsPoint(point)\n    ) {\n      return 'vertical';\n    } else if (\n      new fabric.Rect({\n        left: 0,\n        top: 0,\n        width: this.options.canvas.width,\n        height: this.options.ruleSize,\n      }).containsPoint(point)\n    ) {\n      return 'horizontal';\n    }\n    return false;\n  }\n\n  private canvasMouseDown(e: IEvent<MouseEvent>) {\n    if (!e.pointer || !e.absolutePointer) return;\n    const hoveredRuler = this.isPointOnRuler(e.pointer);\n    if (hoveredRuler && this.activeOn === 'up') {\n      // 备份属性\n      this.lastAttr.selection = this.options.canvas.selection;\n      this.options.canvas.selection = false;\n      this.activeOn = 'down';\n\n      this.tempGuidelLine = new fabric.GuideLine(\n        hoveredRuler === 'horizontal' ? e.absolutePointer.y : e.absolutePointer.x,\n        {\n          axis: hoveredRuler,\n          visible: false,\n        }\n      );\n\n      this.options.canvas.add(this.tempGuidelLine);\n      this.options.canvas.setActiveObject(this.tempGuidelLine);\n\n      this.options.canvas._setupCurrentTransform(e.e, this.tempGuidelLine, true);\n\n      this.tempGuidelLine.fire('down', this.getCommonEventInfo(e));\n    }\n  }\n\n  private getCommonEventInfo = (e: IEvent<MouseEvent>) => {\n    if (!this.tempGuidelLine || !e.absolutePointer) return;\n    return {\n      e: e.e,\n      transform: this.tempGuidelLine.get('transform'),\n      pointer: {\n        x: e.absolutePointer.x,\n        y: e.absolutePointer.y,\n      },\n      target: this.tempGuidelLine,\n    };\n  };\n\n  private canvasMouseMove(e: IEvent<MouseEvent>) {\n    if (!e.pointer) return;\n\n    if (this.tempGuidelLine && e.absolutePointer) {\n      const pos: Partial<fabric.IGuideLineOptions> = {};\n      if (this.tempGuidelLine.axis === 'horizontal') {\n        pos.top = e.absolutePointer.y;\n      } else {\n        pos.left = e.absolutePointer.x;\n      }\n      this.tempGuidelLine.set({ ...pos, visible: true });\n\n      this.options.canvas.requestRenderAll();\n\n      const event = this.getCommonEventInfo(e);\n      this.options.canvas.fire('object:moving', event);\n      this.tempGuidelLine.fire('moving', event);\n    }\n\n    const hoveredRuler = this.isPointOnRuler(e.pointer);\n    if (!hoveredRuler) {\n      // 鼠标从里面出去\n      if (this.lastAttr.status !== 'out') {\n        // 更改鼠标指针\n        this.options.canvas.defaultCursor = this.lastAttr.cursor;\n        this.lastAttr.status = 'out';\n      }\n      return;\n    }\n    // const activeObjects = this.options.canvas.getActiveObjects();\n    // if (activeObjects.length === 1 && activeObjects[0] instanceof fabric.GuideLine) {\n    //   return;\n    // }\n    // 鼠标从外边进入 或 在另一侧标尺\n    if (this.lastAttr.status === 'out' || hoveredRuler !== this.lastAttr.status) {\n      // 更改鼠标指针\n      this.lastAttr.cursor = this.options.canvas.defaultCursor;\n      this.options.canvas.defaultCursor = hoveredRuler === 'horizontal' ? 'ns-resize' : 'ew-resize';\n      this.lastAttr.status = hoveredRuler;\n    }\n  }\n\n  private canvasMouseUp(e: IEvent<MouseEvent>) {\n    if (this.activeOn !== 'down') return;\n\n    // 还原属性\n    this.options.canvas.selection = this.lastAttr.selection;\n    this.activeOn = 'up';\n\n    this.tempGuidelLine?.fire('up', this.getCommonEventInfo(e));\n\n    this.tempGuidelLine = undefined;\n  }\n}\n\nexport default CanvasRuler;\n","// @ts-nocheck\nimport type { Canvas } from 'fabric/fabric-impl';\nimport { fabric } from 'fabric';\nimport CanvasRuler, { RulerOptions } from './ruler';\n\nfunction initRuler(canvas: Canvas, options?: RulerOptions) {\n  const ruler = new CanvasRuler({\n    canvas,\n    ...options,\n  });\n\n  // 辅助线移动到画板外删除\n  let workspace: fabric.Object | undefined = undefined;\n\n  /**\n   * 获取workspace\n   */\n  const getWorkspace = () => {\n    workspace = canvas.getObjects().find((item) => item.id === 'workspace');\n  };\n\n  /**\n   * 判断target是否在object矩形外\n   * @param object\n   * @param target\n   * @returns\n   */\n  const isRectOut = (object: fabric.Object, target: fabric.GuideLine): boolean => {\n    const { top, height, left, width } = object;\n\n    if (top === undefined || height === undefined || left === undefined || width === undefined) {\n      return false;\n    }\n\n    const targetRect = target.getBoundingRect(true, true);\n    const {\n      top: targetTop,\n      height: targetHeight,\n      left: targetLeft,\n      width: targetWidth,\n    } = targetRect;\n\n    if (\n      target.isHorizontal() &&\n      (top > targetTop + 1 || top + height < targetTop + targetHeight - 1)\n    ) {\n      return true;\n    } else if (\n      !target.isHorizontal() &&\n      (left > targetLeft + 1 || left + width < targetLeft + targetWidth - 1)\n    ) {\n      return true;\n    }\n\n    return false;\n  };\n\n  canvas.on('guideline:moving', (e) => {\n    if (!workspace) {\n      getWorkspace();\n      return;\n    }\n    const { target } = e;\n    if (isRectOut(workspace, target)) {\n      target.moveCursor = 'not-allowed';\n    }\n  });\n\n  canvas.on('guideline:mouseup', (e) => {\n    if (!workspace) {\n      getWorkspace();\n      return;\n    }\n    const { target } = e;\n    if (isRectOut(workspace, target)) {\n      canvas.remove(target);\n      canvas.setCursor(canvas.defaultCursor || '');\n    }\n  });\n  return ruler;\n}\n\nexport default initRuler;\n","// @ts-nocheck\nimport { fabric } from 'fabric';\nimport { uuid } from '../utils/utils';\n\nclass EditorGroupText {\n  canvas: fabric.Canvas;\n  isDown: boolean;\n  constructor(canvas: fabric.Canvas) {\n    this.canvas = canvas;\n    this._init();\n    this.isDown = false;\n  }\n\n  // 组内文本输入\n  _init() {\n    this.canvas.on('mouse:down', (opt) => {\n      this.isDown = true;\n      if (opt.target && opt.target.type === 'group') {\n        const textObject = this._getGroupTextObj(opt) as fabric.IText;\n        if (textObject) {\n          this._bedingEditingEvent(textObject, opt);\n          this.canvas.setActiveObject(textObject);\n          textObject.enterEditing();\n        } else {\n          this.canvas.setActiveObject(opt.target);\n        }\n      }\n    });\n\n    this.canvas.on('mouse:up', () => {\n      this.isDown = false;\n    });\n\n    this.canvas.on('mouse:move', (opt) => {\n      if (this.isDown && opt.target && opt.target.type === 'group') {\n        const textObject = this._getGroupTextObj(opt);\n        if (textObject) {\n          // todo bug 文字编辑结束后，点击组内其他元素可单独拖动\n        }\n      }\n    });\n  }\n\n  // 获取点击区域内的组内文字元素\n  _getGroupTextObj(opt: fabric.IEvent<MouseEvent>) {\n    const pointer = this.canvas.getPointer(opt.e, true);\n    const clickObj = this.canvas._searchPossibleTargets(opt.target?._objects, pointer);\n    if (clickObj && this.isText(clickObj)) {\n      return clickObj;\n    }\n    return false;\n  }\n\n  // 绑定编辑取消事件\n  _bedingEditingEvent(textObject: fabric.IText, opt: fabric.IEvent<MouseEvent>) {\n    if (!opt.target) return;\n    const left = opt.target.left;\n    const top = opt.target.top;\n    const ids = this._unGroup() || [];\n\n    const resetGroup = () => {\n      const groupArr = this.canvas.getObjects().filter((item) => item.id && ids.includes(item.id));\n      // 删除元素\n      groupArr.forEach((item) => this.canvas.remove(item));\n\n      // 生成新组\n      const group = new fabric.Group([...groupArr]);\n      group.set('left', left);\n      group.set('top', top);\n      group.set('id', uuid());\n      textObject.off('editing:exited', resetGroup);\n      this.canvas.add(group);\n      this.canvas.discardActiveObject().renderAll();\n    };\n    // 绑定取消事件\n    textObject.on('editing:exited', resetGroup);\n  }\n\n  // 拆分组合并返回ID\n  _unGroup() {\n    const ids: string[] = [];\n    const activeObj = this.canvas.getActiveObject() as fabric.Group;\n    if (!activeObj) return;\n    activeObj.getObjects().forEach((item) => {\n      const id = uuid();\n      ids.push(id);\n      item.set('id', id);\n    });\n    activeObj.toActiveSelection();\n    return ids;\n  }\n\n  isText(obj: fabric.Object) {\n    return obj.type && ['i-text', 'text', 'textbox'].includes(obj.type);\n  }\n}\n\nexport default EditorGroupText;\n","// @ts-nocheck\nimport EventEmitter from 'events';\nimport { uuid } from '../utils/utils';\n\n// 对齐辅助线\nimport initAligningGuidelines from './initAligningGuidelines';\nimport initControlsRotate from './initControlsRotate';\nimport InitCenterAlign from './initCenterAlign';\nimport initHotkeys from './initHotKeys';\nimport initControls from './initControls';\nimport initRuler from './ruler';\nimport EditorGroupText from './EditorGroupText';\nimport type CanvasRuler from './ruler/ruler';\nimport type EditorWorkspace from './EditorWorkspace';\n\nimport type { fabric } from 'fabric';\n\nclass Editor extends EventEmitter {\n  canvas: fabric.Canvas;\n  editorWorkspace: EditorWorkspace | null;\n  centerAlign: InitCenterAlign;\n  ruler: CanvasRuler;\n  disableGuidelines: () => void\n  enableGuidelines: () => void\n\n  constructor(canvas: fabric.Canvas) {\n    super();\n    this.canvas = canvas;\n    this.editorWorkspace = null;\n    const {disable, enable} = initAligningGuidelines(canvas);\n    this.disableGuidelines = disable\n    this.enableGuidelines = enable\n    initHotkeys(canvas, this);\n    initControls(canvas);\n    initControlsRotate(canvas);\n    new EditorGroupText(canvas);\n    this.centerAlign = new InitCenterAlign(canvas);\n    this.ruler = initRuler(canvas);\n  }\n\n  // 多选对象复制\n  _copyActiveSelection(activeObject: fabric.Object) {\n    // 间距设置\n    const grid = 10;\n    const canvas = this.canvas;\n    activeObject?.clone((cloned: fabric.Object) => {\n      // 再次进行克隆，处理选择多个对象的情况\n      cloned.clone((clonedObj: fabric.ActiveSelection) => {\n        canvas.discardActiveObject();\n        if (clonedObj.left === undefined || clonedObj.top === undefined) return;\n        // 将克隆的画布重新赋值\n        clonedObj.canvas = canvas;\n        // 设置位置信息\n        clonedObj.set({\n          left: clonedObj.left + grid,\n          top: clonedObj.top + grid,\n          evented: true,\n          id: uuid(),\n        });\n        clonedObj.forEachObject((obj: fabric.Object) => {\n          obj.id = uuid();\n          canvas.add(obj);\n        });\n        // 解决不可选择问题\n        clonedObj.setCoords();\n        canvas.setActiveObject(clonedObj);\n        canvas.requestRenderAll();\n      });\n    });\n  }\n\n  // 单个对象复制\n  _copyObject(activeObject: fabric.Object) {\n    // 间距设置\n    const grid = 10;\n    const canvas = this.canvas;\n    activeObject?.clone((cloned: fabric.Object) => {\n      if (cloned.left === undefined || cloned.top === undefined) return;\n      canvas.discardActiveObject();\n      // 设置位置信息\n      cloned.set({\n        left: cloned.left + grid,\n        top: cloned.top + grid,\n        evented: true,\n        id: uuid(),\n      });\n      canvas.add(cloned);\n      canvas.setActiveObject(cloned);\n      canvas.requestRenderAll();\n    });\n  }\n\n  // 复制元素\n  clone(paramsActiveObeject: fabric.ActiveSelection | fabric.Object) {\n    const activeObject = paramsActiveObeject || this.canvas.getActiveObject();\n    if (!activeObject) return;\n    if (activeObject?.type === 'activeSelection') {\n      this._copyActiveSelection(activeObject);\n    } else {\n      this._copyObject(activeObject);\n    }\n  }\n\n  // 拆分组\n  unGroup() {\n    const activeObject = this.canvas.getActiveObject() as fabric.Group;\n    if (!activeObject) return;\n    // 先获取当前选中的对象，然后打散\n    activeObject.toActiveSelection();\n    activeObject.getObjects().forEach((item: fabric.Object) => {\n      item.set('id', uuid());\n    });\n    this.canvas.discardActiveObject().renderAll();\n  }\n\n  group() {\n    // 组合元素\n    const activeObj = this.canvas.getActiveObject() as fabric.ActiveSelection;\n    if (!activeObj) return;\n    const activegroup = activeObj.toGroup();\n    const objectsInGroup = activegroup.getObjects();\n    activegroup.clone((newgroup: fabric.Group) => {\n      newgroup.set('id', uuid());\n      this.canvas.remove(activegroup);\n      objectsInGroup.forEach((object) => {\n        this.canvas.remove(object);\n      });\n      this.canvas.add(newgroup);\n      this.canvas.setActiveObject(newgroup);\n    });\n  }\n\n  getWorkspace() {\n    return this.canvas.getObjects().find((item) => item.id === 'workspace');\n  }\n\n  workspaceSendToBack() {\n    const workspace = this.getWorkspace();\n    workspace && workspace.sendToBack();\n  }\n\n  getJson() {\n    return this.canvas.toJSON(\n      ['id', 'gradientAngle', 'selectable', 'hasControls', 'sourceSrc', 'rawScaleX',\n        'rawScaleY', 'rectDiffLeft', 'rectDiffTop', 'prevWidth', 'prevHeight', 'cloneObject'\n      ]);\n  }\n\n  /**\n   * @description: 拖拽添加到画布\n   * @param {Event} event\n   * @param {Object} item\n   */\n  dragAddItem(event: DragEvent, item: fabric.Object) {\n    const {left, top} = this.canvas.getSelectionElement().getBoundingClientRect();\n    if (event.x < left || event.y < top || item.width === undefined) return;\n\n    const point = {\n      x: event.x - left,\n      y: event.y - top,\n    };\n    const pointerVpt = this.canvas.restorePointerVpt(point);\n    item.left = pointerVpt.x - item.width / 2;\n    item.top = pointerVpt.y;\n    this.canvas.add(item);\n    this.canvas.requestRenderAll();\n  }\n}\n\nexport default Editor;\n","import React, { FC, createContext, useState } from 'react'\nimport { fabric } from 'fabric'\nimport Editor from '../../core';\nimport EditorWorkspace from '../../core/EditorWorkspace';\n\nconst noop = () => {\n}\n\ninterface CanvasContext {\n  canvas: fabric.Canvas | null\n  editor: Editor | null\n  workSpace: EditorWorkspace | null\n  drawMode: string,\n  setDrawMode: (value: string) => void\n  setCanvas: (canvas: fabric.Canvas) => void\n  setEditor: (value: Editor) => void\n  setWorkSpace: (value: EditorWorkspace) => void\n  selectMode: string\n  setSelectMode: (value: string) => void\n  selectIds: Array<string>\n  setSelectIds: (value: Array<string>) => void\n  selectOneType: string\n  setSelectOneType: (value: string) => void\n  selectActive: Array<string>\n  setSelectActive: (value: Array<string>) => void\n  show: boolean\n  setShow: (value: boolean) => void\n  mainUrl: string | undefined\n  setMainUrl: (value: string | undefined) => void\n  isClipImage: boolean\n  setIsClipImage: (value: boolean) => void\n  clipRawIndex: any\n  setClipRawIndex: (value: any) => void\n  clipImageId: any\n  setClipImageId: (value: any) => void\n\n}\n\nexport const Context = createContext<CanvasContext>({\n  editor: null, // canvas编辑器实例\n  canvas: null, // fabric canvas实例\n  workSpace: null, // 白色画布实例\n  drawMode: '', // default 默认模式 move拖拽模式\n  selectMode: '',\n  selectIds: [],\n  selectOneType: '',\n  selectActive: [],\n  show: false,\n  mainUrl: '',\n  isClipImage: false,\n  clipRawIndex: null,\n  clipImageId: null,\n  setClipRawIndex: noop,\n  setClipImageId: noop,\n  setIsClipImage: noop,\n  setMainUrl: noop,\n  setSelectOneType: noop,\n  setSelectActive: noop,\n  setSelectMode: noop,\n  setSelectIds: noop,\n  setDrawMode: noop,\n  setCanvas: noop,\n  setEditor: noop,\n  setWorkSpace: noop,\n  setShow: noop\n})\n\nexport const CanvasProvider: FC = ({children}) => {\n  const [canvas, setCanvas] = useState<fabric.Canvas | null>(null)\n  const [editor, setEditor] = useState<Editor | null>(null)\n  const [workSpace, setWorkSpace] = useState<EditorWorkspace | null>(null)\n  const [drawMode, setDrawMode] = useState<string>('default')\n  const [selectMode, setSelectMode] = useState('')\n  const [selectIds, setSelectIds] = useState([])\n  const [selectOneType, setSelectOneType] = useState('')\n  const [selectActive, setSelectActive] = useState([])\n  const [show, setShow] = useState(false)\n  const [mainUrl, setMainUrl] = useState('')\n  const [isClipImage, setIsClipImage] = useState(false)\n  const [clipImageId, setClipImageId] = useState(null)\n  const [clipRawIndex, setClipRawIndex] = useState(null)\n  const context = {\n    canvas,\n    editor,\n    workSpace,\n    drawMode,\n    selectMode,\n    setSelectMode,\n    selectIds,\n    setSelectIds,\n    selectOneType,\n    setSelectOneType,\n    selectActive,\n    setSelectActive,\n    setDrawMode,\n    setWorkSpace,\n    setCanvas,\n    setEditor,\n    show,\n    setShow,\n    mainUrl,\n    setMainUrl,\n    isClipImage,\n    setIsClipImage,\n    clipImageId,\n    setClipImageId,\n    clipRawIndex,\n    setClipRawIndex\n  }\n\n  // @ts-ignore\n  return <Context.Provider value={context}>{children}</Context.Provider>\n}\n","import React from 'react'\nimport style from './index.module.scss'\n\ninterface InputProps {\n  title: string\n  afterText?: string | React.ReactElement\n  value: string | number\n  onChange: (e: { target: { value: string } }) => void\n}\n\nconst Input: React.FC<InputProps> = (props) => {\n  const {title, afterText, value, onChange} = props;\n  return (\n    <div className={style.customInput}>\n      <div className={style.title}>{title}</div>\n      <div className={style.inputWrap}>\n        <input onChange={onChange} value={value} type=\"text\"/>\n        {afterText ?\n          React.isValidElement(afterText) ?\n            afterText :\n            <span>{afterText}</span> : ''}\n      </div>\n    </div>\n  )\n}\n\nexport default Input\n","import { useContext } from 'react';\nimport { Context } from '../CanvasContext';\n\nconst useAttr = () => {\n  const {canvas} = useContext(Context)\n  /**\n   * 获取已选中的元素\n   */\n  const getActiveObject = () => {\n    if (!canvas) return\n    const activeObject = canvas?.getActiveObject()\n    if (!activeObject) return\n    return activeObject\n  }\n  /**\n   * 设置属性\n   * @param attr\n   */\n  const setAttr = (attr: any) => {\n    if (!canvas) return\n    const activeObject = getActiveObject()\n    if (!activeObject) return\n    activeObject.set(attr)\n    canvas.renderAll()\n  }\n  return {\n    getActiveObject,\n    setAttr\n  }\n}\n\nexport default useAttr\n","import useAttr from './useAttr';\nimport { useCallback, useContext } from 'react';\nimport { Context } from '../CanvasContext';\nimport { fabric } from 'fabric';\n\nconst lockAttrs = [\n  'lockMovementX',\n  'lockMovementY',\n  'lockRotation',\n  'lockScalingX',\n  'lockScalingY',\n];\n\n/**\n * 检测fabric对象是否隐藏了X Y缩放\n * @param object\n */\nexport const isControlsInRatioVisible = (object: fabric.Object) => {\n  const controls = object._controlsVisibility\n  return !!(controls && !controls.mb && !controls.ml && !controls.mr && !controls.mt)\n}\n\nconst useLock = () => {\n  const {canvas} = useContext(Context)\n  const {getActiveObject} = useAttr()\n\n  /**\n   * 锁定全部操作 或 解锁全部操作\n   */\n  const changeOwnLock = useCallback((isLock: boolean, object?: fabric.Object) => {\n    let activeObject: null | undefined | fabric.Object = null\n    if (object) {\n      activeObject = object\n    } else {\n      activeObject = getActiveObject()\n    }\n    if (!activeObject) return\n    activeObject.hasControls = isLock\n    lockAttrs.forEach((key) => {\n      (activeObject as fabric.Object)[key] = !isLock\n    });\n    activeObject.selectable = isLock\n    canvas?.renderAll()\n  }, [canvas, getActiveObject])\n\n  /**\n   * 按比例锁定 或 解锁\n   */\n  const changeInRatioLock = useCallback((isLock: boolean, object?: fabric.Object) => {\n    let activeObject: null | undefined | fabric.Object = null\n    if (object) {\n      activeObject = object\n    } else {\n      activeObject = getActiveObject()\n    }\n    if (!activeObject) return\n    activeObject.setControlsVisibility({\n      mt: isLock, // 控制上中点的缩放控件可见性\n      mb: isLock, // 控制下中点的缩放控件可见性\n      ml: isLock, // 控制左中点的缩放控件可见性\n      mr: isLock, // 控制右中点的缩放控件可见性\n    })\n    canvas?.renderAll()\n  }, [canvas, getActiveObject])\n  return {\n    changeOwnLock,\n    changeInRatioLock\n  }\n}\n\nexport default useLock\n","/**\n * 加减乘除\n * 为了实现常用数字加减乘除的精准运算，下列封装了函数，主要思路是，先将小数点右移，\n * 将算式两边的数变成整数再进行运算，得到运算结果后，再将小数点左移回去。\n */\n\nexport function add(num1: number, num2: number) {\n  const num1Digits = (num1.toString().split('.')[1] || '').length\n  const num2Digits = (num2.toString().split('.')[1] || '').length\n  const baseNum = Math.pow(10, Math.max(num1Digits, num2Digits))\n  return (multiply(num1, baseNum) + multiply(num2, baseNum)) / baseNum\n}\n\nexport function subtract(num1: number, num2: number) {\n  const num1Digits = (num1.toString().split('.')[1] || '').length\n  const num2Digits = (num2.toString().split('.')[1] || '').length\n  const baseNum = Math.pow(10, Math.max(num1Digits, num2Digits))\n  return (multiply(num1, baseNum) - multiply(num2, baseNum)) / baseNum\n}\n\nexport function multiply(num1: number, num2: number) {\n  const num1String = num1.toString()\n  const num2String = num2.toString()\n  const num1Digits = (num1String.split('.')[1] || '').length\n  const num2Digits = (num2String.split('.')[1] || '').length\n  const baseNum = Math.pow(10, num1Digits + num2Digits)\n  return Number(num1String.replace('.', '')) * Number(num2String.replace('.', '')) / baseNum\n}\n\nexport function divide(num1: number, num2: number) {\n  const num1String = num1.toString()\n  const num2String = num2.toString()\n  const num1Digits = (num1String.split('.')[1] || '').length\n  const num2Digits = (num2String.split('.')[1] || '').length\n  const baseNum = Math.pow(10, num1Digits + num2Digits)\n  const n1 = multiply(num1, baseNum)\n  const n2 = multiply(num2, baseNum)\n  return Number(n1) / Number(n2)\n}\n\nexport function floatRound(num: number, len = 0) {\n  const n = divide(Math.round(multiply(num, Math.pow(10, len))), Math.pow(10, len))\n  return n.toFixed(len)\n}\n\n","// @ts-nocheck\nimport React, { useContext, useEffect, useState } from 'react'\nimport style from './index.module.scss'\nimport Input from '../../../../Input'\nimport { retainNumber } from '../../../../../../utils/utils'\nimport { fabric } from 'fabric';\nimport { Context } from '../../../../../Draw'\nimport useLock, { isControlsInRatioVisible } from '../../../../../Draw/hooks/useLock'\nimport { floatRound } from '../../../../../../utils/calculate';\n\n\ninterface SizeProps {\n  getActiveObject?: () => fabric.Object\n  isWorkSpace?: boolean\n  showRation?: boolean\n}\n\nconst Size: React.FC<SizeProps> = ({getActiveObject, showRation, isWorkSpace}) => {\n  const {canvas, workSpace} = useContext(Context)\n  const {changeInRatioLock} = useLock()\n  const [width, setWidth] = useState('')\n  const [height, setHeight] = useState('')\n  const [lockRatio, setLockRatio] = useState(false)\n\n  useEffect(() => {\n    getAttr()\n  }, [canvas, getActiveObject])\n\n  useEffect(() => {\n    if (!canvas) return\n    canvas.on('object:modified', getAttr)\n    return () => {\n      canvas.off('object:modified', getAttr)\n    }\n  }, [canvas])\n\n  const getAttr = () => {\n    const activeObject = getActiveObject()\n    if (!activeObject) return\n    setWidth(floatRound(activeObject.width))\n    setHeight(floatRound(activeObject.height))\n    setLockRatio(isControlsInRatioVisible(activeObject))\n  }\n  /**\n   * 修改宽\n   * @param value\n   */\n  const onWidthChange = (value) => {\n    const activeObject = getActiveObject()\n    if (!activeObject) return\n    value = retainNumber(value)\n    if (isWorkSpace) {\n      workSpace?.setSize(value, height)\n      setWidth(value)\n      return;\n    }\n    activeObject.set({width: +value})\n    canvas?.renderAll()\n    setWidth(value)\n  }\n  /**\n   * 修改高\n   * @param value\n   */\n  const onHeightChange = (value) => {\n    const activeObject = getActiveObject()\n    if (!activeObject) return\n    value = retainNumber(value)\n    if (isWorkSpace) {\n      workSpace?.setSize(width, value)\n      setHeight(value)\n      return;\n    }\n    activeObject.set({height: +value})\n    canvas?.renderAll()\n    setHeight(value)\n  }\n\n  const changeLock = () => {\n    changeInRatioLock(lockRatio)\n    setLockRatio(prevState => !prevState)\n  }\n  return (\n    <div className={style.size}>\n      <Input\n        afterText='像素'\n        title='宽度'\n        value={width}\n        onChange={e => onWidthChange(e.target.value)}\n      />\n      <Input\n        afterText='像素'\n        title='高度'\n        value={height}\n        onChange={e => onHeightChange(e.target.value)}\n      />\n      {\n        showRation ? <div className={style.ratio}>\n          <div className={style.title}>比例</div>\n          <div className={style.content} onClick={changeLock}>\n            <img\n              src={lockRatio ?\n                \"https://ossprod.jrdaimao.com/file/1690955813239228.svg\" :\n                \"https://ossprod.jrdaimao.com/file/1690425288688481.svg\"}\n              alt=\"\"\n            />\n          </div>\n        </div> : <div className={style.ratio}></div>\n      }\n    </div>\n  )\n}\n\nexport default Size\n","import React, { useContext, useEffect, useState } from 'react'\nimport style from './index.module.scss'\nimport Input from '../../../../Input'\nimport useAttr from '../../../../../Draw/hooks/useAttr';\nimport { Context } from '../../../../../Draw';\nimport { retainNumber } from '../../../../../../utils/utils';\nimport { floatRound } from '../../../../../../utils/calculate';\n\nconst Position = () => {\n  const {canvas} = useContext(Context)\n  const {getActiveObject, setAttr} = useAttr()\n  const [rotate, setRotate] = useState<string | number>('0')\n  const [x, setX] = useState<string | number>(0)\n  const [y, setY] = useState<string | number>(0)\n\n  useEffect(() => {\n    getAttr()\n  }, [canvas])\n\n  useEffect(() => {\n    if (!canvas) return\n    canvas.on('object:modified', getAttr)\n    return () => {\n      canvas.off('object:modified', getAttr)\n    }\n  }, [canvas])\n  const getAttr = () => {\n    const activeObject = getActiveObject()\n    if (!activeObject) return\n    setX(floatRound(activeObject.left || 0))\n    setY(floatRound(activeObject.top || 0))\n    setRotate(floatRound(activeObject.angle || 0))\n  }\n  /**\n   * 修改旋转角度\n   * @param value\n   */\n  const onRotateChange = (value: string) => {\n    const activeObject = getActiveObject()\n    if (!activeObject) return\n    activeObject.rotate(+value)\n    canvas?.renderAll()\n    setRotate(value)\n  }\n  /**\n   * 修改X坐标\n   * @param value\n   */\n  const onPositionXChange = (value: string) => {\n    value = retainNumber(value)\n    setAttr({left: +value})\n    setX(value)\n  }\n  /**\n   * 修改Y坐标\n   * @param value\n   */\n  const onPositionYChange = (value: string) => {\n    value = retainNumber(value)\n    setAttr({top: +value})\n    setY(value)\n  }\n  return (\n    <div className={style.position}>\n      <Input\n        afterText='像素'\n        value={x}\n        onChange={e => onPositionXChange(e.target.value)}\n        title='X'\n      />\n      <Input\n        afterText='像素'\n        value={y}\n        onChange={e => onPositionYChange(e.target.value)}\n        title='Y'\n      />\n      <div className={style.rotate}>\n        <div className={style.title}>旋转</div>\n        <div className={style.content}>\n          <input value={rotate} onChange={e => onRotateChange(retainNumber(e.target.value))} type=\"text\"/>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default Position\n","// @ts-nocheck\nimport React, { useContext, useEffect, useState } from 'react'\nimport customInputStyle from '../../../../Input/index.module.scss'\nimport style from './index.module.scss'\nimport useAttr from '../../../../../Draw/hooks/useAttr'\nimport { Context } from '../../../../../Draw'\nimport { retainNumber } from '../../../../../../utils/utils';\nimport { divide, multiply } from '../../../../../../utils/calculate';\n\nconst Transparent = () => {\n  const {canvas} = useContext(Context)\n  const {getActiveObject, setAttr} = useAttr()\n  const [opacity, setOpacity] = useState(0)\n  const [visible, setVisible] = useState(false)\n  useEffect(() => {\n    const activeObject = getActiveObject()\n    if (!activeObject) return\n    setOpacity(multiply(activeObject.opacity, 100))\n    setVisible(activeObject.visible || false)\n  }, [getActiveObject])\n  /**\n   * 透明度修改\n   * @param value\n   */\n  const onOpacityChange = (value: string) => {\n    if (value > 100) {\n      value = 100\n    }\n    value = retainNumber(value)\n    setAttr({opacity: divide(value, 100)})\n    setOpacity(+value)\n  }\n  /**\n   * 翻转\n   * @param value\n   */\n  const onFlipChange = (value: string) => {\n    const activeObject = getActiveObject()\n    if (!activeObject) return\n    // @ts-ignore\n    activeObject.set(`flip${value}`, !activeObject[`flip${value}`]).setCoords();\n    canvas?.renderAll()\n  }\n  /**\n   * 可见性修改\n   */\n  const onVisibleChange = () => {\n    setAttr({visible: !visible})\n    setVisible(prevState => !prevState)\n  }\n  return (\n    <div className={style.transparent}>\n      <div className={customInputStyle.customInput}>\n        <div className={customInputStyle.title}>不透明度</div>\n        <div className={customInputStyle.inputWrap}>\n          <input\n            style={{width: 48}}\n            onChange={e => onOpacityChange(e.target.value)}\n            value={opacity}\n            type=\"text\"\n          />\n          <span>%</span>\n        </div>\n      </div>\n      <div className={style.reverse}>\n        <div className={style.title}>翻转</div>\n        <div className={style.reverseWrap}>\n          <div onClick={() => onFlipChange('X')}>\n            <img src=\"https://ossprod.jrdaimao.com/file/1690428298144872.svg\" alt=\"\"/>\n          </div>\n          <div onClick={() => onFlipChange('Y')}>\n            <img src=\"https://ossprod.jrdaimao.com/file/1690428330458222.svg\" alt=\"\"/>\n          </div>\n        </div>\n      </div>\n      <div className={style.visible}>\n        <div className={style.title}>可见性</div>\n        <div className={style.content} onClick={onVisibleChange}>\n          {\n            visible ?\n              <img src=\"https://ossprod.jrdaimao.com/file/1690428533888278.svg\" alt=\"\"/> :\n              <img src=\"https://ossprod.jrdaimao.com/file/1690883271867109.svg\" alt=\"\"/>\n          }\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default Transparent\n","import { useCallback, useContext } from 'react'\nimport { Context } from '../CanvasContext'\nimport { isUndef } from '../../../utils';\n\ntype Pos = { left?: number, top?: number }\n\nconst usePageAlign = () => {\n  const {canvas, workSpace} = useContext(Context)\n  const setPosition = useCallback((value: Pos, target?: any) => {\n    if (!canvas) return\n    let activeObject: any\n    if (target) {\n      activeObject = target\n    } else {\n      activeObject = canvas.getActiveObject()\n    }\n    if (!activeObject) return console.log('no allow activeObject')\n    const {left, top} = value\n    const pos: Pos = {}\n    if (!isUndef(left)) pos.left = left\n    if (!isUndef(top)) pos.top = top\n    activeObject.set(pos)\n    canvas.renderAll()\n  }, [canvas, workSpace])\n  /**\n   * 左对齐\n   */\n  const left = () => {\n    setPosition({left: 0})\n  }\n  /**\n   * 顶对齐\n   */\n  const top = () => {\n    setPosition({top: 0})\n  }\n  /**\n   * 左右居中对齐\n   */\n  const alignCenter = () => {\n    if (!canvas || !workSpace) return\n    const activeObject = canvas.getActiveObject() as any\n    if (!activeObject) return\n    const width = workSpace?.width || 0\n    setPosition({left: (width - activeObject.width * activeObject.scaleX) / 2})\n  }\n  /**\n   * 上下居中对齐\n   */\n  const middleCenter = () => {\n    if (!canvas || !workSpace) return\n    const activeObject = canvas.getActiveObject() as any\n    if (!activeObject) return\n    const height = workSpace?.height || 0\n    setPosition({top: (height - activeObject.height * activeObject.scaleY) / 2})\n  }\n  /**\n   * 右对齐\n   */\n  const right = () => {\n    if (!canvas || !workSpace) return\n    const activeObject = canvas.getActiveObject() as any\n    if (!activeObject) return\n    const width = workSpace?.width || 0\n    setPosition({left: width - activeObject.width * activeObject.scaleX})\n  }\n  /**\n   * 底对齐\n   */\n  const bottom = () => {\n    if (!canvas || !workSpace) return\n    const activeObject = canvas.getActiveObject() as any\n    if (!activeObject) return\n    const height = workSpace?.height || 0\n    setPosition({top: height - activeObject.height * activeObject.scaleY})\n  }\n  return {\n    left, top, alignCenter, middleCenter, right, bottom\n  }\n}\n\nexport default usePageAlign\n","export interface AlignTypeListItem {\n  icon: string\n  activeIcon: string\n  title: string\n  key: string\n}\n\n\nexport const alignTypeList: Array<AlignTypeListItem> = [\n  {\n    icon: 'https://ossprod.jrdaimao.com/file/1690799178088909.svg',\n    activeIcon: 'https://ossprod.jrdaimao.com/file/1690802921403421.svg',\n    title: '左对齐',\n    key: 'left'\n  },\n  {\n    icon: 'https://ossprod.jrdaimao.com/file/1690429259779371.svg',\n    activeIcon: 'https://ossprod.jrdaimao.com/file/1690799287561375.svg',\n    title: '顶对齐',\n    key: 'top'\n  },\n  {\n    icon: 'https://ossprod.jrdaimao.com/file/1690429281715912.svg',\n    activeIcon: 'https://ossprod.jrdaimao.com/file/1690799296804215.svg',\n    title: '左右居中对齐',\n    key: 'alignCenter'\n  },\n  {\n    icon: 'https://ossprod.jrdaimao.com/file/1690429302732969.svg',\n    activeIcon: 'https://ossprod.jrdaimao.com/file/169079930793443.svg',\n    title: '上下居中对齐',\n    key: 'middleCenter'\n  },\n  {\n    icon: 'https://ossprod.jrdaimao.com/file/1690429331770745.svg',\n    activeIcon: 'https://ossprod.jrdaimao.com/file/1690799316293458.svg',\n    title: '右对齐',\n    key: 'right'\n  },\n  {\n    icon: 'https://ossprod.jrdaimao.com/file/169042936033629.svg',\n    activeIcon: 'https://ossprod.jrdaimao.com/file/1690799325119567.svg',\n    title: '底对齐',\n    key: 'bottom'\n  }\n]\n","import React from 'react'\nimport usePageAlign from '../../../../../Draw/hooks/usePageAlign'\nimport { alignTypeList, AlignTypeListItem } from './config'\nimport style from './index.module.scss'\n\nconst PageAlign = () => {\n  const alignFunc = usePageAlign()\n  const onClick = (item: AlignTypeListItem) => {\n    alignFunc[item.key]?.()\n  }\n  return (\n    <div className={style.pageAlign}>\n      <div className={style.title}>页面对齐</div>\n      <div className={style.shareShapeList}>\n        {\n          alignTypeList.map(item => {\n            return <div\n              onClick={() => onClick(item)}\n              key={item.key}\n              className={style.shareShapeListItem}\n            >\n              <img src={item.icon} alt=\"\"/>\n              <img src={item.activeIcon} alt=\"\"/>\n              <span>{item.title}</span>\n            </div>\n          })\n        }\n      </div>\n    </div>\n  )\n}\n\nexport default PageAlign\n","export interface CoverOrderListItem {\n  icon: string\n  activeIcon: string\n  title: string\n  key: string\n}\n\nexport const coverOrderList: Array<CoverOrderListItem> = [\n  {\n    icon: 'https://ossprod.jrdaimao.com/file/1690802981178203.svg',\n    activeIcon: 'https://ossprod.jrdaimao.com/file/1690430789758861.svg',\n    title: '上移一层',\n    key: 'up'\n  },\n  {\n    icon: 'https://ossprod.jrdaimao.com/file/1690430798470387.svg',\n    activeIcon: 'https://ossprod.jrdaimao.com/file/1690803025753461.svg',\n    title: '移到顶层',\n    key: 'upTop'\n  },\n  {\n    icon: 'https://ossprod.jrdaimao.com/file/1690430807961422.svg',\n    activeIcon: 'https://ossprod.jrdaimao.com/file/1690803032757409.svg',\n    title: '下移一层',\n    key: 'down'\n  },\n  {\n    icon: 'https://ossprod.jrdaimao.com/file/1690430815475268.svg',\n    activeIcon: 'https://ossprod.jrdaimao.com/file/1690803040084442.svg',\n    title: '移到底层',\n    key: 'downTop'\n  }\n]\n","import { useCallback, useContext } from 'react'\nimport { Context } from '../CanvasContext'\nimport { fabric } from 'fabric';\n\n/**\n * 修改层级顺序\n */\nconst userOrder = () => {\n  const {canvas, editor} = useContext(Context)\n\n  const changeOrder = useCallback((funcKey: string, object: fabric.Object) => {\n    if (!canvas) return\n    let activeObject: any\n    if (object) {\n      activeObject = object\n    } else {\n      const actives = canvas.getActiveObjects();\n      if (actives && actives.length === 1) {\n        activeObject = canvas.getActiveObjects()[0];\n      }\n    }\n    if (!activeObject) return\n    activeObject && activeObject[funcKey]?.();\n    canvas.renderAll();\n    editor?.workspaceSendToBack()\n  }, [canvas, editor])\n  // 上\n  const up = useCallback((object: fabric.Object) => {\n    changeOrder('bringForward', object)\n  }, [canvas, editor])\n\n  // 上到顶\n  const upTop = useCallback((object: fabric.Object) => {\n    changeOrder('bringToFront', object)\n  }, [canvas, editor])\n\n  // 下\n  const down = useCallback((object: fabric.Object) => {\n    changeOrder('sendBackwards', object)\n  }, [canvas, editor])\n\n  // 下到底\n  const downTop = useCallback((object: fabric.Object) => {\n    changeOrder('sendToBack', object)\n  }, [canvas, editor])\n  return {\n    up, upTop, down, downTop\n  }\n}\n\nexport default userOrder\n","import React from 'react'\nimport pageAlignStyle from '../PageAlign/index.module.scss'\nimport { coverOrderList, CoverOrderListItem } from './config'\nimport userOrder from '../../../../../Draw/hooks/userOrder'\nimport style from './index.module.scss'\n\nconst CoverOrder = () => {\n  const orderFunc = userOrder()\n  const changeCoverOrder = (item: CoverOrderListItem) => {\n    orderFunc[item.key]?.()\n  }\n  return (\n    <div className={style.coverOrder}>\n      <div className={style.coverOrderTitle}>图层顺序</div>\n      <div className={pageAlignStyle.shareShapeList}>\n        {\n          coverOrderList.map(item => {\n            return <div\n              onClick={() => changeCoverOrder(item)}\n              key={item.key}\n              className={pageAlignStyle.shareShapeListItem}\n            >\n              <img src={item.icon} alt=\"\"/>\n              <img src={item.activeIcon} alt=\"\"/>\n              <span>{item.title}</span>\n            </div>\n          })\n        }\n      </div>\n    </div>\n  )\n}\n\nexport default CoverOrder\n","// @ts-nocheck\nimport React, { useEffect, useState } from 'react';\nimport Size from '../Components/Size'\nimport style from '../WorkSpaceAttr/index.module.scss'\nimport Position from '../Components/Pos'\nimport Transparent from '../Components/Trans'\nimport PageAlign from '../Components/PageAlign'\nimport CoverOrder from '../Components/CoverOrder'\nimport useAttr from '../../../../Draw/hooks/useAttr';\n\n\nconst ImageSpaceAttr = () => {\n  const {getActiveObject} = useAttr()\n  return (\n    <div className={style.workSpaceAttr}>\n      <div className={style.base}>\n        <div>\n          {/* 设置元素的大小、锁定比例 */}\n          <Size\n            getActiveObject={getActiveObject}\n            showRation={true}\n          />\n        </div>\n        <div>\n          {/* 设置元素的位置、旋转角度 */}\n          <Position/>\n        </div>\n        <div>\n          <Transparent/>\n        </div>\n      </div>\n      <div className={style.division}></div>\n      {/* 页面对齐 */}\n      <PageAlign/>\n      <div className={style.division}></div>\n      {/*图层顺序 */}\n      <CoverOrder/>\n    </div>\n  );\n};\n\nexport default ImageSpaceAttr;\n","import React from 'react';\n\nexport const DropdownIndicator = () => {\n  return (\n    <img src=\"https://ossprod.jrdaimao.com/file/1690959702767983.svg\" alt=\"\"/>\n  );\n};\n\nexport const ReactSelectStyles: any = {\n  singleValue: (provided: any) => ({\n    ...provided,\n    color: '#ADADB3',\n    fontWeight: 600,\n  }),\n  menuList: (provided: any) => ({\n    ...provided,\n    background: '#1C1D29',\n  }),\n  option: (provided: any) => ({\n    ...provided,\n    background: '#1C1D29',\n    color: '#ADADB3',\n    height: '32px',\n    lineHeight: '32px',\n    padding: '0px 11px',\n    boxSizing: 'border-box',\n    cursor: 'pointer',\n    '&:hover': {\n      color: '#fff',\n      background: '#2C375E'\n    }\n  }),\n  container: (provided: any) => ({\n    ...provided,\n    width: '100%'\n  }),\n  control: () => ({\n    width: '100%',\n    cursor: 'pointer',\n    paddingRight: 8,\n    boxSizing: 'border-box',\n    flex: 1,\n    height: 28,\n    borderRadius: 4,\n    background: '#232634',\n    color: '#ADADB3',\n    fontSize: 14,\n    fontWeight: 600,\n    display: 'flex'\n  }),\n}\n","// @ts-nocheck\nimport React, { useEffect, useRef, useState } from 'react'\nimport styles from './index.module.scss'\nimport { retainNumber } from '../../../utils/utils';\n\ninterface InputNumberProps {\n  value: string | number\n  onChange: (value: string | number) => void\n}\n\nconst InputNumber: React.FC<InputNumberProps> = ({value, onChange: callback}) => {\n  const [number, setNumber] = useState(value)\n  const last = useRef()\n  last.current = number\n  const inputRef = useRef()\n\n  useEffect(() => {\n    setNumber(value)\n  }, [value])\n\n  useEffect(() => {\n    inputRef.current?.addEventListener('keydown', keyDownChange)\n    return () => {\n      inputRef.current?.removeEventListener('keydown', keyDownChange)\n    }\n  }, [value, callback])\n\n  const keyDownChange = (e) => {\n    if (e.key === 'ArrowUp') {\n      add()\n    } else if (e.key === 'ArrowDown') {\n      sub()\n    }\n  }\n  const onNumberChange = (e: { target: { value: string }, preventDefault: () => {} }) => {\n    const value = retainNumber(e.target.value)\n    setNumber(value)\n    callback(value)\n  }\n  const add = () => {\n    const n = +last.current + 1\n    setNumber(n)\n    callback(n)\n  }\n  const sub = () => {\n    if (last.current <= 12) return\n    const n = +last.current - 1\n    setNumber(n)\n    callback(n)\n  }\n  return (\n    <div className={styles.inputNumber}>\n      <input ref={inputRef} value={number} onChange={onNumberChange}/>\n      <span className={styles.control}>\n        <span onClick={add}>\n          <img src=\"https://ossprod.jrdaimao.com/file/1690962892247333.svg\" alt=\"\"/>\n          <img src=\"https://ossprod.jrdaimao.com/file/1691034645816626.svg\" alt=\"\"/>\n        </span>\n        <span onClick={sub}>\n          <img src=\"https://ossprod.jrdaimao.com/file/1690962924824666.svg\" alt=\"\"/>\n          <img src=\"https://ossprod.jrdaimao.com/file/1691035025689960.svg\" alt=\"\"/>\n        </span>\n      </span>\n    </div>\n  )\n}\n\nexport default InputNumber\n","export interface TextAlignItem {\n  src: string\n  activeSrc: string\n  key: string\n}\n\nexport const textAlignList: Array<TextAlignItem> = [\n  {\n    src: 'https://ossprod.jrdaimao.com/file/1690963862052534.svg',\n    activeSrc: 'https://ossprod.jrdaimao.com/file/1690963932538814.svg',\n    key: 'left'\n  },\n  {\n    src: 'https://ossprod.jrdaimao.com/file/1690963869720196.svg',\n    activeSrc: 'https://ossprod.jrdaimao.com/file/1690963940992258.svg',\n    key: 'center'\n  },\n  {\n    src: 'https://ossprod.jrdaimao.com/file/1690963877465292.svg',\n    activeSrc: 'https://ossprod.jrdaimao.com/file/1690963948610334.svg',\n    key: 'right'\n  },\n  {\n    src: 'https://ossprod.jrdaimao.com/file/1690963884592828.svg',\n    activeSrc: 'https://ossprod.jrdaimao.com/file/1690963958787177.svg',\n    key: 'justify'\n  }\n]\nexport const textStyleList = [\n  {\n    label: '常规',\n    value: 'normal'\n  },\n  {\n    label: '粗体',\n    value: 600\n  },\n  // {\n  //   label: '细体',\n  //   value: 400\n  // }\n]\n","export const getFontManage = () => {\n  return Promise.resolve([\n    {\n      \"id\": 1,\n      \"fontlibName\": \"雨落南泥行楷\",\n      \"key\": \"ylnnxk\",\n      \"fontlibfile\": \"https://osstest.jrdaimao.com/file/1684482933910660.ttf\",\n      \"fontImgUrl\": \"https://osstest.jrdaimao.com/file/1684482969861534.jpg\",\n      \"operator\": \"\",\n      \"createdAt\": \"2023-05-19T07:56:12.000Z\",\n      \"updatedAt\": \"2023-05-19T07:56:12.000Z\"\n    },\n    {\n      \"id\": 2,\n      \"fontlibName\": \"汉仪孙尚香繁体\",\n      \"key\": \"hyssxft\",\n      \"fontlibfile\": \"https://osstest.jrdaimao.com/file/168448426103890.ttf\",\n      \"fontImgUrl\": \"https://osstest.jrdaimao.com/file/1684484313329597.jpg\",\n      \"operator\": \"\",\n      \"createdAt\": \"2023-05-19T08:18:35.000Z\",\n      \"updatedAt\": \"2023-05-19T08:18:35.000Z\"\n    },\n    {\n      \"id\": 3,\n      \"fontlibName\": \"DINBLACK\",\n      \"key\": \"dinblack\",\n      \"fontlibfile\": \"https://osstest.jrdaimao.com/file/1684926716437711.otf\",\n      \"fontImgUrl\": \"https://osstest.jrdaimao.com/file/1684926724428125.jpg\",\n      \"operator\": \"管理员\",\n      \"createdAt\": \"2023-05-24T11:12:15.000Z\",\n      \"updatedAt\": \"2023-05-24T11:12:15.000Z\"\n    },\n    {\n      \"id\": 4,\n      \"fontlibName\": \"Bebas-Regular\",\n      \"key\": \"bebasRegular\",\n      \"fontlibfile\": \"https://osstest.jrdaimao.com/file/1684932496362386.ttf\",\n      \"fontImgUrl\": \"https://osstest.jrdaimao.com/file/1684932519267667.jpg\",\n      \"operator\": \"管理员\",\n      \"createdAt\": \"2023-05-24T12:48:43.000Z\",\n      \"updatedAt\": \"2023-05-24T12:48:43.000Z\"\n    },\n    {\n      \"id\": 6,\n      \"fontlibName\": \"汉仪小松激浪体\",\n      \"key\": \"hyxsjl\",\n      \"fontlibfile\": \"https://osstest.jrdaimao.com/file/1685001304598186.ttf\",\n      \"fontImgUrl\": \"https://osstest.jrdaimao.com/file/1685001311019992.jpg\",\n      \"operator\": \"管理员\",\n      \"createdAt\": \"2023-05-25T07:55:34.000Z\",\n      \"updatedAt\": \"2023-05-30T08:58:25.000Z\"\n    },\n    {\n      \"id\": 13,\n      \"fontlibName\": \"叶子\",\n      \"key\": \"yezi\",\n      \"fontlibfile\": \"https://osstest.jrdaimao.com/file/168543899068477.ttf\",\n      \"fontImgUrl\": \"https://osstest.jrdaimao.com/file/1685438995766786.jpg\",\n      \"operator\": \"管理员\",\n      \"createdAt\": \"2023-05-30T09:30:14.000Z\",\n      \"updatedAt\": \"2023-05-30T09:30:14.000Z\"\n    },\n    {\n      \"id\": 14,\n      \"fontlibName\": \"Aa马克\",\n      \"key\": \"aamk\",\n      \"fontlibfile\": \"https://osstest.jrdaimao.com/file/1685439688863813.ttf\",\n      \"fontImgUrl\": \"https://osstest.jrdaimao.com/file/1685439704617823.jpg\",\n      \"operator\": \"管理员\",\n      \"createdAt\": \"2023-05-30T09:41:46.000Z\",\n      \"updatedAt\": \"2023-05-30T09:41:46.000Z\"\n    },\n    {\n      \"id\": 15,\n      \"fontlibName\": \"Egosta\",\n      \"key\": \"egosta\",\n      \"fontlibfile\": \"https://osstest.jrdaimao.com/file/1685439871684955.ttf\",\n      \"fontImgUrl\": \"https://osstest.jrdaimao.com/file/1685439875954916.jpg\",\n      \"operator\": \"管理员\",\n      \"createdAt\": \"2023-05-30T09:44:45.000Z\",\n      \"updatedAt\": \"2023-05-30T09:44:45.000Z\"\n    },\n    {\n      \"id\": 16,\n      \"fontlibName\": \"汉仪永字七巧板\",\n      \"key\": \"hyyzqqb\",\n      \"fontlibfile\": \"https://osstest.jrdaimao.com/file/1685440650813535.ttf\",\n      \"fontImgUrl\": \"https://osstest.jrdaimao.com/file/1685440825332319.jpg\",\n      \"operator\": \"管理员\",\n      \"createdAt\": \"2023-05-30T10:00:28.000Z\",\n      \"updatedAt\": \"2023-05-30T10:00:28.000Z\"\n    },\n    {\n      \"id\": 17,\n      \"fontlibName\": \"阿里妈妈数黑体\",\n      \"key\": \"alimamasht\",\n      \"fontlibfile\": \"https://osstest.jrdaimao.com/file/1688626758184870.ttf\",\n      \"fontImgUrl\": \"https://osstest.jrdaimao.com/file/1688626774033978.jpg\",\n      \"operator\": \"管理员\",\n      \"createdAt\": \"2023-07-06T06:59:37.000Z\",\n      \"updatedAt\": \"2023-07-06T06:59:37.000Z\"\n    }\n  ])\n}\n","// @ts-nocheck\nimport { useCallback, useContext, useEffect, useRef, useState } from 'react'\nimport { getFontManage } from '../../../api/text'\nimport useAttr from './useAttr'\nimport FontFaceObserver from 'fontfaceobserver'\nimport { Context } from '../../Editor/Context';\n\n\n// 通用字体，不需要加载字体包\nconst GeneralTextList = ['serif']\n// 缓存已经加载过的字体包名称，有重复的引用无需再次架子啊\nconst Font = new Map()\n// 缓存字体列表\nlet globalFontList = null\n\n/**\n * 过滤出非通用字体\n * @param list\n */\nexport const filterToText = (list: any) => {\n  if (!Array.isArray(list)) return []\n  return list.filter((item: any) => item.type === 'i-text' && !GeneralTextList.includes(item.fontFamily))\n}\n\n\nconst useChangeFontFamily = () => {\n  const {setAttr} = useAttr()\n  const {setLoading} = useContext(Context)\n  const [fontList, setFontList] = useState([])\n  const [fontLoaded, setFontLoaded] = useState(false)\n  const useFontListLast = useRef()\n  useFontListLast.current = fontList\n\n\n  useEffect(() => {\n    // 缓存处理下，不用每次加载\n    (async () => {\n      let list = []\n      if (globalFontList) {\n        list = globalFontList\n      } else {\n        const res = await getFontManage()\n        list = res.map(item => {\n          return {\n            value: item.key,\n            label: item.fontlibName,\n            url: item.fontlibfile\n          }\n        })\n      }\n      setFontLoaded(true)\n      globalFontList = list\n      setFontList(list)\n    })()\n  }, [])\n  /**\n   * 字体修改\n   */\n  const runChange = useCallback((item) => {\n    // 已经加载过不需要重新加载 直接设置字体\n    if (Font.has(item.name)) {\n      setAttr({fontFamily: item.name})\n      return\n    }\n    setLoading(true)\n    const styleContent = `\n     @font-face {\n      font-family: ${item.name};\n      src: url('${item.src}');\n     }`\n    const style = document.createElement('style')\n    style.innerHTML = styleContent\n    document.body.appendChild(style)\n    const font = new FontFaceObserver(item.name);\n    return font.load(item.name, 2000000).then(function () {\n      Font.set(item.name, true)\n      setLoading(false)\n      console.log('Font is available');\n      setAttr({fontFamily: item.name})\n    }, function (e) {\n      setLoading(false)\n      document.body.removeChild(style)\n      console.log('Font is not available', e);\n    });\n  }, [setAttr])\n  /**\n   * 加载多个字体\n   */\n  const loadFont = useCallback((objectsData) => {\n    if (!objectsData) return Promise.resolve()\n    // 拿到需要加载字体包的字体\n    const textList = filterToText(objectsData)\n    let style = ''\n    textList.forEach(item => {\n      useFontListLast.current.forEach(r => {\n        if (item.fontFamily === r.value && !Font.has(r.value)) {\n          style += `@font-face {font-family: ${r.value};src: url('${r.url}');}`\n        }\n      })\n    })\n    if (style === '') return Promise.resolve()\n    // 组装一下font-face，放到body中\n    const el = document.createElement('style')\n    el.innerHTML = style\n    document.body.appendChild(el)\n    // 加载多个字体\n    const fontFamiliesAll = textList.map((item) => {\n      return new Promise((resolve, reject) => {\n        const font = new FontFaceObserver(item.fontFamily);\n        font.load(item.fontFamily, 2000000).then(() => {\n          Font.set(item.fontFamily, true)\n          resolve()\n        }).catch(err => {\n          reject()\n          console.log('loadFont', err)\n        })\n      })\n    });\n    return Promise.all(fontFamiliesAll);\n  }, [fontList, fontLoaded])\n\n\n  return {\n    fontList,\n    runChange,\n    loadFont,\n    fontLoaded\n  }\n}\n\nexport default useChangeFontFamily\n","// @ts-nocheck\nimport React, { useEffect, useState } from 'react'\nimport style from './index.module.scss'\nimport Select from 'react-select'\nimport { ReactSelectStyles, DropdownIndicator } from '../../../../Select'\nimport InputNumber from '../../../../InputNumber'\nimport { textAlignList, textStyleList } from './config'\nimport useAttr from '../../../../../Draw/hooks/useAttr'\nimport { SketchPicker } from 'react-color'\nimport useChangeFontFamily from '../../../../../Draw/hooks/useChangeFontFamily'\n\nconst ColorPicker: any = SketchPicker\n\n\nconst TextAttr = () => {\n  const {getActiveObject, setAttr} = useAttr()\n  const {fontList, runChange} = useChangeFontFamily()\n  const [fontSize, setFontSize] = useState('12')\n  const [color, setColor] = useState('#000000')\n  const [visible, setVisible] = useState(false)\n  const [fontWeight, setFontWeight] = useState(false)\n  const [underline, setUnderline] = useState(false)\n  const [incline, setIncline] = useState(false)\n  const [align, setAlign] = useState('')\n  const [fontStyle, setFontStyle] = useState<any>(null)\n  const [fontFamily, setFontFamily] = useState(null)\n\n  useEffect(() => {\n    // 回显一些属性\n    const activeObject = getActiveObject()\n    if (!activeObject) return\n    setFontSize(activeObject.get('fontSize'))\n    setColor(activeObject.get('fill'))\n    setUnderline(activeObject.get('underline'))\n    setAlign(activeObject.get('textAlign'))\n    setIncline(activeObject.get('fontStyle') === 'italic')\n    const fontWeight = activeObject.get('fontWeight')\n    const isWeight = fontWeight === 'bold' || fontWeight > 500\n\n    setFontWeight(isWeight)\n    setFontStyle(isWeight ? textStyleList[1] : textStyleList[0])\n  }, [getActiveObject, fontList])\n\n  useEffect(() => {\n    const activeObject = getActiveObject()\n    if (!activeObject) return\n    const fontFamily = activeObject.get('fontFamily')\n    setFontFamily(fontList.find(item => item.value === fontFamily))\n  }, [getActiveObject, fontList])\n\n  useEffect(() => {\n    const el = document.querySelector('#attr-content')\n    if (!el) return\n    if (visible) {\n      el.style.overflow = 'inherit'\n    } else {\n      el.style.overflow = 'auto'\n    }\n    return () => {\n      el.style.overflow = 'auto'\n    }\n  }, [visible])\n  /**\n   * 修改字体大小\n   * @param e\n   */\n  const onFontSizeChange = e => {\n    setAttr({fontSize: +e})\n    setFontSize(e)\n  }\n\n  /**\n   * 颜色\n   * @param e\n   */\n  const onChangeComplete = e => {\n    setAttr({fill: e.hex})\n    setColor(e.hex)\n  }\n  /**\n   * 加粗\n   */\n  const onWeightChange = () => {\n    if (fontWeight) {\n      setAttr({fontWeight: 'normal'})\n    } else {\n      setAttr({fontWeight: 'bold'})\n    }\n    setFontWeight(prevState => !prevState)\n  }\n\n  /**\n   * 下划线\n   */\n  const onUnderlineChange = () => {\n    setAttr({underline: !underline})\n    setUnderline(prevState => !prevState)\n  }\n\n  /**\n   * 对齐方式\n   * @param item\n   */\n  const onAlignChange = item => {\n    setAttr({textAlign: item.key})\n    setAlign(item.key)\n  }\n\n  /**\n   * 倾斜\n   */\n  const onInclineChange = () => {\n    if (incline) {\n      setAttr({fontStyle: 'normal'})\n    } else {\n      setAttr({fontStyle: 'italic'})\n    }\n    setIncline(prevState => !prevState)\n  }\n  const onFontStyleChange = item => {\n    setFontStyle(item)\n    setAttr({fontWeight: item.value})\n  }\n  /**\n   * 修改字体\n   * @param item\n   */\n  const onChangeFontFamily = item => {\n    runChange({\n      src: item.url,\n      name: item.value\n    })\n  }\n\n  return (\n    <div className={style.textArea}>\n      <div className={style.title}>文字</div>\n      <div className={style.textAreaContent}>\n        <div className={style.fontFamily}>\n          <Select\n            placeholder='请选择字体'\n            onChange={onChangeFontFamily}\n            components={{DropdownIndicator}}\n            className={style.select}\n            styles={ReactSelectStyles}\n            isSearchable={false}\n            options={fontList}\n            value={fontFamily}\n          />\n          <div className={style.size}>\n            <InputNumber\n              value={fontSize}\n              onChange={onFontSizeChange}\n            />\n          </div>\n        </div>\n        <div className={style.color}>\n          <Select\n            isDisabled\n            onChange={onFontStyleChange}\n            value={fontStyle}\n            components={{DropdownIndicator}}\n            className={`${style.select} ${style.disabledSelect}`}\n            styles={ReactSelectStyles}\n            isSearchable={false}\n            options={textStyleList}\n          />\n          <div className={style.colorContent} onClick={() => setVisible(prevState => !prevState)}>\n            <div style={{background: color}}></div>\n            <span>{color}</span>\n          </div>\n        </div>\n        <div className={style.style}>\n          <div className={style.alignGroup}>\n            {\n              textAlignList.map(item => {\n                return <div\n                  className={item.key === align ? style.alignGroupActive : ''}\n                  onClick={() => onAlignChange(item)}\n                  key={item.key}\n                >\n                  <img src={item.src} alt=\"\"/>\n                  <img src={item.activeSrc} alt=\"\"/>\n                </div>\n              })\n            }\n          </div>\n          <div className={style.styleGroup}>\n            <div onClick={onWeightChange}>\n              <div className={fontWeight ? style.styleGroupActive : ''}>\n                <img src=\"https://ossprod.jrdaimao.com/file/1690964441564257.svg\" alt=\"\"/>\n                <img src=\"https://ossprod.jrdaimao.com/file/1690964450733564.svg\" alt=\"\"/>\n              </div>\n            </div>\n            <div onClick={onInclineChange}>\n              <div className={incline ? style.styleGroupActive : ''}>\n                <img src=\"https://ossprod.jrdaimao.com/file/1690971550502930.svg\" alt=\"\"/>\n                <img src=\"https://ossprod.jrdaimao.com/file/1690971566471578.svg\" alt=\"\"/>\n              </div>\n            </div>\n            {/*行间距，字间距，做不完了，下回再说*/}\n            {/*<div style={{cursor: 'not-allowed'}}>*/}\n            {/*  <div>*/}\n            {/*    <img src=\"https://ossprod.jrdaimao.com/file/1690964468758155.svg\" alt=\"\"/>*/}\n            {/*    <img src=\"https://ossprod.jrdaimao.com/file/1690964475042947.svg\" alt=\"\"/>*/}\n            {/*  </div>*/}\n            {/*</div>*/}\n            <div onClick={onUnderlineChange}>\n              <div className={underline ? style.styleGroupActive : ''}>\n                <img src=\"https://ossprod.jrdaimao.com/file/1690964614214969.svg\" alt=\"\"/>\n                <img src=\"https://ossprod.jrdaimao.com/file/1690964622200366.svg\" alt=\"\"/>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      {\n        visible ? <div className={style.fixColorPicker}>\n          <ColorPicker\n            className={style.colorPicker}\n            onChangeComplete={onChangeComplete}\n            color={color}\n          />\n        </div> : null\n      }\n    </div>\n  )\n}\n\nexport default TextAttr\n","// @ts-nocheck\nimport React from 'react';\nimport Size from '../Components/Size'\nimport style from '../WorkSpaceAttr/index.module.scss'\nimport Position from '../Components/Pos'\nimport Transparent from '../Components/Trans'\nimport PageAlign from '../Components/PageAlign'\nimport CoverOrder from '../Components/CoverOrder'\nimport useAttr from '../../../../Draw/hooks/useAttr'\nimport TextAttr from '../Components/Text';\n\nconst TextSpaceAttr = () => {\n  const {getActiveObject} = useAttr()\n  return (\n    <div className={style.workSpaceAttr}>\n      <div className={style.base}>\n        <div>\n          {/* 设置元素的大小、锁定比例 */}\n          <Size getActiveObject={getActiveObject} showRation/>\n        </div>\n        <div>\n          {/* 设置元素的位置、旋转角度 */}\n          <Position/>\n        </div>\n        <div>\n          <Transparent/>\n        </div>\n      </div>\n      <div className={style.division}/>\n      <TextAttr/>\n      <div className={style.division}/>\n      {/* 页面对齐 */}\n      <PageAlign/>\n      <div className={style.division}/>\n      {/*图层顺序 */}\n      <CoverOrder/>\n    </div>\n  );\n};\n\nexport default TextSpaceAttr;\n","import ImageSpaceAttr from '../Components/Attr/ImageSpaceAttr'\nimport TextSpaceAttr from '../Components/Attr/TextSpaceAttr';\n\nexport interface AttrTabListItem {\n  title: string\n  key: string\n  bg: string\n}\n\nexport const attrTabList: Array<AttrTabListItem> = [\n  {\n    title: '属性',\n    key: 'Attr',\n    bg: 'https://ossprod.jrdaimao.com/file/1690510922616482.svg'\n  },\n  {\n    title: '图层',\n    key: 'coverage',\n    bg: 'https://ossprod.jrdaimao.com/file/1690511949701720.svg'\n  }\n]\nexport const attrAreaComponent = {\n  'image': ImageSpaceAttr,\n  'i-text': TextSpaceAttr\n}\nexport const DefaultKey = 'Attr'\n","import React, { createContext, useState } from 'react'\nimport { DefaultKey } from '../AttrArea/config'\n\ninterface EditorContext {\n  attrTab: string\n  setAttrTab: (value: string) => void\n  loading: boolean\n  setLoading: (value: boolean) => void\n  loadingText: string\n  setLoadingText: (value: string) => void\n\n}\n\nconst InitState: EditorContext = {\n  attrTab: DefaultKey,\n  loading: false,\n  loadingText: '',\n  setLoading: () => {\n  },\n  setLoadingText: () => {\n  },\n  setAttrTab: () => {\n  }\n}\n\nexport const Context = createContext<EditorContext>(InitState)\n\nexport const EditorProvider: React.FC = ({children}) => {\n  const [attrTab, setAttrTab] = useState(DefaultKey);\n  const [loading, setLoading] = useState(false)\n  const [loadingText, setLoadingText] = useState('加载中')\n  const value: EditorContext = {\n    attrTab,\n    loading,\n    loadingText,\n    setLoading,\n    setLoadingText,\n    setAttrTab\n  }\n  return <Context.Provider value={value}>\n    {children}\n  </Context.Provider>\n}\n\n","// @ts-nocheck\n/**\n * 预加载图片单张\n * @param src\n */\nimport { uuid } from './utils';\n\nexport const loadImage = (src: string) => {\n  if (!src) return Promise.resolve()\n  return new Promise((resolve, reject) => {\n    const img = new Image\n    img.onload = () => {\n      resolve()\n    }\n    img.onerror = (err) => {\n      reject(err)\n    }\n    img.src = src\n  })\n}\n\n/**\n * 预加载图片多张\n * @param list\n */\nexport const loadImageList = (list: Array<string>) => {\n  return Promise.all(list.map(src => loadImage(src)))\n}\n\n/**\n * base64转file\n * @param {string} urlData base64格式图片\n * @returns\n */\nexport function base64ConvertFile(urlData: string) {\n  const arr = urlData.split(',')\n  // @ts-ignore\n  const type = arr[0].match(/:(.*?);/)[1]\n  const fileExt = type.split('/')[1]\n  const bstr = atob(arr[1])\n  let n = bstr.length\n  const u8arr = new Uint8Array(n)\n  while (n--) {\n    u8arr[n] = bstr.charCodeAt(n);\n  }\n  return new File([u8arr], `${uuid()}.` + fileExt, {\n    type: type\n  });\n}\n","import axios from 'axios';\n\nconst request = axios.create({\n  baseURL: ''\n})\n\n\nrequest.interceptors.response.use((response) => {\n  if (response.data.code === '200') {\n    return response.data.data;\n  } else {\n    throw new Error(response.data.message);\n  }\n}, error => {\n  throw new Error(error);\n})\n\nexport const fetch = {\n  get: (url: string, params: any) => {\n    return request.get(url, {params});\n  },\n  post: (url: string, data: any) => {\n    return request.post(url, data)\n  }\n}\n","import { fetch } from './fetch'\n\nexport const getImageList = (data: any) => {\n  return fetch.get('/api_editimg/liststock', data);\n}\n\n// 上传图片\nexport const postUploadImage = (file: any) => {\n  const form = new FormData();\n  form.append('file', file);\n  return fetch.post('/api_image/upload', form);\n}\n\n// add images\nexport const addImageApi = (data: any) => {\n  return fetch.post('/api_editimg/addstock', data);\n}\n\n// save\nexport const saveHistory = (data: any) => {\n  return fetch.post('/api_editimg/save', data);\n}\n\n// delete\nexport const delstock = (data: any) => {\n  return fetch.get('/api_editimg/delstock', data);\n}\n\nexport const getDetail = (data: any) => {\n  return fetch.get('/api_editimg/detail', data);\n}\n\n","import { useCallback } from 'react';\nimport toast from 'react-hot-toast';\n\nconst useToast = () => {\n  const error = useCallback((text: string) => {\n    toast(text,\n      {\n        duration: 1500,\n        // icon: 'err',\n        style: {\n          borderRadius: '10px',\n          background: '#333',\n          color: '#fff',\n        },\n      }\n    );\n  }, [])\n\n  return {\n    error\n  }\n}\nexport default useToast\n","// @ts-nocheck\nimport { fabric } from 'fabric';\nimport { useCallback, useContext } from 'react';\nimport { Context } from '../CanvasContext';\nimport { Context as EditorContext } from '../../Editor/Context';\nimport { base64ConvertFile } from '../../../utils/tool'\nimport { postUploadImage } from '../../../api/image';\nimport useToast from './useToast';\nimport { uuid } from '../../../utils/utils';\n\nconst useClipImage = () => {\n  const {workSpace, canvas, clipImageId, clipRawIndex, setIsClipImage} = useContext(Context)\n  const {setLoading} = useContext(EditorContext)\n  const toast = useToast()\n  /**\n   * 保存裁剪\n   */\n  const saveClipImage = useCallback(async () => {\n    if (!canvas || !workSpace) return\n    const scale = canvas.getZoom()\n    try {\n      let image = null // 被裁剪的图片\n      let rect = null // 裁剪rect\n      let currentClipImageIndex = null // 当前下标\n      canvas.getObjects().forEach((item, index) => {\n        // 获取到裁剪rect\n        if (item.id === 'currentClipRect') {\n          rect = item\n        }\n        // 获取到被裁剪的图片和被裁剪的图片的index\n        if (item.id === clipImageId) {\n          image = item\n          currentClipImageIndex = index\n        }\n      })\n      if (!image || !rect) return\n      setLoading(true)\n      // 创建一个新的rect并保持和裁剪rect位置一致\n      const newRect = new fabric.Rect({\n        left: rect.left,\n        top: rect.top,\n        width: rect.getScaledWidth(),\n        height: rect.getScaledHeight(),\n        absolutePositioned: true,\n      });\n      // 设置图片clipPath（裁剪功能）\n      image.clipPath = newRect;\n\n      // 生成一个image\n      const cropped = new Image();\n      cropped.crossOrigin = 'anonymous'\n      // 把旧的rect删除\n      canvas.remove(rect);\n      // 恢复画布缩放比例\n      canvas.setViewportTransform([1, 0, 0, 1, 0, 0]);\n      // 裁剪图片，位置是newRect的位置\n      const base64 = canvas.toDataURL({\n        left: newRect.left,\n        top: newRect.top,\n        width: newRect.width,\n        height: newRect.height,\n      });\n      const file = base64ConvertFile(base64)\n      const res = await postUploadImage(file)\n      cropped.src = res.url\n      // cropped.src = base64\n      // 裁剪完成收回复画布缩放比例\n      workSpace?.setZoomAuto(scale)\n      // 等待裁剪的图片加载完成\n      cropped.onload = function () {\n        // 将原图片删除\n        canvas.remove(image)\n        // 创建新的图片\n        const newImage = new fabric.Image(cropped, {crossOrigin: 'anonymous'});\n        // 这个原图的src很重要，重新编辑的时候会用到\n        // 设置新图片的位置和newRect位置保持一致\n        newImage.set({\n          id: image.id,\n          left: newRect.left,\n          top: newRect.top,\n          rawScaleX: image.scaleX,\n          rawScaleY: image.scaleY,\n          sourceSrc: image.sourceSrc,\n          rectDiffLeft: newRect.left - image.left,\n          rectDiffTop: newRect.top - image.top,\n          prevWidth: newRect.getScaledWidth(),\n          prevHeight: newRect.getScaledHeight()\n        })\n        canvas.add(newImage);\n        if (currentClipImageIndex !== clipRawIndex) {\n          // 如果被裁剪的图片层级发生了变化那么需要恢复image之前的层级\n          while (currentClipImageIndex !== clipRawIndex) {\n            newImage.sendBackwards()\n            currentClipImageIndex--\n          }\n        }\n        canvas.renderAll();\n        // 完成裁剪\n        setIsClipImage(false)\n        setLoading(false)\n      };\n    } catch (err) {\n      setLoading(false)\n      workSpace?.setZoomAuto(scale)\n      cancelClipImage()\n      toast.error('裁剪失败，请稍后重试~')\n      console.log(err)\n    }\n  }, [canvas, workSpace, clipImageId, clipRawIndex])\n  /**\n   * 取消裁剪\n   */\n  const cancelClipImage = useCallback(() => {\n    if (!canvas) return\n    let rect = null // 裁剪rect\n    let clipImage = null // 被裁剪的图片\n    let currentClipImageIndex = null // 被裁剪的图片的index\n    canvas.getObjects().forEach((item, index) => {\n      // 获取到裁剪rect\n      if (item.id === 'currentClipRect') {\n        rect = item\n      }\n      // 获取到被裁剪的图片和被裁剪的图片的index\n      if (item.id === clipImageId) {\n        clipImage = item\n        currentClipImageIndex = index\n      }\n    })\n    if (!clipImage) return\n    // 如果点击取消，那么判断有rect就把rect删除\n    if (rect) canvas.remove(rect)\n    canvas.remove(clipImage)\n    const cloneObject = clipImage.get('cloneObject')\n    if (!clipImage) return\n    cloneObject.set({\n      id: uuid(),\n      sourceSrc: clipImage.sourceSrc,\n      rawScaleX: clipImage.scaleX,\n      rawScaleY: clipImage.scaleY,\n      rectDiffLeft: clipImage.rectDiffLeft,\n      rectDiffTop: clipImage.rectDiffTop,\n    })\n    canvas.add(cloneObject)\n    if (cloneObject && currentClipImageIndex !== clipRawIndex) {\n      // 如果被裁剪的图片层级发生了变化那么需要恢复image之前的层级\n      while (currentClipImageIndex !== clipRawIndex) {\n        cloneObject.sendBackwards()\n        currentClipImageIndex--\n      }\n    }\n    // 完成裁剪，恢复状态\n    setIsClipImage(false)\n    canvas.renderAll()\n  }, [canvas, workSpace, clipImageId, clipRawIndex])\n\n  return {\n    saveClipImage,\n    cancelClipImage\n  }\n}\n\nexport default useClipImage\n","// @ts-nocheck\nimport { useCallback, useContext, useEffect } from 'react';\nimport { Context } from '../CanvasContext';\nimport { Context as EditorContext } from '../../Editor/Context'\nimport { fabric } from 'fabric';\nimport { KeyNames } from '../../../utils/hotEventKeys';\nimport { hotkeys } from '../../../core/initHotKeys'\nimport useClipImage from './useClipImage';\nimport { isUndef } from '../../../utils';\nimport { events, Types } from '../../../utils/events';\n\nconst useEvents = () => {\n  const {\n    canvas, editor, workSpace, setSelectMode, setSelectIds, setSelectOneType,\n    clipImageId, setIsClipImage, clipRawIndex,\n    isClipImage\n  } = useContext(Context)\n  const {setLoading} = useContext(EditorContext)\n  const {cancelClipImage} = useClipImage()\n  useEffect(() => {\n    events.on(Types.SHOW_LOADING, setLoading)\n    return () => {\n      events.off(Types.SHOW_LOADING, setLoading)\n    }\n  }, [])\n  useEffect(() => {\n    if (!canvas) return\n    canvas.on({\n      'selection:created': selected,\n      'selection:updated': selected,\n      'selection:cleared': selected,\n      'mouse:wheel': onWheel\n    })\n    return () => {\n      canvas.off({\n        'selection:created': selected,\n        'selection:updated': selected,\n        'selection:cleared': selected,\n        'mouse:wheel': onWheel\n      })\n    }\n  }, [canvas, editor])\n  useEffect(() => {\n    hotkeys(KeyNames.delete, deleteObjects);\n    return () => {\n      hotkeys.unbind(KeyNames.delete, deleteObjects);\n    }\n  }, [canvas, isClipImage, clipImageId])\n  useEffect(() => {\n    hotkeys(KeyNames.zoom, onZoom)\n    return () => {\n      hotkeys.unbind(KeyNames.zoom, onZoom)\n    }\n  }, [canvas, workSpace])\n  // useEffect(() => {\n  //   if (!canvas) return\n  //   canvas.on('selection:updated', selectionUpdated)\n  //   return () => {\n  //     canvas.off('selection:updated', selectionUpdated)\n  //   }\n  // }, [canvas, isClipImage, clipImageId, clipRawIndex])\n  //\n  // const selectionUpdated = useCallback(() => {\n  //   const objects = canvas?.getActiveObjects()\n  //   if (isClipImage) {\n  //     cancelClipImage()\n  //   }\n  // }, [canvas, isClipImage, clipImageId, clipRawIndex])\n  /**\n   * 单选多选事件\n   */\n  const selected = useCallback(() => {\n    if (!canvas) return\n    const actives = canvas\n      .getActiveObjects()\n      .filter((item) => !(item instanceof fabric.GuideLine)); // 过滤掉辅助线\n    if (actives && actives.length === 1) {\n      const activeObject = actives[0]\n      if (activeObject && activeObject.type === 'image') {\n        activeObject.set({\n          prevWidth: activeObject.getScaledWidth(),\n          prevHeight: activeObject.getScaledHeight()\n        })\n        canvas.renderAll()\n      }\n      if (activeObject.type === 'i-text') {\n        activeObject.setControlsVisibility({\n          mt: false,\n          ml: false,\n          mb: false,\n          mr: false,\n        })\n        canvas.renderAll()\n      }\n      setSelectMode('one')\n      setSelectIds([activeObject.id])\n      setSelectOneType(activeObject.type)\n    } else if (actives && actives.length > 1) {\n      setSelectMode('multiple')\n      setSelectIds(actives.map(item => item.id as string))\n    } else {\n      setSelectMode('')\n      setSelectIds([])\n      setSelectOneType('')\n    }\n  }, [canvas, editor])\n  /**\n   * 放大缩小\n   */\n  const onZoom = useCallback((e) => {\n    if (e.code === 'Minus') {\n      workSpace?.small(0.05)\n      e.preventDefault();\n      e.stopPropagation();\n    }\n    if (e.code === 'Equal') {\n      workSpace?.big(0.05)\n      e.preventDefault();\n      e.stopPropagation();\n    }\n  }, [canvas, workSpace])\n  useEffect(() => {\n    if (!canvas) return\n    canvas.on('object:modified', (e) => {\n      const target = e.transform?.target\n      if (!target) return\n      if (target.type !== 'image') return\n      if (isUndef(target.rawScaleX) || isUndef(target.rawScaleY)) return\n      const prevWidth = target.prevWidth\n      const prevHeight = target.prevHeight\n      target.set({\n        rawScaleX: target.getScaledWidth() / prevWidth * target.rawScaleX,\n        rawScaleY: target.getScaledHeight() / prevHeight * target.rawScaleY,\n        prevWidth: target.getScaledWidth(),\n        prevHeight: target.getScaledHeight()\n      })\n      canvas.renderAll()\n\n    })\n  }, [canvas])\n  /**\n   * 鼠标缩放事件\n   */\n  const onWheel = useCallback(({e}) => {\n    const delta = e.deltaY;\n    // 根据滚轮方向调整缩放级别\n    if (delta > 0) {\n      workSpace?.small(0.01)\n    } else {\n      workSpace?.big(0.01)\n    }\n    // 阻止默认滚轮事件\n    e.preventDefault();\n    e.stopPropagation();\n  }, [canvas, workSpace])\n\n  const deleteClipImageAndRect = useCallback(() => {\n    if (!canvas) return\n    let rect = null // 裁剪rect\n    let clipImage = null // 被裁剪的图片\n    canvas.getObjects().forEach((item) => {\n      if (item.id === 'currentClipRect') {\n        rect = item\n      }\n      if (item.id === clipImageId) {\n        clipImage = item\n      }\n    })\n    if (!rect || !clipImage) return\n    canvas.remove(rect)\n    canvas.remove(clipImage)\n    canvas.discardActiveObject()\n    canvas.renderAll()\n    setIsClipImage(false)\n  }, [canvas, clipImageId])\n  /**\n   * 删除\n   */\n  const deleteObjects = useCallback(() => {\n    // 如果正在剪裁图片\n    if (isClipImage) {\n      return\n      // deleteClipImageAndRect()\n    }\n    const activeObject = canvas.getActiveObjects()\n    if (activeObject) {\n      activeObject.map((item) => canvas.remove(item))\n      canvas.discardActiveObject()\n      canvas.renderAll()\n    }\n  }, [canvas, isClipImage, clipImageId])\n}\n\nexport default useEvents\n","// @ts-nocheck\nimport { fabric } from 'fabric';\nimport { throttle, uuid } from '../utils/utils';\nimport { events, Types } from '../utils/events';\nimport { isNumber } from '../utils';\nimport { canvas } from 'file-saver';\nimport { divide, subtract } from '../utils/calculate';\n\nconst DefaultWidth = 1024\nconst DefaultHeight = 1024\n\ndeclare type EditorWorkspaceOption = {\n  src: string | undefined\n  callback?: () => void\n  canvasData: any\n};\ndeclare type ExtCanvas = fabric.Canvas & {\n  isDragging: boolean;\n  lastPosX: number;\n  lastPosY: number;\n};\nexport const DefaultWorkSpaceColor = 'rgba(255,255,255,1)'\n\nclass EditorWorkspace {\n  canvas: fabric.Canvas;\n  workspaceEl: HTMLElement;\n  workspace: fabric.Rect | null;\n  option: EditorWorkspaceOption;\n  dragMode: boolean;\n  fill: string;\n  width: number | undefined\n  height: number | undefined\n  scale: number\n\n  constructor(canvas: fabric.Canvas, option: EditorWorkspaceOption) {\n    this.canvas = canvas;\n    const workspaceEl = document.querySelector('#workspace') as HTMLElement;\n    if (!workspaceEl) {\n      throw new Error('element #workspace is missing, plz check!');\n    }\n    this.workspaceEl = workspaceEl;\n    this.workspace = null;\n    this.option = option;\n    this.dragMode = false;\n    this.fill = DefaultWorkSpaceColor\n    this._initBackground();\n    this._initWorkspace();\n    this._initResizeObserve();\n    this._initDring();\n  }\n\n  // 初始化背景\n  _initBackground() {\n    this.canvas.setWidth(this.workspaceEl.offsetWidth);\n    this.canvas.setHeight(this.workspaceEl.offsetHeight);\n  }\n\n  // 初始化画布\n  _initWorkspace() {\n    const {src, canvasData, callback} = this.option\n    // 如果canvasData有数据的话这里要走反显逻辑\n    if (canvasData && canvasData.objects.length) {\n      const rectOptions = canvasData.objects.find(item => item.type === 'rect')\n      this.width = rectOptions.width\n      this.height = this.height = rectOptions.height\n      this.fill = rectOptions.fill\n      this.canvas.loadFromJSON(canvasData, () => {\n        const workspace = this.canvas.getObjects().find((item) => item.id === 'workspace')\n        workspace.set('selectable', false)\n        workspace.set('hasControls', false)\n        this.setSize(workspace.width as number, workspace.height as number)\n        this.canvas.renderAll()\n        callback()\n      })\n      return;\n    }\n    if (!src) {\n      // 如果没有传入图片url，用默认宽高生成背景\n      this.width = DefaultWidth\n      this.height = DefaultHeight\n      this._initRect()\n      return\n    }\n\n    fabric.Image.fromURL(src, img => {\n      img.set({\n        type: 'image',\n        left: 0.5,\n        top: 0.5,\n        id: 'mainImg'\n      })\n      this.width = img.width || DefaultWidth\n      this.height = img.height || DefaultHeight\n      this._initRect(img)\n    }, {crossOrigin: 'anonymous'})\n  }\n\n  _initRect(img?: fabric.Object) {\n    const workspace = new fabric.Rect({\n      fill: this.fill,\n      width: this.width,\n      height: this.height,\n      id: 'workspace',\n    });\n    workspace.w = this\n    workspace.set('selectable', false);\n    workspace.set('hasControls', false);\n    workspace.hoverCursor = 'default';\n    this.canvas.add(workspace);\n    if (img && img.width && img.height) {\n      // 如果图片加载失败，不添加到画布中\n      this.canvas.add(img)\n    }\n    this.canvas.renderAll();\n    this.workspace = workspace;\n    this.option.callback?.();\n    this.auto();\n  }\n\n  setBgColor(color: string) {\n    this.fill = color;\n    this.workspace?.set({fill: color});\n    this.canvas.renderAll();\n  }\n\n  /**\n   * 设置画布中心到指定对象中心点上\n   * @param {Object} obj 指定的对象\n   */\n  setCenterFromObject(obj: fabric.Rect) {\n    const {canvas} = this;\n    const objCenter = obj.getCenterPoint();\n    const viewportTransform = canvas.viewportTransform;\n    if (canvas.width === undefined || canvas.height === undefined || !viewportTransform) return;\n    viewportTransform[4] = canvas.width / 2 - objCenter.x * viewportTransform[0];\n    viewportTransform[5] = canvas.height / 2 - objCenter.y * viewportTransform[3];\n    canvas.setViewportTransform(viewportTransform);\n    canvas.renderAll();\n  }\n\n  // 初始化监听器\n  _initResizeObserve() {\n    const resizeObserver = new ResizeObserver(\n      throttle(() => {\n        this.auto();\n      }, 50)\n    );\n    resizeObserver.observe(this.workspaceEl);\n  }\n\n  setSize(width: number, height: number) {\n    this._initBackground();\n    this.width = isNumber(width) ? width : +width;\n    this.height = isNumber(height) ? height : +height;\n    // 重新设置workspace\n    this.workspace = this.canvas\n      .getObjects()\n      .find((item) => item.id === 'workspace') as fabric.Rect;\n    this.workspace.set('width', this.width);\n    this.workspace.set('height', this.height);\n    this.auto();\n  }\n\n  setZoomAuto(scale: number, cb?: (left?: number, top?: number) => void) {\n    const {workspaceEl} = this;\n    const width = workspaceEl.offsetWidth;\n    const height = workspaceEl.offsetHeight;\n    this.canvas.setWidth(width);\n    this.canvas.setHeight(height);\n    const center = this.canvas.getCenter();\n    this.canvas.setViewportTransform(fabric.iMatrix.concat());\n    this.canvas.zoomToPoint(new fabric.Point(center.left, center.top), scale);\n    if (!this.workspace) return;\n    this.setCenterFromObject(this.workspace);\n\n    // 超出画布不展示\n    this.workspace.clone((cloned: fabric.Rect) => {\n      this.canvas.clipPath = cloned;\n      this.canvas.requestRenderAll();\n    });\n    if (cb) cb(this.workspace.left, this.workspace.top);\n  }\n\n  getScale() {\n    const viewPortWidth = this.workspaceEl.offsetWidth;\n    const viewPortHeight = this.workspaceEl.offsetHeight;\n    const width = this.width || 0\n    const height = this.height || 0\n    if (!width || !height) return 0\n    // 按照宽度\n    if (viewPortWidth / viewPortHeight < width / height) {\n      return subtract(divide(viewPortWidth, width), 0.08)\n    } // 按照宽度缩放\n    return subtract(divide(viewPortHeight, height), 0.08)\n  }\n\n  // 放大\n  big(value: number) {\n    let zoomRatio = this.canvas.getZoom();\n    zoomRatio += value || 0.05;\n    if (zoomRatio >= 3) {\n      zoomRatio = 3\n    }\n    events.emit(Types.CHANGE_SCALE, zoomRatio)\n    const center = this.canvas.getCenter();\n    this.canvas.zoomToPoint(new fabric.Point(center.left, center.top), zoomRatio);\n  }\n\n  // 缩小\n  small(value: number) {\n    let zoomRatio = this.canvas.getZoom();\n    zoomRatio -= value || 0.05;\n    if (zoomRatio <= 0.1) {\n      zoomRatio = 0.1\n    }\n    events.emit(Types.CHANGE_SCALE, zoomRatio)\n    const center = this.canvas.getCenter();\n    this.canvas.zoomToPoint(\n      new fabric.Point(center.left, center.top),\n      zoomRatio < 0 ? 0.01 : zoomRatio\n    );\n  }\n\n  // 自动缩放\n  auto() {\n    const scale = this.getScale();\n    if (scale) {\n      this.scale = scale\n      events.emit(Types.CHANGE_SCALE, scale)\n      this.setZoomAuto(scale);\n    }\n  }\n\n  // 1:1 放大\n  one() {\n    this.setZoomAuto(0.8 - 0.08);\n    this.canvas.requestRenderAll();\n  }\n\n  // 开始拖拽\n  startDring() {\n    this.dragMode = true;\n    this.canvas.defaultCursor = 'grab';\n  }\n\n  endDring() {\n    this.dragMode = false;\n    this.canvas.defaultCursor = 'default';\n  }\n\n  // 拖拽模式\n  _initDring() {\n    const This = this;\n    this.canvas.on('mouse:down', function (this: ExtCanvas, opt) {\n      const evt = opt.e;\n      if (evt.altKey || This.dragMode) {\n        This.canvas.defaultCursor = 'grabbing';\n        This.canvas.discardActiveObject();\n        This._setDring();\n        this.selection = false;\n        this.isDragging = true;\n        this.lastPosX = evt.clientX;\n        this.lastPosY = evt.clientY;\n        this.requestRenderAll();\n      }\n    });\n\n    this.canvas.on('mouse:move', function (this: ExtCanvas, opt) {\n      if (this.isDragging) {\n        This.canvas.discardActiveObject();\n        This.canvas.defaultCursor = 'grabbing';\n        const {e} = opt;\n        if (!this.viewportTransform) return;\n        const vpt = this.viewportTransform;\n        vpt[4] += e.clientX - this.lastPosX;\n        vpt[5] += e.clientY - this.lastPosY;\n        this.lastPosX = e.clientX;\n        this.lastPosY = e.clientY;\n        this.requestRenderAll();\n      }\n    });\n\n    this.canvas.on('mouse:up', function (this: ExtCanvas) {\n      if (!this.viewportTransform) return;\n      this.setViewportTransform(this.viewportTransform);\n      this.isDragging = false;\n      this.selection = true;\n      this.getObjects().forEach((obj) => {\n        if (obj.id !== 'workspace' && obj.hasControls) {\n          obj.selectable = true;\n        }\n      });\n      this.requestRenderAll();\n      This.canvas.defaultCursor = 'default';\n    });\n\n    this.canvas.on('mouse:wheel', function (this: fabric.Canvas, opt) {\n      const delta = opt.e.deltaY;\n      let zoom = this.getZoom();\n      zoom *= 0.999 ** delta;\n      if (zoom > 20) zoom = 20;\n      if (zoom < 0.01) zoom = 0.01;\n      const center = this.getCenter();\n      this.zoomToPoint(new fabric.Point(center.left, center.top), zoom);\n      opt.e.preventDefault();\n      opt.e.stopPropagation();\n    });\n  }\n\n  _setDring() {\n    this.canvas.selection = false;\n    this.canvas.defaultCursor = 'grab';\n    this.canvas.getObjects().forEach((obj) => {\n      obj.selectable = false;\n    });\n    this.canvas.renderAll();\n    this.canvas.requestRenderAll();\n  }\n}\n\nexport default EditorWorkspace;\n","import { useCallback, useContext, useRef, useState } from 'react';\nimport { Context } from '../CanvasContext';\nimport { saveAs } from 'file-saver';\nimport { uuid } from '../../../utils/utils';\nimport { saveHistory as saveHistoryApi } from '../../../api/image';\nimport useClipImage from './useClipImage';\nimport useToast from './useToast';\n\nconst useSave = () => {\n  const toast = useToast()\n  const {editor, canvas, workSpace, mainUrl, isClipImage, clipImageId, clipRawIndex} = useContext(Context)\n  const {cancelClipImage} = useClipImage()\n  const [saveToImageLoading, setSaveToImageLoading] = useState(false)\n  const useLast = useRef<any>({})\n  useLast.current = {\n    editor,\n    mainUrl,\n  }\n  /**\n   * send beacon\n   */\n  const unloadSendBeacon = useCallback(() => {\n    const {editor, mainUrl} = useLast.current\n    if (!editor || !mainUrl) return\n    const dataJson = editor.getJson()\n    // 把裁剪蒙层过滤出去\n    dataJson.objects = dataJson.objects.filter((item: any) => item.id !== 'currentClipRect')\n    const data = JSON.stringify({\n      data: dataJson ? JSON.stringify(dataJson) : '',\n      imgSrc: mainUrl\n    })\n    const blob = new Blob([data], {type: 'application/json'})\n    const isPush = navigator.sendBeacon('/api_editimg/save', blob)\n    console.log('navigator.sendBeacon event', isPush)\n  }, [editor, mainUrl])\n  /**\n   * 保存历史修改记录\n   */\n  const saveHistory = useCallback(() => {\n    if (!editor || !mainUrl) return\n    const dataJson = editor.getJson()\n    return saveHistoryApi({\n      data: dataJson ? JSON.stringify(dataJson) : '',\n      imgSrc: mainUrl\n    })\n  }, [editor, mainUrl])\n  /**\n   * 保存为json\n   */\n  const saveToJson = useCallback(() => {\n    if (!editor) return\n    saveHistory()\n    const dataUrl = editor.getJson();\n    const fileStr = `data:text/json;charset=utf-8,${encodeURIComponent(\n      JSON.stringify(dataUrl, null, '\\t')\n    )}`;\n    saveAs(fileStr, `${uuid()}.json`)\n  }, [editor])\n\n  /**\n   * 保存为图片\n   */\n  const saveToImage = useCallback(async () => {\n    if (saveToImageLoading) return\n    if (!canvas || !editor) return;\n    // 如果正在编辑图片\n    if (isClipImage) {\n      cancelClipImage()\n    }\n    try {\n      setSaveToImageLoading(true)\n      await saveHistory()\n      const workspace = canvas?.getObjects().find((item) => item.id === 'workspace');\n      editor.ruler.hideGuideline();\n      if (!workspace) return;\n      const {left, top, width, height} = workspace;\n      const option = {\n        format: 'png',\n        quality: 1,\n        left,\n        top,\n        width,\n        height,\n      };\n      const scale = canvas.getZoom()\n      canvas.setViewportTransform([1, 0, 0, 1, 0, 0]);\n      const dataUrl = canvas.toDataURL(option);\n      saveAs(dataUrl, `${uuid()}.png`);\n      workSpace?.setZoomAuto(scale)\n      // 恢复之前的缩放比例\n      editor.ruler.showGuideline();\n      setSaveToImageLoading(false)\n    } catch (err) {\n      console.log('onSaveToImage err', err)\n      workSpace?.auto()\n      toast.error(err.message)\n      setSaveToImageLoading(false)\n    }\n  }, [canvas, editor, workSpace, isClipImage, clipImageId, clipRawIndex])\n\n  return {\n    saveToJson,\n    saveHistory,\n    unloadSendBeacon,\n    saveToImage\n  }\n}\n\nexport default useSave\n","import React, { useEffect, useContext } from 'react'\nimport styles from './styles.module.css'\nimport { fabric } from 'fabric'\nimport Editor from '../../core';\nimport { Context } from './CanvasContext'\nimport { Context as EditorContext } from '../Editor/Context'\nimport useEvents from './hooks/useEvents';\nimport EditorWorkspace from '../../core/EditorWorkspace';\nimport { getDetail } from '../../api/image';\nimport { loadImage } from '../../utils/tool';\nimport useSave from './hooks/useSave';\nimport useChangeFontFamily from './hooks/useChangeFontFamily';\n\n\nconst Draw: React.FC<{ src?: string }> = (props) => {\n  const {setCanvas, setEditor, setWorkSpace, setShow, setMainUrl} = useContext(Context)\n  const {setLoading} = useContext(EditorContext)\n  const {loadFont, fontLoaded} = useChangeFontFamily()\n  const {unloadSendBeacon} = useSave()\n  useEvents()\n\n  useEffect(() => {\n    if (!fontLoaded) return\n    init()\n    setMainUrl(props.src)\n  }, [fontLoaded])\n\n  useEffect(() => {\n    window.addEventListener('beforeunload', () => {\n      unloadSendBeacon()\n    })\n  }, [])\n\n  const init = async () => {\n    // 没有src不去请求，直接生成背景\n    if (!props.src) {\n      return initCanvas()\n    }\n    // 获取接口的历史数据\n    try {\n      const res: any = await getDetail({imgSrc: props.src})\n      initCanvas(JSON.parse(res))\n    } catch (err) {\n      initCanvas()\n    }\n  }\n  /**\n   * 初始化canvas\n   * @param canvasData\n   */\n  const initCanvas = async (canvasData?: any) => {\n    let mainImg = null;\n    if (canvasData && canvasData.objects) {\n      // 先从缓存中获取主图src\n      mainImg = canvasData.objects.find((item: any) => item.id === 'mainImg')?.src\n    } else {\n      // 缓存中取不到就去看props里是否有\n      mainImg = props.src\n    }\n    // 主图和字体包会很大，这里做个loading\n    try {\n      setLoading(true)\n      await loadFont(canvasData?.objects)\n      await loadImage(mainImg)\n      setLoading(false)\n    } catch (err) {\n      console.log(`initCanvas error`, err)\n      setLoading(false)\n    }\n\n    const canvas = new fabric.Canvas('fabric-canvas', {\n      fireRightClick: true, // 启用右键，button的数字为3\n      stopContextMenu: true, // 禁止默认右键菜单\n      controlsAboveOverlay: true, // 超出clipPath后仍然展示控制条\n      preserveObjectStacking: true\n    })\n    const workSpace = new EditorWorkspace(canvas, {\n      src: props.src,\n      callback: () => setShow(true),\n      canvasData,\n    })\n    const editor = new Editor(canvas)\n    setWorkSpace(workSpace)\n    setCanvas(canvas)\n    setEditor(editor)\n  }\n\n  return (\n    <div className={styles.workContent} id='workspace'>\n      <canvas className={styles.canvas} id='fabric-canvas'/>\n    </div>\n  )\n}\n\nexport default Draw\n","import React from 'react'\nimport style from './index.module.scss'\nimport useSave from '../../Draw/hooks/useSave';\n\ninterface ImportFileProps {\n  onBack?: () => void\n}\n\nconst ImportFile: React.FC<ImportFileProps> = (props) => {\n  const {saveHistory, unloadSendBeacon} = useSave()\n  const back = () => {\n    saveHistory()\n    unloadSendBeacon()\n    props.onBack?.()\n  }\n  return (\n    <div className={style.importFile}>\n      {\n        props.onBack ? <span className={style.back} onClick={back}>\n        <img src='https://ossprod.jrdaimao.com/file/1690265070713402.svg' alt=''/>\n        <img src=\"https://ossprod.jrdaimao.com/file/1690358472515604.svg\" alt=\"\"/>\n        <span>返回</span>\n      </span> : null\n      }\n\n      {/*<span className={style.openFile}>*/}\n      {/*  <img src=\"https://ossprod.jrdaimao.com/file/1690423416245892.svg\" alt=\"\"/>*/}\n      {/*  <img src=\"https://ossprod.jrdaimao.com/file/1690423788579835.svg\" alt=\"\"/>*/}\n      {/*  <span>打开文件</span>*/}\n      {/*</span>*/}\n    </div>\n  )\n}\n\nexport default ImportFile\n","import { useMemo, useRef } from 'react';\n\ntype noop = (this: any, ...args: any[]) => any;\n\ntype PickFunction<T extends noop> = (\n  this: ThisParameterType<T>,\n  ...args: Parameters<T>\n) => ReturnType<T>;\n\nfunction useMemoizedFn<T extends noop>(fn: T) {\n  const fnRef = useRef<T>(fn);\n\n  // why not write `fnRef.current = fn`?\n  // https://github.com/alibaba/hooks/issues/728\n  fnRef.current = useMemo(() => fn, [fn]);\n\n  const memoizedFn = useRef<PickFunction<T>>();\n  if (!memoizedFn.current) {\n    memoizedFn.current = function (this, ...args) {\n      return fnRef.current.apply(this, args);\n    };\n  }\n\n  return memoizedFn.current as T;\n}\n\nexport default useMemoizedFn;\n","// @ts-nocheck\nimport { useRef, useState } from 'react';\nimport useMemoizedFn from './useMemoizedFn';\nimport { isNumber } from '../utils';\n\ninterface IData<T> {\n  present?: T;\n  past: T[];\n  future: T[];\n}\n\nconst dumpIndex = <T>(step: number, arr: T[]) => {\n  let index =\n    step > 0\n      ? step - 1 // move forward\n      : arr.length + step; // move backward\n  if (index >= arr.length - 1) {\n    index = arr.length - 1;\n  }\n  if (index < 0) {\n    index = 0;\n  }\n  return index;\n};\n\nconst split = <T>(step: number, targetArr: T[]) => {\n  const index = dumpIndex(step, targetArr);\n  return {\n    _current: targetArr[index],\n    _before: targetArr.slice(0, index),\n    _after: targetArr.slice(index + 1),\n  };\n};\n\nexport default function useHistoryTravel<T>(initialValue?: T, maxLength: number = 0) {\n  const [history, setHistory] = useState<IData<T | undefined>>({\n    present: initialValue,\n    past: [],\n    future: [],\n  });\n\n  const { present, past, future } = history;\n  const initialValueRef = useRef(initialValue);\n\n  const reset = (...params: any[]) => {\n    const _initial = params.length > 0 ? params[0] : initialValueRef.current;\n    initialValueRef.current = _initial;\n\n    setHistory({\n      present: _initial,\n      future: [],\n      past: [],\n    });\n  };\n\n  const updateValue = (val: T) => {\n    const _past = [...past, present];\n    const maxLengthNum = isNumber(maxLength) ? maxLength : Number(maxLength);\n    // maximum number of records exceeded\n    if (maxLengthNum > 0 && _past.length > maxLengthNum) {\n      //delete first\n      _past.splice(0, 1);\n    }\n    setHistory({\n      present: val,\n      future: [],\n      past: _past,\n    });\n  };\n\n  const _forward = (step: number = 1) => {\n    if (future.length === 0) {\n      return;\n    }\n    const { _before, _current, _after } = split(step, future);\n    setHistory({\n      past: [...past, present, ..._before],\n      present: _current,\n      future: _after,\n    });\n  };\n\n  const _backward = (step: number = -1) => {\n    if (past.length === 0) {\n      return;\n    }\n\n    const { _before, _current, _after } = split(step, past);\n    setHistory({\n      past: _before,\n      present: _current,\n      future: [..._after, present, ...future],\n    });\n  };\n\n  const go = (step: number) => {\n    const stepNum = isNumber(step) ? step : Number(step);\n    if (stepNum === 0) {\n      return;\n    }\n    if (stepNum > 0) {\n      return _forward(stepNum);\n    }\n    _backward(stepNum);\n  };\n\n  return {\n    value: present,\n    backLength: past.length,\n    forwardLength: future.length,\n    setValue: useMemoizedFn(updateValue),\n    go: useMemoizedFn(go),\n    back: useMemoizedFn(() => {\n      go(-1);\n    }),\n    forward: useMemoizedFn(() => {\n      go(1);\n    }),\n    reset: useMemoizedFn(reset),\n  };\n}\n","import useHistoryTravel from '../../../hooks/useHistoryTravel';\nimport { useCallback, useContext, useEffect, useRef } from 'react';\nimport { Context } from '../CanvasContext';\n\nconst useHistory = () => {\n  const {canvas, workSpace, editor, clipImageId, isClipImage} = useContext(Context)\n  const {value, setValue, go, reset, backLength, forwardLength} = useHistoryTravel<any>(undefined, 50)\n  const historyFlagRef = useRef(false)\n\n\n  useEffect(() => {\n    canvas?.on({\n      'object:added': save,\n      'object:modified': save,\n      'object:removed': save\n    })\n    return () => {\n      canvas?.off({\n        'object:added': save,\n        'object:modified': save,\n        'object:removed': save\n      })\n    }\n  }, [canvas, editor, setValue, isClipImage, clipImageId])\n  useEffect(() => {\n    if (!workSpace || !editor) return\n    reset(editor.getJson());\n  }, [editor, workSpace])\n  useEffect(() => {\n    if (!canvas) return\n    if (!historyFlagRef.current) return\n    canvas?.clear();\n    canvas?.loadFromJSON(value, () => {\n      historyFlagRef.current = false\n      canvas.renderAll();\n    });\n  }, [value, canvas])\n  /**\n   * 每次操作保存历史记录\n   * @param event\n   */\n  const save = useCallback((event: any) => {\n    // 过滤选择元素事件\n    const isSelect = event.action === undefined && event.e;\n    if (isSelect || !canvas) return\n    if (historyFlagRef.current) return\n    if (event.target && event.target.id === \"currentClipRect\") {\n      // 裁剪图片新增的rect不需要记录\n      return\n    }\n    if (isClipImage && event.target.id === clipImageId || event.target.id === 'clipRawImage'){\n      return\n    }\n    setValue(editor?.getJson())\n  }, [canvas, editor, setValue, isClipImage, clipImageId])\n  /**\n   * 后退\n   */\n  const undo = useCallback(() => {\n    historyFlagRef.current = true\n    go(-1);\n  }, [go])\n  /**\n   * 重做\n   */\n  const redo = useCallback(() => {\n    historyFlagRef.current = true\n    go(1);\n  }, [go]);\n  return {\n    undo,\n    redo,\n    backLength,\n    forwardLength,\n  }\n}\n\nexport default useHistory\n","// @ts-nocheck\nimport React, { useContext, useEffect, useRef, useState } from 'react'\nimport { Context } from '../../Draw'\nimport { events, Types } from '../../../utils/events'\nimport { KeyNames } from '../../../utils/hotEventKeys'\nimport { hotkeys } from '../../../core/initHotKeys'\nimport styles from './styles.module.scss'\nimport { floatRound } from '../../../utils/calculate'\nimport useClipImage from '../../Draw/hooks/useClipImage'\nimport useHistory from '../../Draw/hooks/useHistory';\n\nconst HeaderControl = () => {\n  const {\n    workSpace, drawMode, setDrawMode, canvas, editor, isClipImage,\n    setIsClipImage, setClipImageId, setClipRawIndex, clipImageId, clipRawIndex\n  } = useContext(Context)\n  const {saveClipImage, cancelClipImage} = useClipImage()\n  const {undo, redo, backLength, forwardLength} = useHistory()\n  const [scale, setScale] = useState(0)\n  const drawModeRef = useRef('default')\n  drawModeRef.current = drawMode\n\n  useEffect(() => {\n    hotkeys(KeyNames.enter, saveClipImage)\n    hotkeys(KeyNames.esc, cancelClipImage)\n    return () => {\n      hotkeys.unbind(KeyNames.enter, saveClipImage)\n      hotkeys.unbind(KeyNames.esc, cancelClipImage)\n    }\n  }, [canvas, workSpace, clipImageId, clipRawIndex])\n  useEffect(() => {\n    hotkeys(KeyNames.ctrlz, undo)\n    hotkeys(KeyNames.ctrlshiftz, redo)\n    events.on(Types.CLIP_IMAGE, onClipImage)\n    return () => {\n      hotkeys.unbind(KeyNames.ctrlz, undo)\n      hotkeys.unbind(KeyNames.ctrlshiftz, redo)\n      events.off(Types.CLIP_IMAGE, onClipImage)\n    }\n  }, [])\n  useEffect(() => {\n    if (workSpace?.scale) {\n      setScale(floatRound(workSpace.scale * 100))\n    }\n  }, [workSpace?.scale])\n  useEffect(() => {\n    events.on(Types.CHANGE_SCALE, scale => {\n      setScale(floatRound(scale * 100))\n    })\n    window.addEventListener('keydown', onKeyDown)\n    window.addEventListener('keyup', onKeyUp)\n    return () => {\n      window.removeEventListener('keydown', onKeyDown)\n      window.removeEventListener('keyup', onKeyUp)\n    }\n  }, [workSpace, drawMode])\n\n  /**\n   * 裁剪的回调，存储一些裁剪信息\n   * @param visible\n   * @param rawIndex\n   * @param clipImageId\n   */\n  const onClipImage = ({visible, rawIndex, clipImageId}) => {\n    setIsClipImage(visible)\n    setClipRawIndex(rawIndex)\n    setClipImageId(clipImageId)\n  }\n  /**\n   * 按下空格开启拖拽模式\n   * @param e\n   */\n  const onKeyDown = (e: any) => {\n    if (e.code !== 'Space') return\n    if (drawModeRef.current === 'move') return\n    switchDragMode()\n  }\n  /**\n   * 抬起空格取消拖拽模式\n   * @param e\n   */\n  const onKeyUp = (e: any) => {\n    if (e.code !== 'Space') return\n    switchDefaultMode()\n  }\n  /**\n   * 开启拖拽模式\n   */\n  const switchDragMode = () => {\n    editor?.disableGuidelines?.()\n    workSpace?.startDring()\n    setDrawMode('move')\n  }\n  /**\n   * 恢复默认模式\n   */\n  const switchDefaultMode = () => {\n    editor?.enableGuidelines?.()\n    workSpace?.endDring()\n    setDrawMode('default')\n  }\n  // 是否正在剪裁图片，如果正在裁剪图片应该展示裁剪图片的按钮\n  if (isClipImage) {\n    return <div className={styles.headerControl}>\n      <span className={styles.clipSaveButton} onClick={saveClipImage}>\n        <img src=\"https://ossprod.jrdaimao.com/file/1691980964433863.svg\" alt=\"\"/>\n        <img src=\"https://ossprod.jrdaimao.com/file/1691981310968623.svg\" alt=\"\"/>\n        <span>保存</span>\n      </span>\n      <span className={styles.clipSaveButton} onClick={cancelClipImage}>\n        <img src=\"https://ossprod.jrdaimao.com/file/1691980998460679.svg\" alt=\"\"/>\n        <img src=\"https://ossprod.jrdaimao.com/file/1691981320881591.svg\" alt=\"\"/>\n        <span>取消</span>\n      </span>\n    </div>\n  }\n\n  return (\n    <div className={styles.headerControl}>\n      <div>\n        {/* 撤销 */}\n        <div\n          data-tooltip-content=\"撤销 Ctrl Z\"\n          data-tooltip-place=\"bottom\"\n          onClick={undo}\n          className={`${styles.button} ${backLength ? '' : styles.disabled}`}\n        >\n          <img\n            src={backLength ?\n              \"https://ossprod.jrdaimao.com/file/1690509281581673.svg\" :\n              \"https://ossprod.jrdaimao.com/file/1690789676330313.svg\"}\n            alt=\"\"\n          />\n          <img src=\"https://ossprod.jrdaimao.com/file/1690509933132558.svg\" alt=\"\"/>\n        </div>\n        {/* 重做 */}\n        <div\n          onClick={redo}\n          className={`${styles.button} ${forwardLength ? '' : styles.disabled}`}\n          id='control-tooltip'\n          data-tooltip-content=\"重做 Ctrl Shift Z\"\n          data-tooltip-place=\"bottom\"\n        >\n          <img\n            src={forwardLength ?\n              \"https://ossprod.jrdaimao.com/file/1690509311318726.svg\" :\n              \"https://ossprod.jrdaimao.com/file/1690789758114451.svg\"}\n            alt=\"\"\n          />\n          <img src=\"https://ossprod.jrdaimao.com/file/1690509942889198.svg\" alt=\"\"/>\n        </div>\n      </div>\n      <div className={styles.line}/>\n      <div>\n        {/* 拖拽 */}\n        <div\n          className={`${styles.button} ${drawMode === 'move' ? styles.active : ''}`}\n          onClick={switchDragMode}\n          id='control-tooltip'\n          data-tooltip-content=\"移动视图 Space\"\n          data-tooltip-place=\"bottom\"\n        >\n          <img src=\"https://ossprod.jrdaimao.com/file/1690509577879796.svg\" alt=\"\"/>\n          <img src=\"https://ossprod.jrdaimao.com/file/1690509952709638.svg\" alt=\"\"/>\n        </div>\n        {/* 默认鼠标 */}\n        <div\n          className={`${styles.button} ${drawMode === 'default' ? styles.active : ''}`}\n          onClick={switchDefaultMode}\n          id='control-tooltip'\n          data-tooltip-content=\"选择\"\n          data-tooltip-place=\"bottom\"\n        >\n          <img src=\"https://ossprod.jrdaimao.com/file/1690509620102920.svg\" alt=\"\"/>\n          <img src=\"https://ossprod.jrdaimao.com/file/1690509961015895.svg\" alt=\"\"/>\n        </div>\n      </div>\n      <div className={styles.line}/>\n      <div>\n        {/* 放大 */}\n        <div\n          className={styles.button}\n          onClick={() => workSpace?.big()}\n          id='control-tooltip'\n          data-tooltip-content=\"放大视图 Ctrl +\"\n          data-tooltip-place=\"bottom\"\n        >\n          <img src=\"https://ossprod.jrdaimao.com/file/1690509650392929.svg\" alt=\"\"/>\n          <img src=\"https://ossprod.jrdaimao.com/file/169050996966396.svg\" alt=\"\"/>\n        </div>\n        {/* 缩小 */}\n        <div\n          className={styles.button}\n          onClick={() => workSpace?.small()}\n          id='control-tooltip'\n          data-tooltip-content=\"缩小视图 Ctrl -\"\n          data-tooltip-place=\"bottom\"\n        >\n          <img src=\"https://ossprod.jrdaimao.com/file/1690509673723181.svg\" alt=\"\"/>\n          <img src=\"https://ossprod.jrdaimao.com/file/1690509977928322.svg\" alt=\"\"/>\n        </div>\n        {/* 比例 */}\n        <div style={{visibility: scale ? 'visible' : 'hidden'}} className={styles.ratioText}>{scale}%</div>\n      </div>\n    </div>\n  );\n}\n\n\nexport default HeaderControl\n","// @ts-nocheck\nimport React from 'react'\nimport styles from './index.module.scss'\nimport useSave from '../../Draw/hooks/useSave'\n\nconst SaveButton = () => {\n  const { saveToImage } = useSave()\n  return (\n    <div className={styles.headerRightControl}>\n      {/*<span className={styles.previewButton} onClick={onPreview}>*/}\n      {/*  <img src=\"https://ossprod.jrdaimao.com/file/1690422594923183.svg\" alt=\"\"/>*/}\n      {/*  <img src=\"https://ossprod.jrdaimao.com/file/1690423932285584.svg\" alt=\"\"/>*/}\n      {/*  <span>预览</span>*/}\n      {/*</span>*/}\n      <span className={styles.saveWrap}>\n        <span onClick={saveToImage} className={styles.saveButton}>\n          下&nbsp;载\n        </span>\n        {/*<span className={`${styles.fixButton} ${show ? styles.showButton : ''}`}>*/}\n        {/*<span onClick={onSaveToJson}>保存</span>*/}\n        {/*<span onClick={onSaveToImage}>保存为图片</span>*/}\n        {/*</span>*/}\n      </span>\n    </div>\n  )\n}\n\nexport default SaveButton\n","// @ts-nocheck\nimport React, { useCallback, useContext, useEffect, useRef, useState } from 'react';\nimport { saveAs } from 'file-saver';\nimport { delstock } from '../../../../../api/image';\nimport { Context } from '../../../Context';\n\n\nexport const useDropDown = () => {\n  const clickRef = useRef()\n  const cacheItem = useRef()\n  const [show, setShow] = useState(false)\n  const {setLoading} = useContext(Context)\n  const shareEl = useRef()\n\n\n  useEffect(() => {\n    const el = document.querySelector('#img-file-list')\n    if (!el) return\n    if (show) {\n      el.style.overflow = 'hidden'\n    } else {\n      el.style.overflow = 'auto'\n    }\n  }, [show])\n  useEffect(() => {\n    window.addEventListener('click', removeEl)\n    return () => {\n      removeEl()\n      window.removeEventListener('click', removeEl)\n    }\n  }, [])\n\n  const removeEl = useCallback((e) => {\n    if (e?.target === clickRef.current) return\n    if (shareEl.current) {\n      document.body.removeChild(shareEl.current)\n      shareEl.current = null\n      setShow(false)\n    }\n  }, [])\n  const onClick = async (e) => {\n    // e.stopPropagation()\n    if (!e.target || !cacheItem.current) return\n    const {imgSrc, stockName, _id, callback} = cacheItem.current\n    if (e.target.innerHTML === '下载') {\n      saveAs(imgSrc, `${stockName}${imgSrc.slice(imgSrc.lastIndexOf('.'))}`)\n    }\n    if (e.target.innerHTML === '删除') {\n      try {\n        setLoading(true)\n        await delstock({id: _id})\n        await callback?.()\n        setLoading(false)\n      } catch (err) {\n        setLoading(false)\n      }\n    }\n  }\n  const run = (e: any, item: any) => {\n    setShow(true)\n    cacheItem.current = item\n    if (shareEl.current) {\n      document.body.removeChild(shareEl.current)\n      shareEl.current = null\n    }\n    clickRef.current = e.target;\n    const parentNode = e.target.parentNode\n    const {top, left} = parentNode.getBoundingClientRect()\n    const div = shareEl.current = document.createElement('div')\n    div.addEventListener('click', onClick)\n    div.innerHTML = `<div class='customMenu' style='left:${left + parentNode.offsetWidth + 10}px;top:${top}px'>\n<!--    <div class='editName'>-->\n<!--      <span>某某文件名...名称.png</span>-->\n<!--      <img src=\"https://ossprod.jrdaimao.com/file/1690528866207938.svg\" alt=\"\"/>-->\n<!--    </div>-->\n    <div class='buttons'>\n      <div>下载</div>\n      <div>删除</div>\n    </div>\n  </div>`\n    document.body.appendChild(div)\n  }\n  return {\n    run\n  }\n}\n","// @ts-nocheck\nimport { useCallback, useContext } from 'react';\nimport { Context } from '../CanvasContext';\nimport { Context as EditorContext } from '../../Editor/Context'\nimport { fabric } from 'fabric';\nimport { uuid } from '../../../utils/utils';\nimport useClipImage from './useClipImage';\n\n// 默认参数\nconst DefaultOptions = {\n  text: {\n    fill: '#000000'\n  },\n  image: {},\n}\n\nconst useAddObject = () => {\n  const {workSpace, canvas, isClipImage, clipImageId, clipRawIndex} = useContext(Context)\n  const {cancelClipImage} = useClipImage()\n  const {setLoading} = useContext(EditorContext)\n  /**\n   * 新增图片\n   * @param item\n   */\n  const addImage = useCallback((src, options, callback) => {\n    if (!workSpace) return\n    setLoading(true)\n    if (isClipImage) cancelClipImage()\n    const scale = workSpace.getScale()\n    fabric.Image.fromURL(`${src}?t=${Date.now()}`, img => {\n      if (!img.width || !img.height) {\n        setLoading(false)\n        return\n      }\n      img.set({\n        ...DefaultOptions.image,\n        id: uuid(),\n        scaleY: scale,\n        scaleX: scale,\n        left: (workSpace.width - img.width * scale) / 2,\n        top: (workSpace.height - img.height * scale) / 2,\n        ...options,\n      })\n      canvas?.add(img)\n      canvas?.setActiveObject(img);\n      callback?.(img)\n      canvas?.renderAll();\n      setLoading(false)\n    }, {crossOrigin: 'anonymous'})\n  }, [workSpace, canvas, clipImageId, clipRawIndex])\n\n  /**\n   * 新增文字\n   */\n  const addText = useCallback((item) => {\n    if (!workSpace) return\n    if (isClipImage) cancelClipImage()\n    const text = new fabric.IText(item.title, {\n      fontFamily: 'serif',\n      fontSize: item.style.fontSize as number * 3,\n      fontWeight: item.style.fontWeight as number,\n      id: uuid(),\n      lockScalingX: false,\n      lockScalingY: false,\n      ...DefaultOptions.text,\n    })\n    text.set({\n      left: (workSpace.width - text.width) / 2,\n      top: (workSpace.height - text.height) / 2,\n    })\n    canvas?.add(text)\n    canvas?.setActiveObject(text)\n    canvas?.renderAll();\n  }, [workSpace, canvas, clipImageId, clipRawIndex])\n  return {\n    addImage,\n    addText,\n  }\n}\nexport default useAddObject\n","// @ts-nocheck\nimport React, { useContext, useEffect, useRef, useState } from 'react'\nimport styles from './index.module.scss'\nimport { useDropDown } from './dropDown';\nimport useAddObject from '../../../../Draw/hooks/useAddObject';\nimport { addImageApi, getImageList, postUploadImage } from '../../../../../api/image';\nimport { Context } from '../../../../Draw';\nimport { Context as EditorContext } from '../../../Context'\nimport useToast from '../../../../Draw/hooks/useToast';\n\nconst ImageResource = () => {\n  const {setLoading} = useContext(EditorContext)\n  const toast = useToast()\n  const {canvas} = useContext(Context)\n  const EDIT_IMAGE_LIST = sessionStorage.getItem('EDIT_IMAGE_LIST')\n  const [uploading, setUploading] = useState(false)\n  const {addImage} = useAddObject()\n\n  const [list, setList] = useState(EDIT_IMAGE_LIST ?\n    JSON.parse(EDIT_IMAGE_LIST) :\n    [])\n  const {run} = useDropDown()\n\n\n  useEffect(() => {\n    queryList()\n  }, [])\n\n  useEffect(() => {\n    if (!canvas) return\n    canvas.on('drop', onDrop)\n    canvas.on('dragover', onDragover)\n    return () => {\n      canvas.off('drop', onDrop)\n      canvas.off('dragover', onDragover)\n    }\n  }, [canvas])\n\n  // 添加画布的拖拽事件监听器\n  const onDrop = ({e}) => {\n    e.preventDefault()\n    const imageUrl = e.dataTransfer.getData('text/plain');\n    // 画布元素距离浏览器左侧和顶部的距离\n    let offset = {\n      left: canvas.getSelectionElement().getBoundingClientRect().left,\n      top: canvas.getSelectionElement().getBoundingClientRect().top\n    }\n    // 鼠标坐标转换成画布的坐标（未经过缩放和平移的坐标）\n    let point = {\n      x: e.x - offset.left,\n      y: e.y - offset.top,\n    }\n    // 转换后的坐标，restorePointerVpt 不受视窗变换的影响\n    let pointerVpt = canvas.restorePointerVpt(point)\n    addImage(imageUrl, {}, img => {\n      img.set({\n        left: pointerVpt.x - img.getScaledWidth() / 2,\n        top: pointerVpt.y - img.getScaledHeight() / 2,\n      })\n    })\n  }\n  // 阻止画布的默认拖拽行为\n  const onDragover = ({e}) => {\n    e.preventDefault()\n  }\n  const onClickMore = (e: any, item: any) => {\n    run(e, {...item, callback: queryList})\n  }\n  /**\n   * 获取图片数据\n   */\n  const queryList = async () => {\n    try {\n      const res = await getImageList()\n      if (res) {\n        sessionStorage.setItem('EDIT_IMAGE_LIST', JSON.stringify(res))\n      }\n      setList(res)\n    } catch (err) {\n      console.log(err)\n    }\n  }\n  /**\n   * 上传文件\n   * @param e\n   */\n  const onUploadFile = async (e: any) => {\n    if (uploading) return\n    const fileList = e.target.files\n    try {\n      setUploading(true)\n      setLoading(true)\n      for (let i = 0; i < fileList.length; i++) {\n        const file = fileList[i]\n        if (!/(png|jpg|jpeg)/g.test(file.type)) continue\n        const res = await postUploadImage(file)\n        await addImageApi({\n          imgSrc: res.url,\n          stockName: file.name\n        })\n      }\n      await queryList()\n    } catch (err) {\n      console.log(err)\n      toast.error(err.message)\n    } finally {\n      setUploading(false)\n      setLoading(false)\n      // e.target.value = ''\n    }\n  }\n\n  const onDragStart = e => {\n    e.dataTransfer.setData('text/plain', e.target.src);\n  }\n  return (\n    <div className={styles.imageResource}>\n      {/*<div className={styles.searchBox}>*/}\n      {/*  <input type='text' placeholder='请输入' onChange={e => searchRef.current = e.target.value}/>*/}\n      {/*  <img src=\"https://ossprod.jrdaimao.com/file/1690356901972689.svg\" alt=\"\"/>*/}\n      {/*</div>*/}\n      <div className={styles.uploadFile}>\n        <span>{uploading ? '上传中...' : '上传文件'}</span>\n        <input multiple disabled={uploading} type=\"file\" accept='.png,.jpg,.jpeg' onChange={onUploadFile}/>\n      </div>\n      {\n        !list?.length ? <div className={styles.empty}>\n          <img src=\"https://ossprod.jrdaimao.com/file/169035729200810.png\" alt=\"\"/>\n          <p>还没有文件哦~</p>\n        </div> : null\n      }\n      {\n        list?.length ? <div className={styles.fileList} id='img-file-list'>\n          {\n            list.map((item) => {\n              return <div\n                key={item._id}\n                className={styles.fileListItem}\n              >\n                <img\n                  onDragStart={onDragStart}\n                  onClick={() => addImage(item.imgSrc)}\n                  className={styles.image}\n                  src={item.imgSrc}\n                  alt=\"\"\n                />\n                <img\n                  onClick={(e) => onClickMore(e, item)}\n                  className={styles.more}\n                  src=\"https://ossprod.jrdaimao.com/file/1690363754666532.svg\"\n                  alt=\"\"\n                />\n              </div>\n            })\n          }\n        </div> : null\n      }\n    </div>\n  )\n}\n\nexport default ImageResource\n","import { CSSProperties } from 'react';\n\nexport type TextListItem = {\n  title: string\n  key: string\n  style: CSSProperties\n}\n\nexport const textList:Array<TextListItem> = [\n  {\n    title: '添加标题',\n    key: 'addTitle',\n    style: {\n      fontSize: 20,\n      fontWeight: 600\n    }\n  },\n  {\n    title: '添加副标题',\n    key: 'addSubTitle',\n    style: {\n      fontSize: 16,\n      fontWeight: 600\n    }\n  },\n  {\n    title: '添加正文',\n    key: 'addText',\n    style: {\n      fontSize: 14\n    }\n  },\n  {\n    title: '添加注释',\n    key: 'addAnnotation',\n    style: {\n      fontSize: 12\n    }\n  }\n]\n","// @ts-nocheck\nimport React from 'react'\nimport { textList } from './config'\nimport styles from './index.module.scss'\nimport useAddObject from '../../../../Draw/hooks/useAddObject';\n\n\nconst TextResource = () => {\n  const {addText} = useAddObject()\n  return (\n    <div className={styles.textResource}>\n      <div className={styles.addShareTextButton}>\n        <span onClick={() => addText({...textList[3], title: '文本框'})}>添加文本框</span>\n      </div>\n      <div className={styles.textList}>\n        {\n          textList.map(item => {\n            return <div\n              onClick={() => addText(item)}\n              key={item.key}\n              style={item.style}\n              className={styles.textListItem}\n            >\n              <span>{item.title}</span>\n            </div>\n          })\n        }\n      </div>\n    </div>\n  )\n}\n\nexport default TextResource\n","import ImageResource from '../Components/Resource/ImageResource'\nimport TextResource from '../Components/Resource/TextResource';\n\nexport type ResourceNavItem = {\n  title: string\n  icon: string\n  activeIcon: string\n  key: string\n}\n\nexport const ResourceTypeEnum = {\n  ALREADY_UPLOAD: 'alreadyUpload',\n  TEXT: 'i-text'\n}\n\nexport const resourceNavList = [\n  {\n    title: '已上传',\n    icon: 'https://ossprod.jrdaimao.com/file/1690351687096238.svg',\n    activeIcon: 'https://ossprod.jrdaimao.com/file/1690351735822596.svg',\n    key: ResourceTypeEnum.ALREADY_UPLOAD\n  },\n  {\n    title: '文 字',\n    icon: 'https://ossprod.jrdaimao.com/file/1690351715036668.svg',\n    activeIcon: 'https://ossprod.jrdaimao.com/file/1690351759741179.svg',\n    key: ResourceTypeEnum.TEXT\n  }\n]\n\nexport const ResourceContentComEnum = {\n  [ResourceTypeEnum.ALREADY_UPLOAD]: ImageResource,\n  [ResourceTypeEnum.TEXT]: TextResource\n}\nexport const DefaultSelectKey = ResourceTypeEnum.ALREADY_UPLOAD\n","// @ts-nocheck\nimport React, { useState } from 'react'\nimport { ResourceContentComEnum, DefaultSelectKey, ResourceNavItem, resourceNavList } from './config'\nimport styles from './index.module.scss'\n\n\nconst ResourceArea = () => {\n  const [collapsed, setCollapsed] = useState(false);\n  const [activeKey, setActiveKey] = useState(DefaultSelectKey)\n  const onResourceNavChange = (item: ResourceNavItem) => {\n    setActiveKey(item.key)\n  }\n  const activeIndex = resourceNavList.findIndex(item => item.key === activeKey)\n  const ResourceComponent = ResourceContentComEnum[activeKey]\n  const onSetCollapsed = () => {\n    if (!collapsed) {\n      document.body.style.setProperty('--dm-change-resource-content-width', '0')\n      setCollapsed(true)\n    } else {\n      document.body.style.setProperty('--dm-change-resource-content-width', '240px')\n      setCollapsed(false)\n    }\n  }\n  return (\n    <div className={styles.resourceArea}>\n      <div className={styles.resourceNav}>\n        {\n          resourceNavList.map((item, index) => {\n            const active = activeIndex === index\n            let className = `${styles.resourceNavItem} ${active ? styles.resourceNavItemActive : ''}`\n            // 获取一下高亮的前一个元素加下border-radius\n            if (index === activeIndex - 1) {\n              className += styles.resourceNavItemPrevActive\n            }\n            return <div\n              onClick={() => onResourceNavChange(item)}\n              className={className}\n              key={item.key}\n            >\n              <img src={active ? item.activeIcon : item.icon} alt=\"\"/>\n              <span>{item.title}</span>\n            </div>\n          })\n        }\n        <div className={styles.resourceNavPlace}/>\n      </div>\n      <div className={styles.resourceContent}>\n        <ResourceComponent/>\n        <div className={styles.packUp} onClick={onSetCollapsed}>\n          <img\n            src={collapsed ?\n              'https://ossprod.jrdaimao.com/file/1690513793832702.svg' :\n              'https://ossprod.jrdaimao.com/file/1690445829374723.svg'\n            }\n            alt=\"\"\n          />\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default ResourceArea\n","// @ts-nocheck\nimport React, { useCallback, useContext, useEffect, useState } from 'react'\nimport { sortableContainer, sortableElement, arrayMove } from 'react-sortable-hoc'\nimport { fabric } from 'fabric'\nimport style from './index.module.scss'\nimport { Context } from '../../Draw'\nimport userOrder from '../../Draw/hooks/userOrder';\nimport useLock from '../../Draw/hooks/useLock';\n\nconst SortableItem = sortableElement((props: { item }) => {\n  const {changeOwnLock} = useLock()\n  const {item} = props\n  const {selectIds, canvas} = useContext(Context)\n  const isLock = item.object.hasControls\n  const isVisible = item.object.visible\n  /**\n   * 设置高亮\n   */\n  const clickItem = useCallback(() => {\n    if (!canvas) return\n    canvas.setActiveObject(item.object)\n    canvas.renderAll()\n  }, [item, canvas])\n\n  /**\n   * 锁定对象\n   */\n  const onLockObject = (e) => {\n    e.stopPropagation()\n    changeOwnLock(!isLock, item.object)\n  }\n  /**\n   * 隐藏对象\n   */\n  const onHiddenObject = (e) => {\n    e.stopPropagation()\n    item.object.set({visible: !isVisible})\n    canvas?.renderAll()\n  }\n  const fontFamily = item.object.get('fontFamily')\n  return <div\n    onClick={clickItem}\n    className={`${style.orderListItem} ${selectIds.includes(item.id) ? style.active : ''}`}\n  >\n    <div className={style.button}>\n      {/* 隐藏 */}\n      <img\n        draggable={false}\n        onClick={onHiddenObject}\n        src={isVisible ?\n          'https://ossprod.jrdaimao.com/file/1690437893570728.svg' :\n          'https://ossprod.jrdaimao.com/file/1690945206225980.svg'}\n        alt=\"\"\n      />\n      {/* 锁定 */}\n      <img\n        draggable={false}\n        onClick={onLockObject}\n        src={isLock ?\n          'https://ossprod.jrdaimao.com/file/1690437902259961.svg' :\n          'https://ossprod.jrdaimao.com/file/1690944574168632.svg'}\n        alt=\"\"\n      />\n    </div>\n    <div className={style.content}>\n      {/*目前只有俩类型，先这样写吧，后面多了跨域拆成枚举组件*/}\n      {\n        item.type === 'image' ?\n          <div className={style.image}>\n            <img draggable={false} src={item.src} alt=\"\"/>\n          </div> :\n          <div\n            className={style.text}\n            style={{fontFamily: fontFamily || 'serif'}}\n          >\n            {item.text}\n          </div>\n      }\n    </div>\n    <DragHandle/>\n  </div>\n});\n\nconst DragHandle = () => {\n  return <div className={style.move}>\n    <img draggable={false}\n         src=\"https://ossprod.jrdaimao.com/file/1690437934587361.svg\" alt=\"\"/>\n  </div>\n}\n\nconst SortableContainer = sortableContainer(({children}: { children }) => {\n  return children\n})\n\nconst OrderList = () => {\n  const {canvas} = useContext(Context)\n  const {up, upTop, down, downTop} = userOrder()\n  const [list, setList] = useState([])\n  /**\n   * 修改层级顺序\n   * @param oldIndex\n   * @param newIndex\n   */\n  const onSortEnd = useCallback(({oldIndex, newIndex}) => {\n    // 位置不变不处理\n    if (oldIndex === newIndex) return\n    const oldObject = list[oldIndex]?.object;\n    if (!oldObject) return\n    if (newIndex < oldIndex) {\n      if (newIndex === 0) return upTop(oldObject)\n      // 上移\n      for (let i = newIndex; i < oldIndex; i++) {\n        up(oldObject)\n      }\n    } else {\n      if (newIndex === list.length - 1) return downTop(oldObject)\n      // 下移\n      for (let i = oldIndex; i < newIndex; i++) {\n        down(oldObject)\n      }\n    }\n    setList(prevState => arrayMove(prevState, oldIndex, newIndex))\n  }, [list, setList, up, upTop, down, downTop]);\n\n  useEffect(() => {\n    if (!canvas) return\n    canvas.on('after:render', getList);\n    return () => {\n      canvas.off('after:render', getList);\n    }\n  }, [canvas])\n\n  /**\n   * 获取列表数据\n   */\n  const getList = useCallback(() => {\n    const objects = canvas?.getObjects() || []\n    const list = [\n      ...objects.filter((item) => {\n        // 过滤掉辅助线和背景和裁剪rect\n        return !(item instanceof fabric.GuideLine || item.id === 'workspace' || item.id === 'currentClipRect');\n      })\n    ]\n      .reverse()\n      .map((item) => {\n        const {type, id, text} = item;\n        const src = type === 'image' ? item._element?.src : undefined\n        return {\n          object: item,\n          type,\n          id,\n          text,\n          src\n        };\n      });\n    setList(list)\n  }, [setList, canvas]);\n\n  return (\n    <div className={style.orderWrap}>\n      <div className={style.orderListTitle}>图层</div>\n      {\n        !list.length ? <div className={style.orderListEmpty}>\n          <div className={style.empty}>\n            <img src=\"https://ossprod.jrdaimao.com/file/169035729200810.png\" alt=\"\"/>\n            <p>暂无图层~</p>\n          </div>\n        </div> : null\n      }\n      {\n        list.length ? <SortableContainer distance={10} lockAxis=\"y\" onSortEnd={onSortEnd}>\n          <div className={style.orderList}>\n            {\n              list.map((item, index) => {\n                return <SortableItem index={index} key={item.id} item={item}/>\n              })\n            }\n          </div>\n        </SortableContainer> : null\n      }\n    </div>\n  )\n}\n\nexport default OrderList\n","// @ts-nocheck\nimport React, { useContext, useEffect, useState } from 'react';\nimport Size from '../Components/Size'\nimport style from './index.module.scss'\nimport { SketchPicker } from 'react-color'\nimport { Context } from '../../../../Draw';\nimport { DefaultWorkSpaceColor } from '../../../../../core/EditorWorkspace';\n\nconst ColorPicker: any = SketchPicker\n\nconst WorkSpaceAttr = () => {\n  const {workSpace} = useContext(Context)\n  const [color, setColor] = useState(workSpace?.fill || DefaultWorkSpaceColor)\n  const onChangeColor = (e) => {\n    setColor(e.hex)\n    console.log('change bg color e.hex', e.hex)\n    workSpace?.setBgColor(e.hex)\n  }\n  return (\n    <div className={style.workSpaceAttr}>\n      <div className={style.base}>\n        <div>\n          {/* 设置元素的大小、锁定比例 */}\n          <Size isWorkSpace getActiveObject={() => workSpace?.workspace}/>\n        </div>\n        <div>\n          <div className={style.title}>背景色</div>\n          <ColorPicker\n            color={color}\n            onChange={onChangeColor}\n            className={style.colorPicker}\n          />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default WorkSpaceAttr;\n","import React, { useContext, useMemo } from 'react'\nimport style from './index.module.scss'\nimport { attrAreaComponent, attrTabList, AttrTabListItem } from './config'\nimport { Context as EditorContext } from '../Context'\nimport OrderList from '../OrderList';\nimport WorkSpaceAttr from '../Components/Attr/WorkSpaceAttr'\nimport { Context } from '../../Draw';\n\nconst AttrArea = () => {\n  const {selectOneType} = useContext(Context)\n  const {attrTab, setAttrTab} = useContext(EditorContext)\n  const bg = useMemo(() => {\n    return attrTabList.find(item => item.key === attrTab)?.bg\n  }, [attrTabList, attrTab])\n\n  const onChangeTab = (item: AttrTabListItem) => {\n    setAttrTab(item.key)\n  }\n  const AttrCom = attrAreaComponent[selectOneType];\n  return (\n    <div className={style.attrWrap}>\n      <div className={style.attrTab} style={{backgroundImage: `url(${bg})`}}>\n        {\n          attrTabList.map(item => {\n            return <div\n              onClick={() => onChangeTab(item)}\n              key={item.key}\n              className={attrTab === item.key ? style.attrTabActive : ''}\n            >\n              <span>{item.title}</span>\n            </div>\n          })\n        }\n      </div>\n      <div id='attr-content' className={style.attrContent}>\n        <div style={{display: attrTab === 'Attr' ? 'block' : 'none'}}>\n          {\n            AttrCom ? <AttrCom/> : <WorkSpaceAttr/>\n          }\n        </div>\n        <div style={{display: attrTab === 'coverage' ? 'block' : 'none'}}>\n          <OrderList/>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default AttrArea\n","// @ts-nocheck\nimport React, { useContext, useEffect } from 'react'\nimport ImportFile from './ImportFile'\nimport HeaderControl from './HeaderControl'\nimport SaveButton from './SaveButton'\nimport ResourceArea from './ResourceArea'\nimport Draw, { Context } from '../Draw'\nimport { Context as EditorContext } from './Context'\nimport AttrArea from './AttrArea'\nimport LoadingOverlay from 'react-loading-overlay'\nimport styles from './styles.module.css'\nimport { EditImageProps } from '../../index';\n\nconst Editor: React.FC<EditImageProps> = (props) => {\n  const {loading, loadingText} = useContext(EditorContext)\n  const {show} = useContext(Context)\n\n  return <LoadingOverlay\n    active={loading}\n    spinner\n    text={loadingText}\n  >\n    <div className={styles.dmEditImageContainer}>\n      <div className={styles.header}>\n        {/* 导入文件 */}\n        <ImportFile onBack={props.onBack}/>\n        {/* 快捷操作 */}\n        { show ?  <HeaderControl/> : null}\n        {/* 保存 */}\n        <SaveButton />\n      </div>\n      <div className={styles.content}>\n        {/* 左侧资源区域 */}\n        <ResourceArea/>\n        <div className={styles.canvasArea}>\n          {/* 画布区域 */}\n          <Draw src={props.src}/>\n        </div>\n        {\n          <div className={styles.attrArea}>\n            {/* 属性区域 */}\n            <AttrArea/>\n          </div>\n        }\n      </div>\n    </div>\n  </LoadingOverlay>\n}\n\nexport default Editor\n","import React from 'react'\nimport { CanvasProvider } from './components/Draw'\nimport { EditorProvider } from './components/Editor/Context'\nimport Editor from './components/Editor'\nimport { Toaster } from 'react-hot-toast'\n\n\nexport interface EditImageProps {\n  src?: string\n  onBack?: () => void\n}\n\nexport const EditImage: React.FC<EditImageProps> = (props) => {\n  return (\n    <CanvasProvider>\n      <EditorProvider>\n        <Editor\n          onBack={props.onBack}\n          src={props.src}\n        />\n        <Toaster/>\n      </EditorProvider>\n    </CanvasProvider>\n  )\n}\n"],"names":["throttle","fn","timer","time","args","clearTimeout","setTimeout","apply","this","uuid","replace","c","r","Math","random","v","toString","retainNumber","value","result","Number","initAligningGuidelines","canvas","disabled","ctx","getSelectionContext","aligningLineOffset","aligningLineMargin","aligningLineWidth","aligningLineColor","viewportTransform","zoom","drawVerticalLine","coords","drawLine","x","y1","y2","drawHorizontalLine","x1","x2","y","save","lineWidth","strokeStyle","beginPath","moveTo","lineTo","stroke","restore","isInRange","value1","value2","round","i","len","verticalLines","horizontalLines","on","getZoom","e","undefined","target","activeObject","canvasObjects","getObjects","activeObjectCenter","getCenterPoint","activeObjectLeft","activeObjectTop","activeObjectBoundingRect","getBoundingRect","activeObjectHeight","height","activeObjectWidth","width","horizontalInTheRange","verticalInTheRange","transform","_currentTransform","length","fabric","GuideLine","objectCenter","objectLeft","objectTop","objectBoundingRect","objectHeight","objectWidth","push","setPositionByOrigin","Point","clearContext","contextTop","error","console","log","j","renderAll","disable","enable","rotateIcon","angle","initControlsRotate","Object","prototype","controls","mtr","Control","offsetY","offsetX","rotate","actionName","actionHandler","controlsUtils","rotationWithSnapping","render","mtr2","mtr3","mtr4","activeObj","getActiveObject","_activeObj$angle","toFixed","cursorStyle","event","body","lowerCanvasEl","nextSibling","_canvas$getActiveObje","_canvas$getActiveObje2","_event$transform","corner","style","cursor","CenterAlign","constructor","centerH","workspace","object","_centerObject","center","centerV","position","name","anignType","includes","defaultWorkspace","find","item","id","KeyNames","lrdu","shiftMove","delete","ctrlz","ctrlshiftz","enter","esc","initHotkeys","hotkeys","_event","handler","key","left","set","top","Types","CHANGE_SCALE","CANVAS_CHANGE","CLIP_IMAGE","SHOW_LOADING","events","EventEmitter","isNumber","isUndef","verticalImg","edgeImg","rotateImg","horizontalImg","copyImg","deleteImg","clipImg","topBgImg","NUM_FRACTION_DIGITS","setBaseControlVisible","visible","setControlsVisibility","mt","mb","ml","mr","tl","tr","bl","br","setHighControlVisible","copy","clip","topBg","drawImg","img","wSize","hSize","translate","util","degreesToRadians","drawImage","intervalControl","verticalImgIcon","document","createElement","src","horizontalImgIcon","renderIcon","styleOverride","fabricObject","renderIconHoz","cursorStyleHandler","scaleSkewCursorStyleHandler","scalingXOrSkewingY","getActionName","scaleOrSkewActionName","scalingYOrSkewingX","peakControl","renderIconEdge","scaleCursorStyleHandler","scalingEqually","rotationControl","renderIconRotate","rotationStyleHandler","initMainControl","topBgEl","copyImageEl","deleteImageEl","clipImageEl","cloneObject","eventData","emit","clone","cloned","sourceSrc","rawScaleX","rawScaleY","rectDiffLeft","rectDiffTop","prevWidth","prevHeight","setCoords","add","setActiveObject","deleteObject","clipRect","remove","requestRenderAll","clipObject","image","type","rectLeft","rectTop","scaleX","scaleY","index","findIndex","sourceWidth","getScaledWidth","sourceHeight","getScaledHeight","o","setSrc","crossOrigin","bringToFront","selectionRect","Rect","fill","originX","originY","opacity","hasRotatingPoint","transparentCorners","cornerColor","cornerStrokeColor","borderColor","cornerSize","padding","cornerStyle","borderDashArray","borderScaleFactor","lockMovementX","lockMovementY","hoverCursor","_element","selectionRectDown","imageDown","movementX","movementY","rectWidth","rectHeight","rect","get","rawIndex","clipImageId","mouseUpHandler","textC","textdelete","initControls","borderOpacityWhenMoving","getGap","zooms","gaps","mergeLines","isHorizontal","axis","sort","a","b","mergedLines","currentLine","assign","line","max","darwLine","options","darwText","text","align","fontSize","fillStyle","textAlign","textBaseline","font","PI","fillText","darwRect","strokeWidth","drawMask","backgroundColor","gradient","createLinearGradient","transparentColor","Color","setAlpha","addColorStop","toRgba","setupGuideLine","createClass","Line","selectable","hasControls","hasBorders","globalCompositeOperation","initialize","points","newPoints","callSuper","activeOn","ruler","enabled","isPointOnRuler","moveCursor","fire","off","absolute","calculate","hoveredRuler","fromObject","callback","_callback","instance","xy","_fromObject","CanvasRuler","_options","calcObjectRect","bind","clearStatus","canvasMouseDown","canvasMouseMove","canvasMouseUp","status","selection","tempGuidelLine","absolutePointer","pointer","ruleSize","highlightColor","textColor","getContext","extend","destroy","clearGuideline","showGuideline","forEach","guideLine","hideGuideline","eventHandler","vpt","draw","rulerLength","getSize","startCalibration","_this$startCalibratio","_this$startCalibratio2","opt","gap","unitLength","startValue","startOffset","canvasSize","ceil","textValue","textLength","textX","textY","toRgb","objectRect","skip","roundFactor","leftTextVal","rightTextVal","isSameText","maskOpt","pad","textOpt","lineSize","lineOpt","activeObjects","getActiveObjects","allRect","reduce","rects","obj","group","groupCenterX","objectOffsetFromCenterX","groupCenterY","objectOffsetFromCenterY","point","containsPoint","lastAttr","_setupCurrentTransform","getCommonEventInfo","pos","defaultCursor","_this$tempGuidelLine","initRuler","getWorkspace","isRectOut","targetRect","targetTop","targetHeight","targetLeft","targetWidth","setCursor","EditorGroupText","_init","isDown","textObject","_getGroupTextObj","_bedingEditingEvent","enterEditing","getPointer","clickObj","_searchPossibleTargets","_opt$target","_objects","isText","ids","_unGroup","resetGroup","groupArr","filter","Group","discardActiveObject","toActiveSelection","Editor","editorWorkspace","disableGuidelines","enableGuidelines","centerAlign","InitCenterAlign","_copyActiveSelection","grid","clonedObj","evented","forEachObject","_copyObject","paramsActiveObeject","unGroup","activegroup","toGroup","objectsInGroup","newgroup","workspaceSendToBack","sendToBack","getJson","toJSON","dragAddItem","getSelectionElement","getBoundingClientRect","pointerVpt","restorePointerVpt","noop","Context","createContext","editor","workSpace","drawMode","selectMode","selectIds","selectOneType","selectActive","show","mainUrl","isClipImage","clipRawIndex","setClipRawIndex","setClipImageId","setIsClipImage","setMainUrl","setSelectOneType","setSelectActive","setSelectMode","setSelectIds","setDrawMode","setCanvas","setEditor","setWorkSpace","setShow","CanvasProvider","children","useState","context","React","Provider","Input","props","title","afterText","onChange","className","customInput","inputWrap","isValidElement","useAttr","useContext","setAttr","attr","lockAttrs","isControlsInRatioVisible","_controlsVisibility","useLock","changeOwnLock","useCallback","isLock","changeInRatioLock","subtract","num1","num2","num1Digits","split","num2Digits","baseNum","pow","multiply","num1String","num2String","divide","n1","n2","floatRound","num","n","Size","showRation","isWorkSpace","setWidth","setHeight","lockRatio","setLockRatio","useEffect","getAttr","onWidthChange","setSize","onHeightChange","changeLock","prevState","size","ratio","content","onClick","alt","Position","setRotate","setX","setY","onRotateChange","onPositionXChange","onPositionYChange","Transparent","setOpacity","setVisible","onOpacityChange","onFlipChange","onVisibleChange","transparent","customInputStyle","reverse","reverseWrap","usePageAlign","setPosition","alignCenter","middleCenter","right","bottom","alignTypeList","icon","activeIcon","PageAlign","alignFunc","_alignFunc$item$key","call","pageAlign","shareShapeList","map","shareShapeListItem","coverOrderList","userOrder","changeOrder","funcKey","actives","_activeObject$funcKey","_activeObject","up","upTop","down","downTop","CoverOrder","orderFunc","changeCoverOrder","_orderFunc$item$key","coverOrder","coverOrderTitle","pageAlignStyle","ImageSpaceAttr","workSpaceAttr","base","division","DropdownIndicator","ReactSelectStyles","singleValue","provided","color","fontWeight","menuList","background","option","lineHeight","boxSizing","container","control","paddingRight","flex","borderRadius","display","InputNumber","number","setNumber","last","useRef","current","inputRef","_inputRef$current","addEventListener","keyDownChange","_inputRef$current2","removeEventListener","sub","onNumberChange","styles","inputNumber","ref","textAlignList","activeSrc","textStyleList","label","getFontManage","Promise","resolve","GeneralTextList","Font","Map","globalFontList","filterToText","list","Array","isArray","fontFamily","useChangeFontFamily","setLoading","fontList","setFontList","fontLoaded","setFontLoaded","useFontListLast","res","fontlibName","url","fontlibfile","runChange","has","styleContent","innerHTML","appendChild","FontFaceObserver","load","then","removeChild","loadFont","objectsData","textList","el","fontFamiliesAll","reject","catch","err","all","ColorPicker","SketchPicker","TextAttr","setFontSize","setColor","setFontWeight","underline","setUnderline","incline","setIncline","setAlign","fontStyle","setFontStyle","setFontFamily","isWeight","querySelector","overflow","onFontSizeChange","onChangeComplete","hex","onWeightChange","onUnderlineChange","onAlignChange","onInclineChange","onFontStyleChange","onChangeFontFamily","textArea","textAreaContent","Select","placeholder","components","select","isSearchable","isDisabled","disabledSelect","colorContent","alignGroup","alignGroupActive","styleGroup","styleGroupActive","fixColorPicker","colorPicker","TextSpaceAttr","attrTabList","bg","attrAreaComponent","DefaultKey","InitState","attrTab","loading","loadingText","setLoadingText","setAttrTab","EditorProvider","loadImage","Image","onload","onerror","base64ConvertFile","urlData","arr","match","fileExt","bstr","atob","u8arr","Uint8Array","charCodeAt","File","request","axios","create","baseURL","interceptors","response","use","data","code","Error","message","fetch","params","post","getImageList","postUploadImage","file","form","FormData","append","addImageApi","saveHistory","delstock","getDetail","useToast","toast","duration","useClipImage","EditorContext","saveClipImage","scale","currentClipImageIndex","newRect","absolutePositioned","clipPath","cropped","setViewportTransform","base64","toDataURL","setZoomAuto","newImage","sendBackwards","cancelClipImage","clipImage","useEvents","selected","onWheel","deleteObjects","unbind","onZoom","small","preventDefault","stopPropagation","big","_e$transform","delta","deltaY","deleteClipImageAndRect","DefaultWidth","DefaultHeight","DefaultWorkSpaceColor","EditorWorkspace","workspaceEl","dragMode","_initBackground","_initWorkspace","_initResizeObserve","_initDring","offsetWidth","offsetHeight","canvasData","objects","rectOptions","loadFromJSON","_initRect","fromURL","w","_this$option$callback","_this$option","auto","setBgColor","_this$workspace","setCenterFromObject","objCenter","resizeObserver","ResizeObserver","observe","cb","getCenter","iMatrix","concat","zoomToPoint","getScale","viewPortWidth","viewPortHeight","zoomRatio","one","startDring","endDring","This","evt","altKey","_setDring","isDragging","lastPosX","clientX","lastPosY","clientY","useSave","saveToImageLoading","setSaveToImageLoading","useLast","unloadSendBeacon","dataJson","JSON","stringify","imgSrc","blob","Blob","isPush","navigator","sendBeacon","saveHistoryApi","saveToJson","dataUrl","fileStr","encodeURIComponent","saveAs","saveToImage","format","quality","Draw","init","window","initCanvas","parse","mainImg","_canvasData$objects$f","Canvas","fireRightClick","stopContextMenu","controlsAboveOverlay","preserveObjectStacking","workContent","ImportFile","back","_props$onBack","onBack","importFile","useMemoizedFn","fnRef","useMemo","memoizedFn","dumpIndex","step","targetArr","_current","_before","slice","_after","useHistoryTravel","initialValue","maxLength","history","setHistory","present","past","future","initialValueRef","reset","_initial","updateValue","val","_past","maxLengthNum","splice","_forward","_backward","go","stepNum","backLength","forwardLength","setValue","forward","useHistory","historyFlagRef","clear","isSelect","action","undo","redo","HeaderControl","setScale","drawModeRef","onClipImage","onKeyDown","onKeyUp","switchDragMode","switchDefaultMode","_editor$disableGuidel","_editor$enableGuideli","headerControl","clipSaveButton","button","active","visibility","ratioText","SaveButton","headerRightControl","saveWrap","saveButton","useDropDown","clickRef","cacheItem","shareEl","removeEl","stockName","_id","lastIndexOf","run","parentNode","div","DefaultOptions","useAddObject","addImage","Date","now","addText","IText","lockScalingX","lockScalingY","ImageResource","EDIT_IMAGE_LIST","sessionStorage","getItem","uploading","setUploading","setList","queryList","onDrop","onDragover","imageUrl","dataTransfer","getData","offset","onClickMore","setItem","onUploadFile","fileList","files","test","onDragStart","setData","imageResource","uploadFile","multiple","accept","empty","fileListItem","more","TextResource","textResource","addShareTextButton","textListItem","ResourceTypeEnum","ALREADY_UPLOAD","TEXT","resourceNavList","ResourceContentComEnum","DefaultSelectKey","ResourceArea","collapsed","setCollapsed","activeKey","setActiveKey","onResourceNavChange","activeIndex","ResourceComponent","onSetCollapsed","setProperty","resourceArea","resourceNav","resourceNavItem","resourceNavItemActive","resourceNavItemPrevActive","resourceNavPlace","resourceContent","packUp","SortableItem","sortableElement","isVisible","clickItem","onLockObject","onHiddenObject","orderListItem","draggable","DragHandle","move","SortableContainer","sortableContainer","OrderList","onSortEnd","oldIndex","newIndex","oldObject","_list$oldIndex","arrayMove","getList","_item$_element","orderWrap","orderListTitle","orderListEmpty","distance","lockAxis","orderList","WorkSpaceAttr","onChangeColor","AttrArea","_attrTabList$find","onChangeTab","AttrCom","attrWrap","backgroundImage","attrTabActive","attrContent","LoadingOverlay","spinner","dmEditImageContainer","header","canvasArea","attrArea","EditImage","Toaster"],"mappings":"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"}